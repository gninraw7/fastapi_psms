# -*- coding: utf-8 -*-
"""
ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •
"""
import os
from typing import List


class Settings:
    """ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì • í´ë˜ìŠ¤"""
    
    # ============================================
    # ê¸°ë³¸ ì„¤ì •
    # ============================================
    PROJECT_NAME: str = "PSMS API"
    API_V1_PREFIX: str = "/api/v1"
    VERSION: str = "2.0.0"
    
    # ============================================
    # ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
    # ============================================
    DB_HOST: str = os.getenv("DB_HOST", "localhost")
    DB_PORT: int = int(os.getenv("DB_PORT", "3306"))
    DB_USER: str = os.getenv("DB_USER", "root")
    DB_PASSWORD: str = os.getenv("DB_PASSWORD", "")
    DB_NAME: str = os.getenv("DB_NAME", "psms")
    DB_CHARSET: str = "utf8mb4"
    
    @property
    def DATABASE_URL(self) -> str:
        """ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° URL"""
        return f"mysql+pymysql://{self.DB_USER}:{self.DB_PASSWORD}@{self.DB_HOST}:{self.DB_PORT}/{self.DB_NAME}?charset={self.DB_CHARSET}"
    
    # ============================================
    # CORS ì„¤ì •
    # ============================================
    # í™˜ê²½ ë³€ìˆ˜ë¡œ CORS origins ì„¤ì •
    # ê°œë°œ í™˜ê²½: CORS_ORIGINS=*
    # í”„ë¡œë•ì…˜: CORS_ORIGINS=http://192.168.1.100:8000,http://your-domain.com
    CORS_ORIGINS: str = os.getenv(
        "CORS_ORIGINS", 
        "*"  # ê¸°ë³¸ê°’: ëª¨ë“  origin í—ˆìš© (ê°œë°œ í™˜ê²½)
    )
    
    @property
    def CORS_ORIGINS_LIST(self) -> List[str]:
        """
        CORS originsë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜
        
        Examples:
            CORS_ORIGINS="*" â†’ ["*"]
            CORS_ORIGINS="http://localhost,http://192.168.1.100:8000" 
                â†’ ["http://localhost", "http://192.168.1.100:8000"]
        """
        # ì™€ì¼ë“œì¹´ë“œì¸ ê²½ìš°
        if self.CORS_ORIGINS == "*":
            return ["*"]
        
        # ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ë¬¸ìì—´ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜
        origins = [origin.strip() for origin in self.CORS_ORIGINS.split(",")]
        
        # ë¹ˆ ë¬¸ìì—´ ì œê±°
        return [origin for origin in origins if origin]
    
    # ============================================
    # ì„œë²„ ì„¤ì •
    # ============================================
    SERVER_HOST: str = os.getenv("SERVER_HOST", "0.0.0.0")
    SERVER_PORT: int = int(os.getenv("SERVER_PORT", "8000"))
    DEBUG: bool = os.getenv("DEBUG", "True").lower() in ("true", "1", "yes")
    
    # ============================================
    # ë¡œê¹… ì„¤ì •
    # ============================================
    LOG_LEVEL: str = os.getenv("LOG_LEVEL", "INFO")
    
    # ============================================
    # ë³´ì•ˆ ì„¤ì • (í–¥í›„ í™•ì¥)
    # ============================================
    SECRET_KEY: str = os.getenv("SECRET_KEY", "your-secret-key-change-this-in-production")
    ALGORITHM: str = "HS256"
    ACCESS_TOKEN_EXPIRE_MINUTES: int = 30


# ============================================
# ì„¤ì • ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
# ============================================
settings = Settings()


# ============================================
# ì„¤ì • ì •ë³´ ì¶œë ¥ (ë””ë²„ê¹…ìš©)
# ============================================
def print_settings():
    """í˜„ì¬ ì„¤ì • ì •ë³´ ì¶œë ¥"""
    print("\n" + "=" * 70)
    print("  ğŸ“‹ Current Settings")
    print("=" * 70)
    print(f"  Project Name: {settings.PROJECT_NAME}")
    print(f"  Version: {settings.VERSION}")
    print(f"  API Prefix: {settings.API_V1_PREFIX}")
    print(f"  Database: {settings.DB_HOST}:{settings.DB_PORT}/{settings.DB_NAME}")
    print(f"  CORS Origins: {settings.CORS_ORIGINS_LIST}")
    print(f"  Debug Mode: {settings.DEBUG}")
    print("=" * 70 + "\n")


if __name__ == "__main__":
    # í…ŒìŠ¤íŠ¸ìš©
    print_settings()
