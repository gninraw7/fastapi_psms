<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSMS - 프로젝트 관리 시스템</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Tabulator CSS -->
    <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link href="https://unpkg.com/quill-better-table@1.2.10/dist/quill-better-table.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
    
    <!-- SheetJS -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
	
    <link rel="stylesheet" href="/static/css/styles.css?v=1.8">
    <link rel="stylesheet" href="/static/css/navigation.css">
    <link rel="stylesheet" href="/static/css/project-form.css?v=1.5">
	<link rel="stylesheet" href="/static/css/mobile.css">
    <link rel="stylesheet" href="/static/css/clients.css?v=1.0.0">
    <link rel="stylesheet" href="/static/css/breadcrumb.css">
    <link rel="stylesheet" href="/static/css/sales-planning.css?v=2.4">
    <link rel="stylesheet" href="/static/css/sales-dashboard.css?v=1.1">
    <link rel="stylesheet" href="/static/css/project-history-calendar.css?v=1.0">

    <!-- ⭐ 인증 관리 스크립트 추가 -->
    <script src="/static/js/auth.js?v=2.5"></script>
</head>
<body>
    <!-- 인증 확인 스크립트 -->
    <script src="/static/js/auth-check.js?v=1.2"></script>

    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand" onclick="goHome()" style="cursor: pointer;">
                <i class="fas fa-project-diagram"></i>
                <span>PSMS</span>
            </div>
            
            <ul class="navbar-menu">
                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-chart-line"></i>
                        프로젝트 관리
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="projects-list"><i class="fas fa-list"></i> 프로젝트 목록</a></li>
                        <li><a href="#" data-page="projects-new" data-mode="new"><i class="fas fa-plus-circle"></i> 신규 프로젝트</a></li>
                        <li><a href="#" data-page="clients-list"><i class="fas fa-building"></i> 거래처 관리</a></li>
                        <li class="dropdown-divider"></li>
                        <li><a href="#" data-page="project-history-calendar"><i class="fas fa-calendar-check"></i> 진행상황 조회</a></li>
                        <li><a href="#" data-page="sales-dashboard"><i class="fas fa-tachometer-alt"></i> 프로젝트 대시보드</a></li>
                    </ul>
                </li>
                
                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-calendar-check"></i>
                        영업계획
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="sales-plan-list"><i class="fas fa-list"></i> 계획 목록</a></li>
                        <li><a href="#" data-page="sales-plan-edit"><i class="fas fa-pen-to-square"></i> 계획 입력</a></li>
                    </ul>
                </li>
                
                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-chart-bar"></i>
                        실적관리
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="sales-actual-entry"><i class="fas fa-clipboard-check"></i> 실적 등록</a></li>
                        <li><a href="#" data-page="sales-actual-dashboard"><i class="fas fa-chart-line"></i> 실적 현황</a></li>
                    </ul>
                </li>

                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-chart-pie"></i>
                        Report
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="report-hub"><i class="fas fa-layer-group"></i> 유형별 현황</a></li>
                    </ul>
                </li>

                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-bullhorn"></i>
                        게시판
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="notices-list"><i class="fas fa-list"></i> 게시판 목록</a></li>
                    </ul>
                </li>
                
                <li class="navbar-item" id="adminMenu">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-cog"></i>
                        관리자
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="users"><i class="fas fa-users"></i> 사용자 관리</a></li>
                        <li><a href="#" data-page="common-codes"><i class="fas fa-code"></i> 공통코드 관리</a></li>
                        <li><a href="#" data-page="notice-templates"><i class="fas fa-file-lines"></i> 공지 템플릿 관리</a></li>
                        <li><a href="#" data-page="industry-fields"><i class="fas fa-tags"></i> 분야코드 관리</a></li>
                        <li><a href="#" data-page="service-codes"><i class="fas fa-layer-group"></i> 서비스코드 관리</a></li>
                        <li><a href="#" data-page="org-units"><i class="fas fa-sitemap"></i> 조직 관리</a></li>
                        <li><a href="#" data-page="companies"><i class="fas fa-building"></i> 회사 관리</a></li>
                        <li><a href="#" data-page="data-management"><i class="fas fa-database"></i> 데이터 관리</a></li>
                        <li><a href="#" data-page="login-history"><i class="fas fa-clock"></i> 접속 이력</a></li>
                        <li><a href="#" data-page="permissions"><i class="fas fa-shield-halved"></i> 권한 관리</a></li>
                        <li class="dropdown-divider"></li>
                        <li><a href="#" data-page="settings"><i class="fas fa-sliders-h"></i> 시스템 설정</a></li>
                    </ul>
                </li>
			</ul>			
            
            <div class="navbar-user">
                <div class="company-switch" id="companySwitch" style="display:none;">
                    <i class="fas fa-building"></i>
                    <select id="currentCompanySelect" class="company-select"></select>
                    <button class="btn-icon" id="btnSwitchCompany" title="회사 변경">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                </div>
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="currentUser">사용자</span>
                </div>
                <div class="user-menu">
                    <button class="btn-icon" title="내정보" onclick="openMyInfo()">
                        <i class="fas fa-user-cog"></i>
                    </button>
                    <button class="btn-icon" title="로그아웃" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div id="app-content">
        <!-- 프로젝트 목록 페이지 -->
        <div id="page-projects-list" class="page-content active">
            <main class="app-main">
                <!-- 통계 패널 -->
                <div class="stats-panel">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <i class="fas fa-folder-open"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statTotal">0</div>
                            <div class="stat-label">전체 프로젝트</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statProgress">0</div>
                            <div class="stat-label">진행중</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statCompleted">0</div>
                            <div class="stat-label">완료</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            <i class="fas fa-won-sign"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statAmount">0원</div>
                            <div class="stat-label">총 견적금액</div>
                        </div>
                    </div>
                </div>

                <!-- 필터 패널 -->
                <div class="filter-panel">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label><i class="fas fa-search"></i> 검색필드</label>
                            <select id="searchField" class="form-select">
                                <option value="">전체</option>
                                <option value="pipeline_id">파이프라인ID</option>
                                <option value="project_name">프로젝트명</option>
                                <option value="customer_name">고객사</option>
                            </select>
                        </div>
                        
                        <div class="filter-group" style="flex: 2;">
                            <label><i class="fas fa-keyboard"></i> 검색어</label>
                            <input type="text" id="searchText" class="form-input" placeholder="검색어를 입력하세요">
                        </div>
                        
                        <div class="filter-group" style="flex: 0 0 auto;">
                            <label>&nbsp;</label>
                            <button id="btnSearch" class="btn btn-secondary">
                                <i class="fas fa-search"></i> 검색
                            </button>
                        </div>

                        
                        <div class="filter-group">
                            <label><i class="fas fa-user"></i> 담당자</label>
                            <select id="filterManager" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label><i class="fas fa-briefcase"></i> 사업분야</label>
                            <select id="filterField" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label><i class="fas fa-concierge-bell"></i> 서비스</label>
                            <select id="filterService" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label><i class="fas fa-flag"></i> 진행단계</label>
                            <select id="filterStage" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label><i class="fas fa-circle"></i> 상태</label>
                            <select id="filterStatus" class="form-select">
                                <option value="">전체</option>
                                <option value="ACTIVE" selected>ACTIVE</option>
                                <option value="CLOSED">CLOSED</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label><i class="fas fa-list-check"></i> 영업계획</label>
                            <select id="filterSalesPlan" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="filter-actions">
                        <button id="toggleLatestHistory" class="btn btn-toggle" type="button" aria-pressed="false" title="마우스 오버 시 최종 이력 표시">
                            <i class="fas fa-history"></i>
                            <span class="toggle-label">최종 이력 보기</span>
                            <span class="toggle-state">OFF</span>
                        </button>
                        <button id="btnAdd" class="btn btn-primary" title="새 프로젝트 추가">
                            <i class="fas fa-plus-circle"></i> 신규
                        </button>
                        <button id="btnRefresh" class="btn btn-info">
                            <i class="fas fa-sync-alt"></i> 새로고침
                        </button>
                        <button id="btnExport" class="btn btn-success">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>

                    </div>
                </div>

                <!-- 테이블 패널 -->
                <div class="table-panel">
                    <div id="projectTable"></div>
                </div>
                <div id="latestHistoryTooltip" class="history-tooltip" aria-hidden="true"></div>
            </main>
        </div>

        <!-- 프로젝트 신규/수정 페이지 -->
        <div id="page-projects-new" class="page-content">
            <div class="form-container">
                <div class="form-header">
                    <div class="form-title">
                        <i class="fas fa-edit"></i>
                        <h2 id="formTitle">신규 프로젝트</h2>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-primary" onclick="saveProject()" title="저장">
                            <i class="fas fa-save"></i> 저장
                        </button>
                        <button class="btn btn-outline-secondary" onclick="closeProjectForm()" title="목록으로">
                            <i class="fas fa-list"></i> 목록
                        </button>
                        <button class="btn btn-danger" id="btnCloseProject" onclick="closeProject()" title="삭제/종료" style="display: none;">
                            <i class="fas fa-ban"></i> 삭제/종료
                        </button>
                        <button class="btn btn-close-icon" onclick="closeProjectForm()" title="닫기">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <!-- 탭 네비게이션 -->
                <div class="tabs">
                    <button class="tab-btn active" data-tab="basic">
                        <i class="fas fa-info-circle"></i> 기본정보
                    </button>
                    <button class="tab-btn" data-tab="attributes">
                        <i class="fas fa-tags"></i> 속성정보
                    </button>
                    <button class="tab-btn" data-tab="history">
                        <i class="fas fa-history"></i> 변경이력
                    </button>
                    <button class="tab-btn" data-tab="contract">
                        <i class="fas fa-file-signature"></i> 계약/기간
                    </button>
                </div>

                <!-- 탭 컨텐츠 -->
                <div class="tab-content">
                    <!-- ============================================ -->
                    <!-- 기본정보 탭 (1.1, 1.2, 1.3 수정 반영) -->
                    <!-- ============================================ -->
                    <div id="tab-basic" class="tab-pane active">
                        <div class="form-grid">
                            <!-- 파이프라인 ID -->
                            <div class="form-group">
                                <label>파이프라인 ID <span class="required">*</span></label>
                                <input type="text" id="pipeline_id" class="form-input" readonly>
                                <small class="form-help">자동 생성됩니다</small>
                            </div>

                            <!-- 1.1 진행단계 (API에서 STAGE 코드 로드) -->
                            <div class="form-group">
                                <label>진행단계 <span class="required">*</span></label>
                                <select id="current_stage" class="form-select" required>
                                    <option value="">선택하세요</option>
                                    <!-- loadFormComboBoxes()에서 동적 로드 -->
                                </select>
                            </div>

                            <!-- 프로젝트명 -->
                            <div class="form-group full-width">
                                <label>프로젝트명 <span class="required">*</span></label>
                                <input type="text" id="project_name" class="form-input" placeholder="프로젝트명을 입력하세요" required>
                            </div>

                            <!-- 사업분야 -->
                            <div class="form-group">
                                <label>사업분야 <span class="required">*</span></label>
                                <select id="field_code" class="form-select" required>
                                    <option value="">선택하세요</option>
                                </select>
                            </div>

                            <!-- 서비스코드 -->
                            <div class="form-group">
                                <label>서비스코드</label>
                                <select id="service_code" class="form-select">
                                    <option value="">선택하세요</option>
                                </select>
                            </div>

                            <!-- 1.1 담당자 (API 응답 형식 수정) -->
                            <div class="form-group">
                                <label>담당자 <span class="required">*</span></label>
                                <select id="manager_id" class="form-select" required>
                                    <option value="">선택하세요</option>
                                    <!-- loadFormComboBoxes()에서 동적 로드 -->
                                </select>
                            </div>

                            <!-- 담당조직 -->
                            <div class="form-group">
                                <label>담당조직</label>
                                <select id="org_id" class="form-select">
                                    <option value="">선택하세요</option>
                                </select>
                            </div>

                            <!-- 1.2 고객사 (검색 모달 연동) -->
                            <div class="form-group">
                                <label>고객사 <span class="required">*</span></label>
                                <input type="hidden" id="customer_id">
                                <div class="input-group">
                                    <input type="text" id="customer_name" class="form-input" placeholder="클릭하여 검색" readonly style="cursor: pointer;">
                                    <button type="button" id="customer_search_btn" class="btn btn-secondary btn-sm">
                                        <i class="fas fa-search"></i>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('customer_id').value=''; document.getElementById('customer_name').value='';">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- 1.2 발주처 (검색 모달 연동) -->
                            <div class="form-group">
                                <label>발주처</label>
                                <input type="hidden" id="ordering_party_id">
                                <div class="input-group">
                                    <input type="text" id="ordering_party_name" class="form-input" placeholder="클릭하여 검색" readonly style="cursor: pointer;">
                                    <button type="button" id="ordering_party_search_btn" class="btn btn-secondary btn-sm">
                                        <i class="fas fa-search"></i>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('ordering_party_id').value=''; document.getElementById('ordering_party_name').value='';">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- 견적금액 -->
                            <div class="form-group">
                                <label>견적금액</label>
                                <input type="text" id="quoted_amount" class="form-input amount-input align-right" placeholder="0" inputmode="numeric" pattern="[0-9,]*">
                            </div>

                            <!-- 1.3 수주확률 (신규 컬럼) -->
                            <div class="form-group">
                                <label>수주확률 (%)</label>
                                <input type="number" id="win_probability" class="form-input align-right" placeholder="0" min="0" max="100" inputmode="numeric">
                                <small class="form-help">0 ~ 100 사이 값 입력</small>
                            </div>

                            <!-- 1.3 비고 (신규 컬럼) -->
                            <div class="form-group full-width">
                                <label>비고</label>
                                <textarea id="notes" class="form-textarea" rows="3" placeholder="비고 내용을 입력하세요"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- ============================================ -->
                    <!-- 속성정보 탭 (2.1 수정 반영) -->
                    <!-- ============================================ -->
                    <div id="tab-attributes" class="tab-pane">
                        <div class="tab-project-name">
                            <span class="tab-project-label">프로젝트명</span>
                            <span class="tab-project-value" id="tabProjectNameAttributes">-</span>
                        </div>
                        <div class="tab-description">
                            <i class="fas fa-info-circle"></i>
                            프로젝트 속성을 관리합니다. 속성명은 중복 등록할 수 없습니다.
                        </div>
                        <div id="attributesList">
                            <!-- renderAttributes()에서 동적 생성 -->
                        </div>
                    </div>

                    <!-- ============================================ -->
                    <!-- 변경이력 탭 (3.1 수정 반영) -->
                    <!-- ============================================ -->
                    <div id="tab-history" class="tab-pane">
                        <div class="tab-project-name">
                            <span class="tab-project-label">프로젝트명</span>
                            <span class="tab-project-value" id="tabProjectNameHistory">-</span>
                        </div>
                        <div class="tab-description">
                            <i class="fas fa-info-circle"></i>
                            프로젝트 진행 이력을 관리합니다. 신규 등록시 기본 단계는 "1 영업중(S01)", 수정시에는 현재 진행단계가 기본값으로 설정됩니다.
                        </div>
                        
                        <!-- ⭐ 마크다운 포맷팅 옵션 (신규 추가) -->
                        <div class="markdown-format-option" style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            padding: 0.875rem 1.25rem;
                            background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf3 100%);
                            border-radius: 8px;
                            margin-bottom: 1rem;
                            border: 1px solid #d8dce6;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
                        ">
                            <label for="enable_markdown_formatting" style="
                                display: flex;
                                align-items: center;
                                gap: 0.75rem;
                                cursor: pointer;
                                user-select: none;
                                flex: 1;
                            ">
                                <!-- 체크박스 -->
                                <input 
                                    type="checkbox" 
                                    id="enable_markdown_formatting"
                                    onchange="toggleMarkdownFormatting(this.checked)"
                                    style="
                                        width: 20px;
                                        height: 20px;
                                        cursor: pointer;
                                        accent-color: #667eea;
                                    "
                                >
                                
                                <span style="
                                    font-weight: 600;
                                    color: #2c3e50;
                                    font-size: 0.9rem;
                                    display: flex;
                                    align-items: center;
                                    gap: 0.5rem;
                                ">
                                    <i class="fas fa-magic" style="color: #667eea;"></i>
                                    스마트 포맷팅 사용
                                    <span style="
                                        font-size: 0.75rem;
                                        font-weight: 400;
                                        color: #7f8c8d;
                                        background: white;
                                        padding: 0.15rem 0.5rem;
                                        border-radius: 4px;
                                    ">
                                        마크다운 자동 변환
                                    </span>
                                </span>
                            </label>
                            
                            <!-- 도움말 버튼 -->
                            <button 
                                type="button"
                                onclick="showMarkdownGuide()"
                                style="
                                    background: white;
                                    border: 1.5px solid #667eea;
                                    color: #667eea;
                                    padding: 0.5rem 1rem;
                                    border-radius: 6px;
                                    font-size: 0.85rem;
                                    font-weight: 600;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                    display: flex;
                                    align-items: center;
                                    gap: 0.5rem;
                                "
                                onmouseover="this.style.background='#667eea'; this.style.color='white'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(102,126,234,0.3)';"
                                onmouseout="this.style.background='white'; this.style.color='#667eea'; this.style.transform='translateY(0)'; this.style.boxShadow='none';"
                            >
                                <i class="fas fa-book-open"></i>
                                문법 가이드
                            </button>
                        </div>
                        
                        <div id="historiesList">
                            <!-- renderHistories()에서 동적 생성 -->
                        </div>
                    </div>

                    <!-- ============================================ -->
                    <!-- 계약/기간 탭 -->
                    <!-- ============================================ -->
                    <div id="tab-contract" class="tab-pane">
                        <div class="tab-description">
                            <i class="fas fa-info-circle"></i>
                            계약 체결일과 수행 기간, 금액 정보를 관리합니다.
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>계약 체결일</label>
                                <input type="date" id="contract_date" class="form-input">
                            </div>
                            <div class="form-group">
                                <label>수행 시작일</label>
                                <input type="date" id="start_date" class="form-input">
                            </div>
                            <div class="form-group">
                                <label>수행 종료일</label>
                                <input type="date" id="end_date" class="form-input">
                            </div>
                            <div class="form-group">
                                <label>수주 금액</label>
                                <input type="text" id="order_amount" class="form-input amount-input align-right" placeholder="0" inputmode="numeric" pattern="[0-9,]*">
                            </div>
                            <div class="form-group">
                                <label>최종 계약 금액</label>
                                <input type="text" id="contract_amount" class="form-input amount-input align-right" placeholder="0" inputmode="numeric" pattern="[0-9,]*">
                            </div>
                            <div class="form-group full-width">
                                <label>계약 비고</label>
                                <textarea id="contract_remarks" class="form-textarea" rows="3" placeholder="계약 관련 비고를 입력하세요"></textarea>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

 

        <!-- 준비중 페이지들 (기존과 동일) -->

        <!-- ============================================ -->
        <!-- 1.2 고객사/발주처 검색 모달 (신규 추가) -->
        <!-- ============================================ -->
        <div id="clientSearchModal" class="modal" style="display: none;">
            <div class="modal-content modal-medium">
                <div class="modal-header">
                    <h2>
                        <i class="fas fa-building"></i>
                        고객사/발주처 검색
                    </h2>
                    <button class="modal-close" onclick="closeClientSearchModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- 검색 영역 -->
                    <div class="search-box">
                        <div class="input-group">
                            <input type="text" id="clientSearchInput" class="form-input" 
                                placeholder="고객사명, 사업자번호, 대표자명으로 검색"
                                onkeypress="if(event.key==='Enter') searchClients()">
                            <button type="button" class="btn btn-primary" onclick="searchClients()">
                                <i class="fas fa-search"></i> 검색
                            </button>
                        </div>
                    </div>
                    
                    <!-- 검색 결과 -->
                    <div id="clientSearchResults" class="client-search-results">
                        <p style="text-align: center; padding: 20px; color: #666;">
                            검색어를 입력하세요
                        </p>
                    </div>
                    
                    <!-- 페이징 -->
                    <div id="clientSearchPagination" class="pagination-container">
                    </div>
                </div>
            </div>
        </div>
        
    <!-- ========================================
         Mobile: 프로젝트 목록
         ======================================== -->
    <div id="page-mobile-projects" class="page-content mobile-page">
        <div class="mobile-container">
            <!-- 헤더 -->
            <div class="mobile-header">
                <h2><i class="fas fa-list"></i> 프로젝트 목록</h2>
                <button class="btn-mobile btn-mobile-primary" onclick="navigateTo('mobile-project-new')">
                    <i class="fas fa-plus"></i> 신규
                </button>
            </div>
            
            <!-- 검색 필터 -->
            <div class="mobile-filter">
                <div class="mobile-search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="mobileSearchInput" placeholder="프로젝트명, 거래처명 검색...">
                </div>
                
                <div class="mobile-filter-row">
                    <select id="mobileStageFilter" class="mobile-select">
                        <option value="">전체 진행단계</option>
                    </select>
                    
                    <select id="mobileYearFilter" class="mobile-select">
                        <option value="">전체 연도</option>
                    </select>
                </div>
            </div>
            
            <!-- 통계 카드 -->
            <div class="mobile-stats">
                <div class="mobile-stat-item">
                    <div class="mobile-stat-label">전체</div>
                    <div class="mobile-stat-value" id="mobileTotalCount">0</div>
                </div>
                <div class="mobile-stat-item">
                    <div class="mobile-stat-label">진행중</div>
                    <div class="mobile-stat-value" id="mobileActiveCount">0</div>
                </div>
                <div class="mobile-stat-item">
                    <div class="mobile-stat-label">완료</div>
                    <div class="mobile-stat-value" id="mobileCompleteCount">0</div>
                </div>
            </div>
            
            <!-- 프로젝트 목록 -->
            <div id="mobileProjectList" class="mobile-project-list">
                <!-- 동적 생성 -->
            </div>
        </div>
    </div>
    
	<!-- ========================================
		 Mobile: 프로젝트 등록/수정 (수정됨)
		 ======================================== -->
	<div id="page-mobile-project-new" class="page-content mobile-page">
		<div class="mobile-container">
			<!-- 헤더 -->
			<div class="mobile-header">
				<button class="btn-mobile-back" onclick="navigateTo('mobile-projects')">
					<i class="fas fa-arrow-left"></i>
				</button>
				<h2 id="mobileFormTitle">프로젝트 등록</h2>
				<button class="btn-mobile-icon" onclick="saveMobileProject()">
					<i class="fas fa-save"></i>
				</button>
			</div>
			
			<!-- 프로젝트 등록/수정 폼 -->
			<form id="mobileProjectForm" class="mobile-form" onsubmit="event.preventDefault(); saveMobileProject();">			
				<input type="hidden" id="mobilePipelineId">
				
				<!-- 분야 (FIELD) -->
				<div class="mobile-form-group">
					<label>분야 <span class="required">*</span></label>
					<select id="mobileFieldCode" required>
						<option value="">선택하세요</option>
					</select>
				</div>

				<!-- 서비스코드 -->
				<div class="mobile-form-group">
					<label>서비스코드</label>
					<select id="mobileServiceCode">
						<option value="">선택하세요</option>
					</select>
				</div>

				<!-- 담당조직 -->
				<div class="mobile-form-group">
					<label>담당조직</label>
					<select id="mobileOrgId">
						<option value="">선택하세요</option>
					</select>
				</div>
				
				<!-- 고객사 (검색) -->
				<div class="mobile-form-group">
					<label>고객사 <span class="required">*</span></label>
					<div class="mobile-search-field">
						<input type="hidden" id="mobileCustomerId" required>
						<input 
							type="text" 
							id="mobileCustomerSearch" 
							placeholder="고객사명을 검색하세요..."
							autocomplete="off"
							readonly
							onclick="openMobileClientSearch('customer')"
						>
						<button type="button" class="btn-search" onclick="openMobileClientSearch('customer')">
							<i class="fas fa-search"></i>
						</button>
					</div>
					<div class="mobile-field-help">
						<i class="fas fa-info-circle"></i> 탭하여 고객사를 검색하세요
					</div>
				</div>
				
				<!-- 발주처 (검색) -->
				<div class="mobile-form-group">
					<label>발주처</label>
					<div class="mobile-search-field">
						<input type="hidden" id="mobileOrderingPartyId">
						<input 
							type="text" 
							id="mobileOrderingPartySearch" 
							placeholder="발주처명을 검색하세요..."
							autocomplete="off"
							readonly
							onclick="openMobileClientSearch('ordering')"
						>
						<button type="button" class="btn-search" onclick="openMobileClientSearch('ordering')">
							<i class="fas fa-search"></i>
						</button>
						<button type="button" class="btn-clear" onclick="clearMobileClient('ordering')" style="display: none;">
							<i class="fas fa-times"></i>
						</button>
					</div>
					<div class="mobile-field-help">
						<i class="fas fa-info-circle"></i> 고객사와 다른 경우만 입력
					</div>
				</div>
				
				<!-- 프로젝트명 -->
				<div class="mobile-form-group">
					<label>프로젝트명 <span class="required">*</span></label>
					<input type="text" id="mobileProjectName" required placeholder="프로젝트명을 입력하세요">
				</div>
				
				<!-- 진행단계 (STAGE) -->
				<div class="mobile-form-group">
					<label>진행단계 <span class="required">*</span></label>
					<select id="mobileCurrentStage" required>
						<option value="">선택하세요</option>
					</select>
				</div>
				
				<!-- 담당자 -->
				<div class="mobile-form-group">
					<label>담당자</label>
					<select id="mobileManagerId">
						<option value="">선택하세요</option>
					</select>
				</div>

				<!-- 프로젝트 등록/수정 폼에서 다음 필드들을 주석 처리 또는 제거 -->
				<!-- 				
				<div class="mobile-form-row">
					<div class="mobile-form-group">
						<label>연도</label>
						<input type="number" id="mobileYear" min="2020" max="2030">
					</div>
					
					<div class="mobile-form-group">
						<label>분기</label>
						<select id="mobileQuarter">
							<option value="">-</option>
							<option value="1">1분기</option>
							<option value="2">2분기</option>
							<option value="3">3분기</option>
							<option value="4">4분기</option>
						</select>
					</div>
				</div>
				
				<div class="mobile-form-group">
					<label>예상금액 (천원)</label>
					<input type="number" id="mobileExpectedAmount" step="1000" placeholder="0">
				</div>
				
				<div class="mobile-form-group">
					<label>확정금액 (천원)</label>
					<input type="number" id="mobileConfirmedAmount" step="1000" placeholder="0">
				</div>
				-->
				
				<!-- 비고 -->
				<div class="mobile-form-group">
					<label>비고</label>
					<textarea id="mobileRemarks" rows="3" placeholder="비고사항을 입력하세요"></textarea>
				</div>
				
				<!-- 액션 버튼 -->
				<div class="mobile-form-actions">
					<button type="button" class="btn-mobile btn-mobile-secondary" onclick="navigateTo('mobile-projects')">
						<i class="fas fa-times"></i> 취소
					</button>
					<button type="submit" class="btn-mobile btn-mobile-primary">
						<i class="fas fa-save"></i> 저장
					</button>
				</div>
			</form>
		</div>
	</div>

	<!-- ========================================
		 Mobile: 이력 등록
		 ======================================== -->
	<div id="page-mobile-history-new" class="page-content mobile-page">
		<div class="mobile-container">
			<!-- 헤더 -->
			<div class="mobile-header">
				<button class="btn-mobile-back" onclick="navigateTo('mobile-projects')">
					<i class="fas fa-arrow-left"></i>
				</button>
				<h2>이력 등록</h2>
				<button class="btn-mobile-icon" onclick="saveMobileHistory()">
					<i class="fas fa-save"></i>
				</button>
			</div>
			
			<!-- 폼 -->
			<form id="mobileHistoryForm" class="mobile-form" onsubmit="event.preventDefault(); saveMobileHistory();">
				
				<!-- 프로젝트 선택 -->
				<div class="mobile-form-group">
					<label>프로젝트 <span class="required">*</span></label>
					<select id="mobileHistoryProject" required onchange="loadMobileProjectInfo()">
						<option value="">프로젝트를 선택하세요</option>
					</select>
				</div>
				
				<!-- 선택된 프로젝트 정보 -->
				<div id="mobileProjectInfo" class="mobile-project-info" style="display: none;">
					<div class="mobile-info-row">
						<span class="mobile-info-label">고객사:</span>
						<span id="mobileInfoClient">-</span>
					</div>
					<div class="mobile-info-row">
						<span class="mobile-info-label">현재단계:</span>
						<span id="mobileInfoStage"></span>
					</div>
				</div>
				
				<!-- 이력 일자 -->
				<div class="mobile-form-group">
					<label>이력 일자 <span class="required">*</span></label>
					<input type="date" id="mobileHistoryDate" required>
				</div>
				
				<!-- 진행단계 -->
				<div class="mobile-form-group">
					<label>진행단계 <span class="required">*</span></label>
					<select id="mobileHistoryStage" required>
						<option value="">선택하세요</option>
					</select>
				</div>
				
				<!-- 이력 내용 -->
				<div class="mobile-form-group">
					<label>이력 내용 <span class="required">*</span></label>
					<textarea 
						id="mobileHistoryContent" 
						rows="6" 
						required 
						placeholder="영업 활동 내용, 진행 상황 등을 입력하세요..."
					></textarea>
				</div>
				
				<!-- 액션 버튼 -->
				<div class="mobile-form-actions">
					<button type="button" class="btn-mobile btn-mobile-secondary" onclick="resetMobileHistoryForm()">
						<i class="fas fa-redo"></i> 초기화
					</button>
					<button type="submit" class="btn-mobile btn-mobile-primary">
						<i class="fas fa-save"></i> 저장
					</button>
				</div>
			</form>
		</div>
	</div>
	
	<!-- ========================================
		 Mobile: 거래처 검색 모달
		 ======================================== -->
	<div id="mobileClientSearchModal" class="mobile-modal" style="display: none;">
		<div class="mobile-modal-content">
			<!-- 모달 헤더 -->
			<div class="mobile-modal-header">
				<h3 id="mobileClientSearchTitle">거래처 검색</h3>
				<button class="btn-mobile-close" onclick="closeMobileClientSearch()">
					<i class="fas fa-times"></i>
				</button>
			</div>
			
			<!-- 검색 입력 -->
			<div class="mobile-modal-search">
				<div class="mobile-search-box">
					<i class="fas fa-search"></i>
					<input 
						type="text" 
						id="mobileClientSearchInput" 
						placeholder="거래처명을 입력하세요..."
						autocomplete="off"
					>
				</div>
			</div>
			
			<!-- 검색 결과 -->
			<div class="mobile-modal-body">
				<div id="mobileClientSearchResults" class="mobile-client-list">
					<!-- 동적 생성 -->
				</div>
			</div>
		</div>
    </div>
        <!-- 나머지 준비중 페이지들... -->

    <!-- ===================================
         거래처 관리 - 목록 페이지
         =================================== -->
    <div id="page-clients-list" class="page-content">
        <main class="app-main">
            <!-- 통계 패널 -->
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statTotal">0</div>
                        <div class="stat-label">전체 거래처</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statActive">0</div>
                        <div class="stat-label">활성 거래처</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-pause-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statInactive">0</div>
                        <div class="stat-label">비활성 거래처</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-filter"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statFiltered">0</div>
                        <div class="stat-label">필터링 결과</div>
                    </div>
                </div>
            </div>

            <!-- 필터 패널 -->
            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-search"></i> 검색 구분</label>
                        <select id="clientSearchField" class="form-select">
                            <option value="">전체</option>
                            <option value="client_name">거래처명</option>
                            <option value="business_number">사업자번호</option>
                            <option value="ceo_name">대표자명</option>
                            <option value="phone">전화번호</option>
                        </select>
                    </div>
                    
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-keyboard"></i> 검색어</label>
                        <input 
                            type="text" 
                            id="clientSearchText" 
                            class="form-input" 
                            placeholder="검색어를 입력하세요"
                        />
                    </div>
                    
                    <div class="filter-group" style="flex: 0 0 auto;">
                        <label>&nbsp;</label>
                        <button class="btn btn-secondary" onclick="applyClientFilters()">
                            <i class="fas fa-search"></i> 검색
                        </button>
                    </div>
                    
                    <div class="filter-group">
                        <label><i class="fas fa-industry"></i> 업종</label>
                        <select id="clientIndustryType" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label><i class="fas fa-toggle-on"></i> 활성 상태</label>
                        <select id="clientIsActive" class="form-select">
                            <option value="">전체</option>
                            <option value="true">활성</option>
                            <option value="false">비활성</option>
                        </select>
                    </div>
                </div>
                
                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnNewClient" type="button" title="새 거래처 추가">
                        <i class="fas fa-plus-circle"></i> 신규
                    </button>
                    <button class="btn btn-info" onclick="resetClientFilters()">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                    <button class="btn btn-success" onclick="exportClientsToExcel()">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                </div>
            </div>

            <!-- 테이블 패널 -->
            <div class="table-panel">
                <div id="clientsTable"></div>
            </div>
        </main>
    </div>


    <!-- ===================================
         거래처 관리 - 등록/수정 페이지
         =================================== -->
    <div id="page-clients-form" class="page-content">
        <div class="form-container client-form-container">
            <div class="form-header">
                <div class="form-title">
                    <i class="fas fa-building"></i>
                    <h2 id="clientFormTitleText">신규 거래처 등록</h2>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" type="button" onclick="saveClientForm()">
                        <i class="fas fa-save"></i> 저장
                    </button>
                    <button class="btn btn-outline-secondary" type="button" data-client-nav="list">
                        <i class="fas fa-list"></i> 목록
                    </button>
                    <button class="btn btn-danger" type="button" id="btnDeleteClient" onclick="deleteClient()" style="display: none;">
                        <i class="fas fa-trash"></i> 삭제
                    </button>
                    <button class="btn btn-close-icon" type="button" data-client-nav="close" title="닫기">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- 거래처 폼 -->
            <form id="clientForm" class="tab-content client-form" onsubmit="event.preventDefault(); saveClientForm();">
                <input type="hidden" id="clientId">
                <input type="hidden" id="clientMode" value="new">

                <!-- 기본 정보 섹션 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-info-circle"></i>
                        기본 정보
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientName" class="required">거래처명</label>
                            <input type="text" id="clientName" class="form-input" required placeholder="거래처명을 입력하세요">
                        </div>
                        
                        <div class="form-group">
                            <label for="businessNumber">사업자번호</label>
                            <input type="text" id="businessNumber" class="form-input" placeholder="000-00-00000" maxlength="12">
                            <span class="form-hint">000-00-00000 형식으로 입력하세요</span>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ceoName">대표자명</label>
                            <input type="text" id="ceoName" class="form-input" placeholder="대표자명을 입력하세요">
                        </div>
                        
                        <div class="form-group">
                            <label for="industryType">업종</label>
                            <select id="industryType" class="form-select">
                                <option value="">선택하세요</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="establishedDate">설립일</label>
                            <input type="date" id="establishedDate" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="employeeCount">직원 수</label>
                            <input type="number" id="employeeCount" class="form-input" min="0" placeholder="직원 수">
                        </div>
                    </div>
                </div>

                <!-- 연락처 정보 섹션 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-phone"></i>
                        연락처 정보
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="address">주소</label>
                            <input type="text" id="address" class="form-input" placeholder="주소를 입력하세요">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone">전화번호</label>
                            <input type="tel" id="phone" class="form-input" placeholder="02-0000-0000">
                            <span class="form-hint">지역번호 포함 입력 (예: 02-0000-0000)</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="fax">팩스번호</label>
                            <input type="tel" id="fax" class="form-input" placeholder="02-0000-0000">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">이메일</label>
                            <input type="email" id="email" class="form-input" placeholder="example@company.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="homepage">홈페이지</label>
                            <input type="url" id="homepage" class="form-input" placeholder="https://www.example.com">
                        </div>
                    </div>
                </div>

                <!-- 추가 정보 섹션 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-cog"></i>
                        추가 정보
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="isActive">활성 상태</label>
                            <div class="form-switch-group">
                                <label class="form-switch">
                                    <input type="checkbox" id="isActive" class="form-switch-input" checked>
                                    <span class="form-switch-slider"></span>
                                </label>
                                <span class="form-switch-label">활성</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group form-group-full">
                            <label for="remarks">비고</label>
                            <textarea id="remarks" class="form-textarea" rows="4" placeholder="비고사항을 입력하세요"></textarea>
                        </div>
                    </div>
                </div>

                <!-- 액션 버튼 (하단 고정) -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary btn-lg" onclick="navigateToClientList()">
                        <i class="fas fa-list"></i>
                        목록으로
                    </button>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save"></i>
                        저장
                    </button>
                    <button type="button" class="btn btn-danger btn-lg" id="btnDeleteClientBottom" onclick="deleteClient()" style="display: none;">
                        <i class="fas fa-trash"></i>
                        삭제
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ===================================
         진행상황 조회
         =================================== -->
    <div id="page-project-history-calendar" class="page-content">
        <main class="app-main ph-main">
            <div class="ph-shell">
                <div class="ph-header">
                    <div>
                        <h2><i class="fas fa-calendar-check"></i> 진행상황 조회</h2>
                        <p>지정된 기간의 Project History를 달력과 카드로 확인하고, 선택 결과를 엑셀로 출력합니다.</p>
                    </div>
                    <div class="ph-header-actions">
                        <button class="btn btn-secondary" id="btnHistoryToday">
                            <i class="fas fa-bullseye"></i> 오늘
                        </button>
                        <button class="btn btn-primary" id="btnHistoryRefresh">
                            <i class="fas fa-rotate"></i> 새로고침
                        </button>
                    </div>
                </div>

                <div class="ph-controls">
                    <div class="ph-control-row">
                    </div>

                    <div class="ph-control-row ph-filter-row">
                        <div class="ph-control-group">
                            <label><i class="fas fa-tags"></i> 분야</label>
                            <select id="historyFilterField" class="form-select" multiple></select>
                        </div>
                        <div class="ph-control-group">
                            <label><i class="fas fa-layer-group"></i> 서비스</label>
                            <select id="historyFilterService" class="form-select" multiple></select>
                        </div>
                        <div class="ph-control-group">
                            <label><i class="fas fa-tags"></i> 활동유형</label>
                            <select id="historyFilterActivityType" class="form-select" multiple></select>
                        </div>
                        <div class="ph-control-group">
                            <label><i class="fas fa-user"></i> 담당자</label>
                            <select id="historyFilterManager" class="form-select" multiple></select>
                        </div>
                        <div class="ph-control-group">
                            <label><i class="fas fa-sitemap"></i> 조직</label>
                            <select id="historyFilterOrg" class="form-select" multiple></select>
                        </div>
                        <div class="ph-control-group ph-project-search">
                            <label><i class="fas fa-search"></i> 프로젝트</label>
                            <input type="text" id="historyProjectSearch" class="form-input" placeholder="프로젝트/고객사/발주사/ID 검색">
                            <select id="historyProjectSelect" class="form-select"></select>
                            <div class="ph-project-pagination" id="historyProjectPaging"></div>
                        </div>
                    </div>

                    <div class="ph-control-row ph-view-row">
                        <div class="ph-control-group">
                            <label><i class="fas fa-layer-group"></i> 보기 유형</label>
                            <div class="ph-view-toggle">
                                <button class="btn btn-toggle active" data-view="year">Year</button>
                                <button class="btn btn-toggle" data-view="month">Month</button>
                                <button class="btn btn-toggle" data-view="week">Week</button>
                                <button class="btn btn-toggle" data-view="daily">Daily Card</button>
                            </div>
                        </div>
                        <div class="ph-control-group ph-tooltip-toggle">
                            <label><i class="fas fa-comment-dots"></i> 툴팁 보기</label>
                            <div class="ph-inline-controls">
                                <input type="checkbox" id="historyTooltipToggle">
                                <span class="ph-toggle-text">보기</span>
                            </div>
                        </div>
                        <div class="ph-year-controls">
                            <div class="ph-control-group">
                                <label><i class="fas fa-calendar"></i> 연도</label>
                                <select id="historyYearSelect" class="form-select"></select>
                            </div>
                            <div class="ph-control-group">
                                <label><i class="fas fa-th-large"></i> 배치</label>
                                <select id="historyYearLayout" class="form-select">
                                    <option value="3x4">3x4</option>
                                    <option value="4x3" selected>4x3</option>
                                    <option value="1x12">1x12</option>
                                    <option value="2x6">2x6</option>
                                    <option value="6x2">6x2</option>
                                </select>
                            </div>
                            <div class="ph-control-group">
                                <label><i class="fas fa-sort"></i> 월 정렬</label>
                                <div class="ph-inline-controls">
                                    <select id="historyMonthOrder" class="form-select">
                                        <option value="normal">연도순</option>
                                        <option value="current-first">현재월 먼저</option>
                                        <option value="current-last" selected>현재월 마지막</option>
                                        <option value="current-slot">현재월 지정</option>
                                    </select>
                                    <input type="number" id="historyMonthSlot" class="form-input ph-slot-input" min="1" max="12" value="1">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="ph-control-row ph-selection-row">
                        <div class="ph-selection-summary" id="historySelectionSummary">
                            선택된 일자: 0개
                        </div>
                        <div class="ph-selection-actions">
                            <button class="btn btn-secondary" id="btnHistoryViewSelection" disabled>
                                <i class="fas fa-list"></i> 선택 이력 보기
                            </button>
                            <button class="btn btn-success" id="btnHistoryExportSelection" disabled>
                                <i class="fas fa-file-excel"></i> 선택 엑셀
                            </button>
                        </div>
                    </div>
                </div>

                <div class="ph-view-container">
                    <div class="ph-calendar-nav">
                        <div class="ph-nav-left">
                            <button class="btn btn-outline" id="btnHistoryPrevRange"><i class="fas fa-chevron-left"></i> 이전</button>
                            <button class="btn btn-outline" id="btnHistoryNextRange">다음 <i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="ph-nav-label" id="historyPeriodLabel">-</div>
                        <div class="ph-nav-right" id="historyNavRight"></div>
                    </div>
                    <div class="ph-legend" id="historyLegend">
                        <span class="ph-legend-item">
                            <span class="ph-legend-dots" id="legendStageDots"></span>
                            진행단계 색상
                        </span>
                        <span class="ph-legend-item">
                            <span class="ph-legend-dots" id="legendComboDots"></span>
                            분야/서비스/담당자/조직 조합 색상
                        </span>
                        <span class="ph-legend-item">
                            <span class="ph-legend-dots" id="legendActivityDots"></span>
                            활동유형 색상
                        </span>
                    </div>
                    <div id="historyYearView" class="ph-year-view"></div>
                    <div id="historyCalendar" class="ph-calendar"></div>
                    <div id="historyWeekList" class="ph-week-list"></div>
                    <div id="historyDailyView" class="ph-daily-view"></div>
                    <div id="historyTooltip" class="ph-tooltip" aria-hidden="true"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- ===================================
         프로젝트 대시보드
         =================================== -->
    <div id="page-sales-dashboard" class="page-content">
        <main class="app-main ceo-dashboard-main">
            <div class="ceo-dashboard-shell">
                <div class="ceo-dashboard-header">
                    <div>
                        <h2><i class="fas fa-chart-line"></i> CEO 프로젝트 대시보드</h2>
                        <p>파이프라인, 실적, 리스크를 한 화면에서 확인합니다.</p>
                    </div>
                    <div class="ceo-dashboard-controls">
                        <label for="ceoYearSelect">기준연도</label>
                        <select id="ceoYearSelect" class="form-select"></select>
                        <button class="btn btn-primary" id="btnCeoRefresh">
                            <i class="fas fa-rotate"></i> 새로고침
                        </button>
                        <div class="ceo-theme-toggle">
                            <span class="ceo-theme-label"><i class="fas fa-moon"></i> Dark</span>
                            <label class="form-switch">
                                <input type="checkbox" id="ceoDashboardDarkToggle" class="form-switch-input">
                                <span class="form-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="ceo-kpi-grid">
                    <div class="ceo-kpi-card">
                        <div class="ceo-kpi-title">연간 수주</div>
                        <div class="ceo-kpi-value" id="ceoKpiOrderTotal">-</div>
                        <div class="ceo-kpi-sub" id="ceoKpiOrderYoY">전년 대비 -</div>
                    </div>
                    <div class="ceo-kpi-card">
                        <div class="ceo-kpi-title">연간 이익</div>
                        <div class="ceo-kpi-value" id="ceoKpiProfitTotal">-</div>
                        <div class="ceo-kpi-sub">실적 집계 기준</div>
                    </div>
                    <div class="ceo-kpi-card">
                        <div class="ceo-kpi-title">계획 대비 달성률</div>
                        <div class="ceo-kpi-value" id="ceoKpiAchievement">-</div>
                        <div class="ceo-kpi-sub" id="ceoKpiPlanTotal">계획 -</div>
                    </div>
                    <div class="ceo-kpi-card">
                        <div class="ceo-kpi-title">활동 파이프라인</div>
                        <div class="ceo-kpi-value" id="ceoKpiPipeline">-</div>
                        <div class="ceo-kpi-sub" id="ceoKpiExpected">예상매출 -</div>
                    </div>
                    <div class="ceo-kpi-card">
                        <div class="ceo-kpi-title">평균 수주확률</div>
                        <div class="ceo-kpi-value" id="ceoKpiAvgProb">-</div>
                        <div class="ceo-kpi-sub" id="ceoKpiProjectCount">활동 프로젝트 -건</div>
                    </div>
                    <div class="ceo-kpi-card ceo-kpi-risk">
                        <div class="ceo-kpi-title">리스크 프로젝트</div>
                        <div class="ceo-kpi-value" id="ceoKpiRiskCount">-</div>
                        <div class="ceo-kpi-sub" id="ceoKpiRiskDetail">기한/저확률/장기미갱신</div>
                    </div>
                </div>

                <div class="ceo-chart-grid">
                    <section class="ceo-card ceo-card-wide">
                        <div class="ceo-card-title">월별 수주 추이 (실적/전년/계획)</div>
                        <canvas id="ceoMonthlyTrendChart"></canvas>
                    </section>

                    <section class="ceo-card">
                        <div class="ceo-card-title">분기별 계획 대비 실적</div>
                        <canvas id="ceoQuarterCompareChart"></canvas>
                    </section>

                    <section class="ceo-card">
                        <div class="ceo-card-title">단계별 파이프라인</div>
                        <canvas id="ceoStageFunnelChart"></canvas>
                    </section>

                    <section class="ceo-card">
                        <div class="ceo-card-title">수주확률 분포</div>
                        <canvas id="ceoProbabilityChart"></canvas>
                    </section>

                    <section class="ceo-card">
                        <div class="ceo-card-title">담당자 TOP5 (예상매출)</div>
                        <canvas id="ceoManagerTopChart"></canvas>
                    </section>

                    <section class="ceo-card">
                        <div class="ceo-card-title">분야별 파이프라인 비중</div>
                        <canvas id="ceoFieldMixChart"></canvas>
                    </section>
                </div>

                <div class="ceo-list-grid">
                    <section class="ceo-card">
                        <div class="ceo-card-title">리스크 프로젝트</div>
                        <div id="ceoRiskProjects" class="ceo-list-scroll"></div>
                    </section>
                    <section class="ceo-card">
                        <div class="ceo-card-title">고객사 TOP10 (예상매출)</div>
                        <div id="ceoTopCustomers" class="ceo-list-scroll"></div>
                    </section>
                </div>

                <div class="ceo-dashboard-footer">
                    <span id="ceoDashboardGeneratedAt">갱신시각: -</span>
                </div>
            </div>
        </main>
    </div>

    <!-- ===================================
         영업계획 - 목록 페이지
         =================================== -->
    <div id="page-sales-plan-list" class="page-content">
        <main class="app-main">
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #0f766e 0%, #0d9488 100%);">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatTotal">0</div>
                        <div class="stat-label">전체 계획</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #38bdf8 0%, #0ea5e9 100%);">
                        <i class="fas fa-calendar"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatLatest">-</div>
                        <div class="stat-label">최신 연도</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f97316 0%, #fb923c 100%);">
                        <i class="fas fa-pen"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatDraft">0</div>
                        <div class="stat-label">작성중</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatFinal">0</div>
                        <div class="stat-label">확정</div>
                    </div>
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-calendar-alt"></i> 연도</label>
                        <select id="planYearFilter" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-code-branch"></i> 버전</label>
                        <input type="text" id="planVersionFilter" class="form-input" placeholder="v1, v2...">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-flag"></i> 상태</label>
                        <select id="planStatusFilter" class="form-select">
                            <option value="">전체</option>
                            <option value="DRAFT">작성중</option>
                            <option value="REVIEW">검토중</option>
                            <option value="FINAL">확정</option>
                            <option value="CANCELLED">폐기</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-search"></i> 검색어</label>
                        <input type="text" id="planKeywordFilter" class="form-input" placeholder="비고/기준일 등">
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnNewPlan">
                        <i class="fas fa-plus-circle"></i> 신규 계획
                    </button>
                    <button class="btn btn-info" id="btnEditPlan">
                        <i class="fas fa-pen-to-square"></i> 계획 편집
                    </button>
                    <button class="btn btn-secondary" id="btnCopyPlan">
                        <i class="fas fa-copy"></i> 버전 복사
                    </button>
                    <button class="btn btn-danger" id="btnCancelPlan">
                        <i class="fas fa-ban"></i> 폐기
                    </button>
                    <button class="btn btn-success" id="btnRefreshPlan">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                    <button class="btn btn-outline-secondary" id="btnExportPlan">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                </div>
            </div>

            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-route"></i>
                        워크플로우 가이드
                    </div>
                </div>
                <div class="helper-text">
                    계획 연도/버전 생성 → 계획 입력 → 검토/확정 순으로 관리합니다. 동일 연도는 버전으로 이력을 분리합니다.
                </div>
            </div>

            <div class="table-panel">
                <div id="salesPlanTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         영업계획 - 입력 페이지
         =================================== -->
    <div id="page-sales-plan-edit" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-clipboard-list"></i>
                        계획 컨텍스트
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-info" id="btnPlanImport">
                            <i class="fas fa-download"></i> 대상 프로젝트 불러오기
                        </button>
                        <button class="btn btn-primary" id="btnPlanHeaderSave">
                            <i class="fas fa-save"></i> 계획 저장
                        </button>
                    </div>
                </div>

                <div class="plan-context-grid">
                    <div class="plan-meta-item">
                        <label>계획 선택</label>
                        <select id="salesPlanSelect" class="form-select"></select>
                    </div>
                    <div class="plan-meta-item">
                        <label>연도</label>
                        <input type="text" id="salesPlanYear" class="form-input" placeholder="2026">
                    </div>
                    <div class="plan-meta-item">
                        <label>버전</label>
                        <input type="text" id="salesPlanVersion" class="form-input" placeholder="v1">
                    </div>
                    <div class="plan-meta-item">
                        <label>상태</label>
                        <select id="salesPlanStatus" class="form-select">
                            <option value="DRAFT">작성중</option>
                            <option value="REVIEW">검토중</option>
                            <option value="FINAL">확정</option>
                            <option value="CANCELLED">폐기</option>
                        </select>
                    </div>
                    <div class="plan-meta-item">
                        <label>기준일</label>
                        <input type="date" id="salesPlanBaseDate" class="form-input">
                    </div>
                    <div class="plan-meta-item">
                        <label>비고</label>
                        <input type="text" id="salesPlanRemarks" class="form-input" placeholder="예: 본부 검토본">
                    </div>
                </div>
                <div class="helper-text">
                    계획 헤더는 연도/버전 단위로 관리합니다. 확정 상태는 수정 권한에 따라 잠금될 수 있습니다.
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-sitemap"></i> 조직</label>
                        <select id="planFilterOrg" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-user"></i> 담당자</label>
                        <select id="planFilterManager" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-tags"></i> 분야</label>
                        <select id="planFilterField" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-layer-group"></i> 서비스</label>
                        <select id="planFilterService" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-search"></i> 검색어</label>
                        <input type="text" id="planFilterKeyword" class="form-input" placeholder="프로젝트명/고객사 등">
                    </div>
                    <div class="filter-group" style="min-width: 160px;">
                        <label>&nbsp;</label>
                        <button class="btn btn-outline-secondary" id="btnPlanShowAll">
                            <i class="fas fa-list"></i> 전체 라인 보기
                        </button>
                    </div>
                    <div class="filter-group" style="min-width: 140px;">
                        <label>&nbsp;</label>
                        <button class="btn btn-primary" id="btnPlanSearch">
                            <i class="fas fa-search"></i> 조회
                        </button>
                    </div>
                </div>
            </div>

            <div class="panel-card">
                <div class="plan-toolbar">
                    <div class="toolbar-left">
                        <span class="plan-badge" id="planConsistencyBadge">
                            <i class="fas fa-circle-check"></i> 합계 검증 대기
                        </span>
                        <span class="helper-text">월별 합계는 자동 합산됩니다.</span>
                        <div class="plan-freeze-control">
                            <label for="planFreezeColumn"><i class="fas fa-thumbtack"></i> 고정 열</label>
                            <select id="planFreezeColumn" class="form-select">
                                <option value="">고정 없음</option>
                            </select>
                        </div>
                        <div class="plan-freeze-control excel-mode-control">
                            <label class="excel-mode-label" for="planExcelMode">
                                <i class="fas fa-table"></i> 엑셀 모드
                            </label>
                            <label class="form-switch">
                                <input type="checkbox" id="planExcelMode" class="form-switch-input">
                                <span class="form-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-primary" id="btnPlanEditSelected">
                            <i class="fas fa-pen-to-square"></i> 프로젝트 입력
                        </button>
                        <button class="btn btn-danger" id="btnPlanExclude">
                            <i class="fas fa-ban"></i> 선택 제외
                        </button>
                        <button class="btn btn-outline-secondary" id="btnPlanColumns">
                            <i class="fas fa-columns"></i> 컬럼 설정
                        </button>
                        <button class="btn btn-outline-secondary" id="btnPlanPasteExcel">
                            <i class="fas fa-paste"></i> 엑셀 붙여넣기
                        </button>
                        <button class="btn btn-secondary" id="btnPlanRecalc">
                            <i class="fas fa-calculator"></i> 합계 계산
                        </button>
                        <button class="btn btn-success" id="btnPlanSave">
                            <i class="fas fa-save"></i> 라인 저장
                        </button>
                        <button class="btn btn-outline-secondary" id="btnPlanExport">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                    </div>
                </div>
                <div id="salesPlanLineTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         실적관리 - 등록 페이지
         =================================== -->
    <div id="page-sales-actual-entry" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-clipboard-check"></i>
                        실적 컨텍스트
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" id="btnActualLoadTargets">
                            <i class="fas fa-download"></i> 등록 대상 불러오기
                        </button>
                        <button class="btn btn-primary" id="btnActualHeaderSave">
                            <i class="fas fa-save"></i> 대상 저장
                        </button>
                    </div>
                </div>

                <div class="actual-context-grid">
                    <div class="actual-meta-item">
                        <label>연도</label>
                        <select id="salesActualYear" class="form-select"></select>
                    </div>
                    <div class="actual-meta-item">
                        <label>기준</label>
                        <span class="actual-badge"><i class="fas fa-chart-line"></i> 수주/이익</span>
                    </div>
                    <div class="actual-meta-item">
                        <label>작성 메모</label>
                        <input type="text" id="salesActualRemarks" class="form-input" placeholder="예: 1차 결산 기준">
                    </div>
                </div>
                <div class="helper-text">
                    실적은 연도 단위로 관리하며, 월별 수주금액과 매출이익을 함께 입력합니다.
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-sitemap"></i> 조직</label>
                        <select id="actualFilterOrg" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-user"></i> 담당자</label>
                        <select id="actualFilterManager" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-tags"></i> 분야</label>
                        <select id="actualFilterField" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-layer-group"></i> 서비스</label>
                        <select id="actualFilterService" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-search"></i> 검색어</label>
                        <input type="text" id="actualFilterKeyword" class="form-input" placeholder="프로젝트명/고객사 등">
                    </div>
                    <div class="filter-group" style="min-width: 140px;">
                        <label>&nbsp;</label>
                        <button class="btn btn-primary" id="btnActualSearch">
                            <i class="fas fa-search"></i> 조회
                        </button>
                    </div>
                </div>
            </div>

            <div class="panel-card">
                <div class="actual-toolbar">
                    <div class="toolbar-left">
                        <span class="actual-badge" id="actualConsistencyBadge">
                            <i class="fas fa-circle-check"></i> 합계 검증 대기
                        </span>
                        <span class="helper-text">월별 합계는 자동 합산됩니다.</span>
                        <div class="plan-freeze-control">
                            <label for="actualMonthView"><i class="fas fa-table-columns"></i> 월별 표시</label>
                            <select id="actualMonthView" class="form-select">
                                <option value="group">그룹(1월/수주·이익)</option>
                                <option value="flat">평면(월별/수주·이익)</option>
                            </select>
                        </div>
                        <div class="plan-freeze-control">
                            <label for="actualFreezeColumn"><i class="fas fa-thumbtack"></i> 고정 열</label>
                            <select id="actualFreezeColumn" class="form-select">
                                <option value="">고정 없음</option>
                            </select>
                        </div>
                        <div class="plan-freeze-control excel-mode-control">
                            <label class="excel-mode-label" for="actualExcelMode">
                                <i class="fas fa-table"></i> 엑셀 모드
                            </label>
                            <label class="form-switch">
                                <input type="checkbox" id="actualExcelMode" class="form-switch-input">
                                <span class="form-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-primary" id="btnActualEditSelected">
                            <i class="fas fa-pen-to-square"></i> 실적 입력
                        </button>
                        <button class="btn btn-danger" id="btnActualExcludeSelected">
                            <i class="fas fa-ban"></i> 선택 제외
                        </button>
                        <button class="btn btn-outline-secondary" id="btnActualColumns">
                            <i class="fas fa-columns"></i> 컬럼 설정
                        </button>
                        <button class="btn btn-outline-secondary" id="btnActualPasteExcel">
                            <i class="fas fa-paste"></i> 엑셀 붙여넣기
                        </button>
                        <button class="btn btn-secondary" id="btnActualRecalc">
                            <i class="fas fa-calculator"></i> 합계 계산
                        </button>
                        <button class="btn btn-success" id="btnActualSave">
                            <i class="fas fa-save"></i> 대상 저장
                        </button>
                        <button class="btn btn-outline-secondary" id="btnActualExport">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                    </div>
                </div>
                <div id="salesActualLineTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         실적관리 - 현황 페이지
         =================================== -->
    <div id="page-sales-actual-dashboard" class="page-content">
        <main class="app-main">
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4338ca 0%, #2563eb 100%);">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatOrder">0</div>
                        <div class="stat-label">수주 합계</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatProfit">0</div>
                        <div class="stat-label">매출이익 합계</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f97316 0%, #fb923c 100%);">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatYear">-</div>
                        <div class="stat-label">선택 연도</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #64748b 0%, #475569 100%);">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatGroup">-</div>
                        <div class="stat-label">집계 기준</div>
                    </div>
                </div>
            </div>

            <div class="filter-panel actual-summary-filter-panel">
                <div class="actual-summary-filter-layout">
                    <div class="filter-group actual-summary-group-box">
                        <label><i class="fas fa-layer-group"></i> 집계 기준 (복수/순서)</label>
                        <div class="actual-summary-group-controls">
                            <select id="actualSummaryGroups" class="form-select" multiple size="5">
                                <option value="org" selected>조직</option>
                                <option value="manager">담당자</option>
                                <option value="field">분야</option>
                                <option value="service">서비스</option>
                                <option value="customer">고객사</option>
                                <option value="pipeline">파이프라인</option>
                            </select>
                            <div class="actual-summary-group-buttons">
                                <button class="btn btn-outline-secondary btn-sm" type="button" id="btnActualSummaryGroupUp"><i class="fas fa-arrow-up"></i></button>
                                <button class="btn btn-outline-secondary btn-sm" type="button" id="btnActualSummaryGroupDown"><i class="fas fa-arrow-down"></i></button>
                                <button class="btn btn-outline-secondary btn-sm" type="button" id="btnActualSummaryGroupAll">전체</button>
                                <button class="btn btn-outline-secondary btn-sm" type="button" id="btnActualSummaryGroupClear">해제</button>
                            </div>
                        </div>
                    </div>
                    <div class="actual-summary-main-controls">
                        <div class="filter-group">
                            <label><i class="fas fa-calendar-alt"></i> 연도</label>
                            <select id="actualSummaryYear" class="form-select"></select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-clock"></i> 기간 조건</label>
                            <select id="actualSummaryPeriod" class="form-select">
                                <option value="year">년</option>
                                <option value="quarter">분기</option>
                                <option value="month">월</option>
                            </select>
                        </div>
                    </div>
                    <div class="actual-summary-period-detail">
                        <div class="filter-group" id="actualSummaryQuarterWrap" style="display:none;">
                            <label><i class="fas fa-calendar-week"></i> 분기 선택</label>
                            <div class="actual-summary-check-grid">
                                <label><input type="checkbox" class="actual-summary-quarter" value="1" checked> Q1</label>
                                <label><input type="checkbox" class="actual-summary-quarter" value="2" checked> Q2</label>
                                <label><input type="checkbox" class="actual-summary-quarter" value="3" checked> Q3</label>
                                <label><input type="checkbox" class="actual-summary-quarter" value="4" checked> Q4</label>
                            </div>
                        </div>
                        <div class="filter-group" id="actualSummaryMonthWrap" style="display:none;">
                            <label><i class="fas fa-calendar-day"></i> 월 선택</label>
                            <div class="actual-summary-check-grid">
                                <label><input type="checkbox" class="actual-summary-month" value="1" checked> 1월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="2" checked> 2월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="3" checked> 3월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="4" checked> 4월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="5" checked> 5월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="6" checked> 6월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="7" checked> 7월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="8" checked> 8월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="9" checked> 9월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="10" checked> 10월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="11" checked> 11월</label>
                                <label><input type="checkbox" class="actual-summary-month" value="12" checked> 12월</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnActualSummaryRun">
                        <i class="fas fa-play"></i> 조회
                    </button>
                    <button class="btn btn-success" id="btnActualSummaryExport">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                </div>
            </div>

            <div class="table-panel">
                <div id="salesActualSummaryTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         Report - 유형별 현황 페이지
         =================================== -->
    <div id="page-report-hub" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-chart-pie"></i>
                        Report Builder
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" id="btnReportRun">
                            <i class="fas fa-play"></i> 조회
                        </button>
                        <button class="btn btn-success" id="btnReportExport">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                    </div>
                </div>
                <div class="helper-text">
                    조회 유형과 집계 기준을 선택하면 동적으로 보고서를 생성합니다.
                </div>
            </div>

            <div class="report-builder">
                <div class="report-config">
                    <h3>보고서 설정</h3>
                    <div class="form-group">
                        <label>데이터 소스</label>
                        <select id="reportSource" class="form-select">
                            <option value="plan">영업계획</option>
                            <option value="actual">실적관리</option>
                            <option value="gap">계획 대비 실적</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>기준 연도</label>
                        <select id="reportYear" class="form-select"></select>
                    </div>
                    <div class="form-group" id="reportPlanWrap">
                        <label>영업계획</label>
                        <select id="reportPlanId" class="form-select">
                            <option value="">자동(최신 계획)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>집계 기준</label>
                        <select id="reportDimension" class="form-select">
                            <option value="org">조직</option>
                            <option value="manager">담당자</option>
                            <option value="field">분야</option>
                            <option value="service">서비스</option>
                            <option value="customer">고객사</option>
                            <option value="pipeline">프로젝트</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>기간 단위</label>
                        <select id="reportPeriod" class="form-select">
                            <option value="year">연도 합계</option>
                            <option value="quarter">분기</option>
                            <option value="month">월</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>지표</label>
                        <select id="reportMetric" class="form-select">
                            <option value="order">수주금액</option>
                            <option value="profit">매출이익</option>
                            <option value="both">수주+이익</option>
                        </select>
                    </div>
                </div>
                <div class="report-result">
                    <div class="report-filter-panel report-filter-grid">
                        <div class="filter-group filter-group-multi">
                            <label><i class="fas fa-sitemap"></i> 조직 (복수)</label>
                            <select id="reportFilterOrg" class="form-select" multiple size="6"></select>
                            <div class="multi-select-actions">
                                <button type="button" class="btn btn-outline-secondary btn-sm" id="btnReportOrgAll">전체 선택</button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" id="btnReportOrgClear">선택 해제</button>
                            </div>
                        </div>
                        <div class="filter-group filter-group-multi">
                            <label><i class="fas fa-user"></i> 담당자 (복수)</label>
                            <select id="reportFilterManager" class="form-select" multiple size="6"></select>
                            <div class="multi-select-actions">
                                <button type="button" class="btn btn-outline-secondary btn-sm" id="btnReportManagerAll">전체 선택</button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" id="btnReportManagerClear">선택 해제</button>
                            </div>
                        </div>
                        <div class="report-controls-vertical">
                            <div class="report-control-row">
                                <label for="reportHeaderMode"><i class="fas fa-table"></i> 헤더 표시</label>
                                <select id="reportHeaderMode" class="form-select">
                                    <option value="two" selected>2줄</option>
                                    <option value="one">1줄</option>
                                </select>
                            </div>
                            <div class="report-control-row">
                                <label for="reportViewMode"><i class="fas fa-arrows-left-right"></i> 표시 방식</label>
                                <select id="reportViewMode" class="form-select">
                                    <option value="row" selected>세로(행)</option>
                                    <option value="pivot">가로(피벗)</option>
                                </select>
                            </div>
                            <div class="report-control-row">
                                <label for="reportFreezeTargetCount"><i class="fas fa-thumbtack"></i> 고정 대상 수</label>
                                <input type="number" id="reportFreezeTargetCount" class="form-input" min="0" value="0" placeholder="0">
                            </div>
                            <div class="report-control-row">
                                <span class="helper-text">0=기본, 1=첫번째 대상까지 고정</span>
                                <button class="btn btn-outline-secondary" id="btnReportFilterReset">
                                    <i class="fas fa-undo"></i> 필터 초기화
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="report-title" id="reportTitle">보고서 조건을 선택하세요.</div>
                    <div class="table-panel report-table-panel">
                        <div id="reportTable"></div>
                    </div>
                    <div class="report-placeholder" id="reportPlaceholder">
                        조회 조건을 설정하고 실행하면 결과가 표시됩니다.
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ===================================
         대상 프로젝트 불러오기 모달
         =================================== -->
    <div id="missingProjectsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-download"></i> 대상 프로젝트 불러오기</h2>
                <button class="modal-close" type="button" onclick="closeMissingProjectsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="filter-panel" style="margin-bottom: 1rem;">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label><i class="fas fa-sitemap"></i> 조직</label>
                            <select id="missingFilterOrg" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-user"></i> 담당자</label>
                            <select id="missingFilterManager" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-tags"></i> 분야</label>
                            <select id="missingFilterField" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-layer-group"></i> 서비스</label>
                            <select id="missingFilterService" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group" style="flex: 2;">
                            <label><i class="fas fa-search"></i> 검색어</label>
                            <input type="text" id="missingFilterKeyword" class="form-input" placeholder="프로젝트명/고객사 등">
                        </div>
                        <div class="filter-group" style="min-width: 160px;">
                            <label><i class="fas fa-filter"></i> 조회 옵션</label>
                            <label style="display:flex;align-items:center;gap:0.4rem;height:42px;">
                                <input type="checkbox" id="missingOnlyUnplanned" checked>
                                <span>미편성 프로젝트만</span>
                            </label>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-primary" type="button" id="btnMissingApply">
                            <i class="fas fa-search"></i> 적용
                        </button>
                        <button class="btn btn-secondary" type="button" id="btnMissingReset">
                            <i class="fas fa-undo"></i> 초기화
                        </button>
                    </div>
                </div>
                <div class="panel-card" style="padding: 1rem; margin-bottom: 1rem;">
                    <div class="helper-text" id="missingProjectsCurrentLineSummary" style="margin-bottom: 0.35rem;">
                        현재 계획 라인 정보: -
                    </div>
                    <div class="helper-text" id="missingProjectsFilterSummary">
                        현재 필터 조건을 적용하여 대상 프로젝트를 조회합니다.
                    </div>
                </div>
                <div id="missingProjectsTable"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="refreshMissingProjects()">
                    <i class="fas fa-sync-alt"></i> 조회
                </button>
                <button class="btn btn-primary" type="button" onclick="addSelectedMissingProjects()">
                    <i class="fas fa-plus-circle"></i> 선택 반영
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closeMissingProjectsModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         계획 컬럼 설정 모달
         =================================== -->
    <div id="planColumnsModal" class="modal">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-columns"></i> 계획 컬럼 설정</h2>
                <button class="modal-close" type="button" onclick="closePlanColumnsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="column-group-actions">
                    <div class="column-group">
                        <span class="column-group-label">기본정보</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="togglePlanColumnGroup('base')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                    <div class="column-group">
                        <span class="column-group-label">월별</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="togglePlanColumnGroup('month')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                </div>
                <div class="helper-text" style="margin-bottom: 0.75rem;">
                    컬럼 순서는 그리드 헤더를 드래그해 변경하며, 변경 사항은 자동 저장됩니다.
                </div>
                <div id="planColumnsList" class="column-visibility-list"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="setAllPlanColumns(true)">
                    <i class="fas fa-eye"></i> 모두 표시
                </button>
                <button class="btn btn-secondary" type="button" onclick="setAllPlanColumns(false)">
                    <i class="fas fa-eye-slash"></i> 모두 숨김
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closePlanColumnsModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         영업계획 단건 입력 모달
         =================================== -->
    <div id="planLineEditModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-pen-to-square"></i> 프로젝트 계획 입력</h2>
                <button class="modal-close" type="button" onclick="closePlanLineEditModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="plan-line-meta-grid">
                    <div class="plan-meta-item">
                        <label>파이프라인ID</label>
                        <input type="text" id="planEditPipelineId" class="form-input" readonly>
                    </div>
                    <div class="plan-meta-item">
                        <label>프로젝트명</label>
                        <input type="text" id="planEditProjectName" class="form-input" readonly>
                    </div>
                    <div class="plan-meta-item">
                        <label>고객사</label>
                        <input type="text" id="planEditCustomerName" class="form-input" readonly>
                    </div>
                    <div class="plan-meta-item">
                        <label>담당조직</label>
                        <input type="text" id="planEditOrgName" class="form-input" readonly>
                    </div>
                    <div class="plan-meta-item">
                        <label>담당자</label>
                        <input type="text" id="planEditManagerName" class="form-input" readonly>
                    </div>
                    <div class="plan-meta-item">
                        <label>계약(예정)일자</label>
                        <input type="date" id="planEditContractDate" class="form-input">
                    </div>
                    <div class="plan-meta-item">
                        <label>계약 시작일</label>
                        <input type="date" id="planEditStartDate" class="form-input">
                    </div>
                    <div class="plan-meta-item">
                        <label>계약 종료일</label>
                        <input type="date" id="planEditEndDate" class="form-input">
                    </div>
                </div>
                <div class="plan-line-month-grid" id="planLineMonthGrid"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" id="btnPlanLineApply">
                    <i class="fas fa-check"></i> 반영
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closePlanLineEditModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         영업계획 엑셀 붙여넣기 모달
         =================================== -->
    <div id="planPasteModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-paste"></i> 영업계획 엑셀 붙여넣기</h2>
                <button class="modal-close" type="button" onclick="closePlanPasteModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>엑셀에서 복사한 내용을 붙여넣기</label>
                    <textarea id="planPasteInput" class="form-textarea" rows="10" placeholder="헤더 포함 상태로 붙여넣기 해주세요.&#10;예: 파이프라인ID | 1월 | 2월 | ... | 12월"></textarea>
                    <small><i class="fas fa-circle-info"></i> 헤더 타이틀 기준으로 컬럼을 매칭합니다. (파이프라인ID, 1월~12월)</small>
                </div>
                <div id="planPastePreview" class="paste-preview"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-secondary" type="button" id="btnPlanPastePreview">
                    <i class="fas fa-eye"></i> 미리보기
                </button>
                <button class="btn btn-primary" type="button" id="btnPlanPasteApply">
                    <i class="fas fa-check"></i> 적용
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closePlanPasteModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         실적 컬럼 설정 모달
         =================================== -->
    <div id="actualColumnsModal" class="modal">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-columns"></i> 실적 컬럼 설정</h2>
                <button class="modal-close" type="button" onclick="closeActualColumnsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="column-group-actions">
                    <div class="column-group">
                        <span class="column-group-label">기본정보</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="toggleActualColumnGroup('base')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                    <div class="column-group">
                        <span class="column-group-label">월별</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="toggleActualColumnGroup('month')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                </div>
                <div class="helper-text" style="margin-bottom: 0.75rem;">
                    컬럼 순서는 그리드 헤더를 드래그해 변경하며, 변경 사항은 자동 저장됩니다.
                </div>
                <div id="actualColumnsList" class="column-visibility-list"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="setAllActualColumns(true)">
                    <i class="fas fa-eye"></i> 모두 표시
                </button>
                <button class="btn btn-secondary" type="button" onclick="setAllActualColumns(false)">
                    <i class="fas fa-eye-slash"></i> 모두 숨김
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closeActualColumnsModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         실적 단건 입력 모달
         =================================== -->
    <div id="actualLineEditModal" class="modal">
        <div class="modal-content modal-large actual-line-edit-modal">
            <div class="modal-header">
                <h2><i class="fas fa-pen-to-square"></i> 프로젝트 실적 입력</h2>
                <button class="modal-close" type="button" onclick="closeActualLineEditModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="actual-line-meta-grid">
                    <div class="actual-meta-item">
                        <label>파이프라인ID</label>
                        <input type="text" id="actualEditPipelineId" class="form-input" readonly>
                    </div>
                    <div class="actual-meta-item">
                        <label>프로젝트명</label>
                        <input type="text" id="actualEditProjectName" class="form-input" readonly>
                    </div>
                    <div class="actual-meta-item">
                        <label>고객사</label>
                        <input type="text" id="actualEditCustomerName" class="form-input" readonly>
                    </div>
                    <div class="actual-meta-item">
                        <label>담당조직</label>
                        <input type="text" id="actualEditOrgName" class="form-input" readonly>
                    </div>
                    <div class="actual-meta-item">
                        <label>담당자</label>
                        <input type="text" id="actualEditManagerName" class="form-input" readonly>
                    </div>
                </div>
                <div class="actual-line-month-grid" id="actualLineMonthGrid"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" id="btnActualLineApply">
                    <i class="fas fa-check"></i> 반영
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closeActualLineEditModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         실적 엑셀 붙여넣기 모달
         =================================== -->
    <div id="actualPasteModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-paste"></i> 실적 등록 엑셀 붙여넣기</h2>
                <button class="modal-close" type="button" onclick="closeActualPasteModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>엑셀에서 복사한 내용을 붙여넣기</label>
                    <textarea id="actualPasteInput" class="form-textarea" rows="10" placeholder="헤더 포함 상태로 붙여넣기 해주세요.&#10;예: 파이프라인ID | 1월 수주 | 1월 이익 | ..."></textarea>
                    <small><i class="fas fa-circle-info"></i> 헤더 타이틀 기준으로 컬럼을 매칭합니다. (파이프라인ID, 1월 수주/이익)</small>
                </div>
                <div id="actualPastePreview" class="paste-preview"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-secondary" type="button" id="btnActualPastePreview">
                    <i class="fas fa-eye"></i> 미리보기
                </button>
                <button class="btn btn-primary" type="button" id="btnActualPasteApply">
                    <i class="fas fa-check"></i> 적용
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closeActualPasteModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         실적 대상 미리보기 모달
         =================================== -->
    <div id="actualTargetPreviewModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-list-check"></i> 실적 등록 대상 미리보기</h2>
                <button class="modal-close" type="button" onclick="closeActualTargetPreviewModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="actual-register-flow" style="margin-bottom: 0.75rem;">
                    <div class="actual-register-item">
                        <label><i class="fas fa-route"></i> 등록 방식</label>
                        <select id="actualTargetMode" class="form-select">
                            <option value="plan">영업계획 등록 프로젝트</option>
                            <option value="unplanned">영업계획 미등록 프로젝트</option>
                            <option value="project">프로젝트 직접 선택</option>
                            <option value="manual">수기 추가</option>
                        </select>
                    </div>
                    <div class="actual-register-item" id="actualPlanSelectWrap">
                        <label><i class="fas fa-list-check"></i> 기준 계획</label>
                        <select id="actualPlanSelect" class="form-select">
                            <option value="">자동(최신 계획)</option>
                        </select>
                    </div>
                    <div class="actual-register-item">
                        <label><i class="fas fa-layer-group"></i> 로드 방식</label>
                        <select id="actualMergeMode" class="form-select">
                            <option value="append">기존 유지 + 신규 추가</option>
                            <option value="replace">현재 화면 행 교체</option>
                        </select>
                    </div>
                    <div class="actual-register-actions">
                        <button class="btn btn-primary" type="button" id="btnActualTargetSearch">
                            <i class="fas fa-search"></i> 조회
                        </button>
                    </div>
                </div>
                <div class="actual-preview-toolbar">
                    <input type="text" id="actualTargetPreviewSearch" class="form-input" placeholder="파이프라인ID/프로젝트명/고객사 검색">
                    <button class="btn btn-outline-secondary btn-sm" type="button" id="btnActualPreviewSearchClear">
                        <i class="fas fa-eraser"></i> 검색 초기화
                    </button>
                </div>
                <div class="helper-text" style="margin-bottom: 0.5rem;" id="actualTargetPreviewSummary">
                    요약 정보가 여기에 표시됩니다.
                </div>
                <div class="helper-text" style="margin-bottom: 0.75rem;">
                    대상 건수: <strong id="actualTargetPreviewCount">0</strong>건 (행 선택 후 반영하거나, 선택이 없으면 전체 반영)
                </div>
                <div id="actualTargetPreviewTable"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" id="btnActualPreviewApply">
                    <i class="fas fa-check"></i> 선택 반영
                </button>
                <button class="btn btn-outline-secondary" type="button" id="btnActualPreviewClose">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         게시판 - 목록 페이지
         =================================== -->
    <div id="page-notices-list" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-bullhorn"></i>
                        게시판
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" id="btnNoticeNew" type="button">
                            <i class="fas fa-plus-circle"></i> 새 글
                        </button>
                        <button class="btn btn-secondary" id="btnNoticeOpen" type="button">
                            <i class="fas fa-folder-open"></i> 상세보기
                        </button>
                        <button class="btn btn-outline-secondary" id="btnNoticeExportExcel" type="button">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                        <button class="btn btn-outline-secondary" id="btnNoticeExportPdf" type="button">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button class="btn btn-info" id="btnNoticeRefresh" type="button">
                            <i class="fas fa-sync-alt"></i> 새로고침
                        </button>
                    </div>
                </div>
                <div class="helper-text">
                    공지사항/업무 안내를 확인하고 공유할 수 있습니다.
                </div>
            </div>

            <div class="filter-panel notice-filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-search"></i> 검색필드</label>
                        <select id="noticeSearchField" class="form-select">
                            <option value="title">제목</option>
                            <option value="content">내용</option>
                            <option value="author_id">작성자 ID</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-keyboard"></i> 검색어</label>
                        <input type="text" id="noticeSearchText" class="form-input" placeholder="검색어를 입력하세요">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-tag"></i> 카테고리</label>
                        <select id="noticeCategory" class="form-select">
                            <option value="">전체</option>
                            <option value="SYSTEM">SYSTEM</option>
                            <option value="GENERAL">GENERAL</option>
                            <option value="URGENT">URGENT</option>
                        </select>
                    </div>
                    <div class="filter-group filter-group-small">
                        <label>게시중</label>
                        <select id="noticeActiveOnly" class="form-select">
                            <option value="">전체</option>
                            <option value="Y">게시중</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 0 0 auto;">
                        <label>&nbsp;</label>
                        <button class="btn btn-secondary" id="btnNoticeSearch" type="button">
                            <i class="fas fa-search"></i> 검색
                        </button>
                    </div>
                </div>
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-user"></i> 작성자</label>
                        <input type="text" id="noticeAuthorFilter" class="form-input" placeholder="작성자명/ID">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-calendar"></i> 작성일(시작)</label>
                        <input type="date" id="noticeDateFrom" class="form-input">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-calendar-check"></i> 작성일(종료)</label>
                        <input type="date" id="noticeDateTo" class="form-input">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-flag"></i> 상태</label>
                        <select id="noticeStatusFilter" class="form-select">
                            <option value="">전체</option>
                            <option value="NORMAL">일반</option>
                            <option value="IN_PROGRESS">진행 중</option>
                            <option value="DONE">완료</option>
                            <option value="HOLD">보류</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-paperclip"></i> 첨부파일</label>
                        <select id="noticeHasFilesFilter" class="form-select">
                            <option value="">전체</option>
                            <option value="Y">있음</option>
                            <option value="N">없음</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 1.2;">
                        <label><i class="fas fa-hashtag"></i> 해시태그</label>
                        <input type="text" id="noticeTagsFilter" class="form-input" placeholder="#견적 #오류수정">
                    </div>
                </div>
            </div>

            <div class="table-panel">
                <div id="noticesTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         게시판 - 상세 페이지
         =================================== -->
    <div id="page-notice-detail" class="page-content">
        <main class="app-main">
            <div class="notice-detail-container">
                <div class="form-header">
                    <div class="form-title">
                        <i class="fas fa-file-alt"></i>
                        <h2 id="noticeDetailTitle">게시판 상세</h2>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-primary" id="btnNoticeSave" type="button">
                            <i class="fas fa-save"></i> 저장
                        </button>
                        <button class="btn btn-danger" id="btnNoticeDelete" type="button">
                            <i class="fas fa-trash"></i> 삭제
                        </button>
                        <button class="btn btn-outline-secondary" id="btnNoticeDetailExportExcel" type="button">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                        <button class="btn btn-outline-secondary" id="btnNoticeDetailExportPdf" type="button">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button class="btn btn-secondary" id="btnNoticeBack" type="button">
                            <i class="fas fa-list"></i> 목록
                        </button>
                    </div>
                </div>

                <div class="notice-meta-grid">
                    <div class="form-group notice-field-title">
                        <label>제목</label>
                        <input type="text" id="noticeTitleInput" class="form-input" placeholder="제목을 입력하세요">
                    </div>
                    <div class="form-group notice-field-category">
                        <label>카테고리</label>
                        <select id="noticeCategorySelect" class="form-select">
                            <option value="GENERAL">GENERAL</option>
                            <option value="SYSTEM">SYSTEM</option>
                            <option value="URGENT">URGENT</option>
                        </select>
                    </div>
                    <div class="form-group notice-field-fixed">
                        <label>고정</label>
                        <select id="noticeFixedSelect" class="form-select">
                            <option value="N">N</option>
                            <option value="Y">Y</option>
                        </select>
                    </div>
                    <div class="form-group notice-field-status">
                        <label>상태</label>
                        <select id="noticeStatusSelect" class="form-select">
                            <option value="NORMAL">일반</option>
                            <option value="IN_PROGRESS">진행 중</option>
                            <option value="DONE">완료</option>
                            <option value="HOLD">보류</option>
                        </select>
                    </div>
                    <div class="form-group notice-field-tags">
                        <label>해시태그</label>
                        <input type="text" id="noticeHashtagsInput" class="form-input" placeholder="#견적 #오류수정 #긴급">
                    </div>
                    <div class="form-group notice-field-start">
                        <label>게시 시작</label>
                        <input type="date" id="noticeStartDate" class="form-input">
                    </div>
                    <div class="form-group notice-field-end">
                        <label>게시 종료</label>
                        <input type="date" id="noticeEndDate" class="form-input">
                    </div>
                    <div class="form-group notice-field-author">
                        <label>작성자</label>
                        <input type="text" id="noticeAuthor" class="form-input" disabled>
                    </div>
                    <div class="form-group notice-field-view">
                        <label>조회수</label>
                        <input type="text" id="noticeViewCount" class="form-input" disabled>
                    </div>
                    <div class="form-group notice-field-read">
                        <label>읽음 수</label>
                        <input type="text" id="noticeReadCount" class="form-input" disabled>
                    </div>
                    <div class="form-group notice-field-created">
                        <label>작성일</label>
                        <input type="text" id="noticeCreatedAt" class="form-input" disabled>
                    </div>
                </div>

                <div class="notice-reactions">
                    <button class="btn btn-outline-secondary btn-sm notice-reaction" id="btnNoticeLike" type="button" data-reaction="LIKE">
                        👍 좋아요 <span id="noticeLikeCount">0</span>
                    </button>
                    <button class="btn btn-outline-secondary btn-sm notice-reaction" id="btnNoticeCheck" type="button" data-reaction="CHECK">
                        ✅ 확인 <span id="noticeCheckCount">0</span>
                    </button>
                </div>

                <div class="notice-readers">
                    <div class="notice-readers-header">
                        <span>읽음 사용자</span>
                        <button class="btn btn-outline-secondary btn-sm" id="btnNoticeReadersToggle" type="button">보기</button>
                    </div>
                    <div id="noticeReadersPanel" class="notice-readers-panel" style="display: none;">
                        <div id="noticeReadersList" class="notice-readers-list"></div>
                    </div>
                </div>

                <div class="notice-attachments-panel">
                    <div class="notice-attachments-header">
                        <span>첨부 파일</span>
                        <div class="notice-attachments-actions">
                            <button class="btn btn-secondary btn-sm" id="btnNoticeFileUpload" type="button">
                                <i class="fas fa-paperclip"></i> 업로드
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" id="btnNoticeFileDownloadSelected" type="button">
                                <i class="fas fa-download"></i> 선택 다운로드
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" id="btnNoticeFileDownloadAll" type="button">
                                <i class="fas fa-file-archive"></i> 전체 다운로드
                            </button>
                        </div>
                    </div>
                    <label class="notice-attachments-selectall">
                        <input type="checkbox" id="noticeFilesSelectAll"> 전체 선택
                    </label>
                    <div class="notice-upload-status" id="noticeUploadStatus" style="display: none;">
                        <span class="notice-upload-spinner"></span>
                        <span class="notice-upload-text" id="noticeUploadText"></span>
                    </div>
                    <div class="notice-upload-progress" id="noticeUploadProgress" style="display: none;">
                        <div class="notice-upload-progress-bar" id="noticeUploadProgressBar"></div>
                    </div>
                    <input type="file" id="noticeFileInput" multiple style="display: none;">
                    <div id="noticeAttachmentsList" class="notice-attachments-list"></div>
                </div>

                <div class="notice-editor-panel">
                    <label class="notice-editor-label">내용</label>
                    <div id="noticeEditor" class="notice-editor"></div>
                    <textarea id="noticeContentFallback" class="notice-editor-fallback" placeholder="내용을 입력하세요"></textarea>
                </div>

                <div class="notice-replies-panel">
                    <div class="notice-replies-header">
                        <span>답글</span>
                        <span id="noticeReplyCount">0건</span>
                    </div>
                    <div class="notice-reply-editor">
                        <div class="notice-reply-target" id="noticeReplyTarget" style="display: none;">
                            <span id="noticeReplyTargetLabel"></span>
                            <button class="btn btn-outline-secondary btn-sm" id="btnNoticeReplyCancel" type="button">
                                <i class="fas fa-times"></i> 답글 취소
                            </button>
                        </div>
                        <div id="noticeReplyEditor"></div>
                        <textarea id="noticeReplyFallback" class="notice-reply-fallback" placeholder="답글을 입력하세요"></textarea>
                        <div class="notice-reply-files">
                            <div class="notice-attachments-header">
                                <span>첨부 파일</span>
                                <div class="notice-attachments-actions">
                                    <button class="btn btn-secondary btn-sm" id="btnNoticeReplyFileUpload" type="button">
                                        <i class="fas fa-paperclip"></i> 업로드
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm" id="btnNoticeReplyFileDownloadSelected" type="button">
                                        <i class="fas fa-download"></i> 선택 다운로드
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm" id="btnNoticeReplyFileDownloadAll" type="button">
                                        <i class="fas fa-file-archive"></i> 전체 다운로드
                                    </button>
                                </div>
                            </div>
                            <label class="notice-attachments-selectall">
                                <input type="checkbox" id="noticeReplyFilesSelectAll"> 전체 선택
                            </label>
                            <div class="notice-upload-status" id="noticeReplyUploadStatus" style="display: none;">
                                <span class="notice-upload-spinner"></span>
                                <span class="notice-upload-text" id="noticeReplyUploadText"></span>
                            </div>
                            <div class="notice-upload-progress" id="noticeReplyUploadProgress" style="display: none;">
                                <div class="notice-upload-progress-bar" id="noticeReplyUploadProgressBar"></div>
                            </div>
                            <input type="file" id="noticeReplyFileInput" multiple style="display: none;">
                            <div id="noticeReplyAttachmentsList" class="notice-attachments-list"></div>
                        </div>
                        <div class="notice-reply-actions">
                            <button class="btn btn-primary" id="btnNoticeReplySave" type="button">
                                <i class="fas fa-paper-plane"></i> 답글 등록
                            </button>
                        </div>
                    </div>
                    <div id="noticeRepliesList" class="notice-replies-list"></div>
                    <div class="notice-replies-pagination">
                        <button class="btn btn-outline-secondary btn-sm" id="btnNoticeRepliesMore" type="button">
                            더보기
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ===================================
         사용자 관리 - 목록 페이지
         =================================== -->
    <div id="page-users" class="page-content">
        <main class="app-main">
            <!-- 통계 패널 -->
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatTotal">0</div>
                        <div class="stat-label">전체 사용자</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatActive">0</div>
                        <div class="stat-label">활성 사용자</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-user-slash"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatInactive">0</div>
                        <div class="stat-label">비활성 사용자</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-filter"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatFiltered">0</div>
                        <div class="stat-label">필터링 결과</div>
                    </div>
                </div>
            </div>

            <!-- 필터 패널 -->
            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-search"></i> 검색 구분</label>
                        <select id="userSearchField" class="form-select">
                            <option value="">전체</option>
                            <option value="login_id">로그인 ID</option>
                            <option value="user_name">사용자명</option>
                            <option value="email">이메일</option>
                            <option value="phone">연락처</option>
                            <option value="org_name">조직</option>
                        </select>
                    </div>

                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-keyboard"></i> 검색어</label>
                        <input
                            type="text"
                            id="userSearchText"
                            class="form-input"
                            placeholder="검색어를 입력하세요"
                        />
                    </div>

                    <div class="filter-group" style="flex: 0 0 auto;">
                        <label>&nbsp;</label>
                        <button class="btn btn-secondary" onclick="applyUserFilters()">
                            <i class="fas fa-search"></i> 검색
                        </button>
                    </div>

                    <div class="filter-group">
                        <label><i class="fas fa-toggle-on"></i> 계정 상태</label>
                        <select id="userStatusFilter" class="form-select">
                            <option value="ALL">전체</option>
                            <option value="ACTIVE">ACTIVE</option>
                            <option value="INACTIVE">INACTIVE</option>
                            <option value="LOCK">LOCK</option>
                        </select>
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnNewUser" type="button" title="새 사용자 추가" onclick="openUserForm('new')">
                        <i class="fas fa-plus-circle"></i> 신규
                    </button>
                    <button class="btn btn-info" onclick="resetUserFilters()">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                    <button class="btn btn-success" onclick="exportUsersToExcel()">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                    <button class="btn btn-warning" onclick="bulkResetPasswords()">
                        <i class="fas fa-key"></i> password 일괄 Reset
                    </button>
                </div>
            </div>

            <!-- 테이블 패널 -->
            <div class="table-panel">
                <div id="usersTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         사용자 관리 - 등록/수정 페이지
         =================================== -->
    <div id="page-users-form" class="page-content">
        <div class="form-container user-form-container">
            <div class="form-header">
                <div class="form-title">
                    <i class="fas fa-users-cog"></i>
                    <h2 id="userFormTitleText">신규 사용자 등록</h2>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" type="button" onclick="saveUserForm()">
                        <i class="fas fa-save"></i> 저장
                    </button>
                    <button class="btn btn-outline-secondary" type="button" onclick="navigateToUserList()">
                        <i class="fas fa-list"></i> 목록
                    </button>
                    <button class="btn btn-danger" type="button" id="btnDeleteUser" onclick="deleteUser()" style="display: none;">
                        <i class="fas fa-trash"></i> 삭제
                    </button>
                    <button class="btn btn-close-icon" type="button" onclick="navigateToUserList()" title="닫기">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <form id="userForm" class="tab-content user-form" onsubmit="event.preventDefault(); saveUserForm();">
                <input type="hidden" id="userNo">
                <input type="hidden" id="userMode" value="new">

                <!-- 기본 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-id-card"></i>
                        기본 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="userNoView">사용자번호</label>
                            <input type="text" id="userNoView" class="form-input" readonly placeholder="자동 채번">
                        </div>

                        <div class="form-group">
                            <label for="loginId" class="required">로그인 ID</label>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <input type="text" id="loginId" class="form-input" required placeholder="login_id 입력">
                                <button type="button" class="btn btn-outline-secondary" id="btnEnableLoginIdEdit" onclick="enableLoginIdEdit()" style="white-space: nowrap; display: none;">
                                    ID 수정
                                </button>
                            </div>
                            <span class="form-hint">신규 등록 후 일반적으로 수정 불가</span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="userName" class="required">사용자명</label>
                            <input type="text" id="userName" class="form-input" required placeholder="사용자명을 입력하세요">
                        </div>

                        <div class="form-group">
                            <label for="role" class="required">권한</label>
                            <select id="role" class="form-select" required>
                                <option value="">선택하세요</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="isSalesRep">영업담당 여부</label>
                            <div class="form-switch-group">
                                <label class="form-switch">
                                    <input type="checkbox" id="isSalesRep" class="form-switch-input">
                                    <span class="form-switch-slider"></span>
                                </label>
                                <span class="form-switch-label">담당</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 연락처/소속 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-building"></i>
                        소속/연락처
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">이메일</label>
                            <input type="email" id="email" class="form-input" placeholder="example@company.com">
                        </div>

                        <div class="form-group">
                            <label for="phone">연락처</label>
                            <input type="text" id="phone" class="form-input" placeholder="010-0000-0000">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="orgId">조직</label>
                            <select id="orgId" class="form-select">
                                <option value="">선택하세요</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 계정 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-user-shield"></i>
                        계정 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate" class="required">시작일</label>
                            <input type="date" id="startDate" class="form-input" required>
                        </div>

                        <div class="form-group">
                            <label for="endDate" class="required">종료일</label>
                            <input type="date" id="endDate" class="form-input" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="status" class="required">상태</label>
                            <select id="status" class="form-select" required>
                                <option value="ACTIVE">ACTIVE</option>
                                <option value="INACTIVE">INACTIVE</option>
                                <option value="LOCK">LOCK</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 시스템 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-info-circle"></i>
                        시스템 정보 (조회용)
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="createdAt">생성일시</label>
                            <input type="text" id="createdAt" class="form-input" readonly>
                        </div>

                        <div class="form-group">
                            <label for="updatedAt">수정일시</label>
                            <input type="text" id="updatedAt" class="form-input" readonly>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="createdBy">생성자</label>
                            <input type="text" id="createdBy" class="form-input" readonly>
                        </div>

                        <div class="form-group">
                            <label for="updatedBy">수정자</label>
                            <input type="text" id="updatedBy" class="form-input" readonly>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary btn-lg" onclick="navigateToUserList()">
                        <i class="fas fa-list"></i>
                        목록으로
                    </button>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save"></i>
                        저장
                    </button>
                    <button type="button" class="btn btn-danger btn-lg" id="btnDeleteUserBottom" onclick="deleteUser()" style="display: none;">
                        <i class="fas fa-trash"></i>
                        삭제
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ===================================
         접속 이력 페이지
         =================================== -->
    <div id="page-login-history" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-clock"></i>
                        접속 이력
                    </div>
                </div>
                <div class="helper-text">
                    로그인/로그아웃 기록을 조회합니다. 보안 감사용으로 사용되며, 필터 조건을 적용해 검색할 수 있습니다.
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-user"></i> 로그인 ID</label>
                        <input type="text" id="loginHistoryLoginId" class="form-input" placeholder="로그인 ID">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-flag"></i> 구분</label>
                        <select id="loginHistoryActionType" class="form-select">
                            <option value="">전체</option>
                            <option value="LOGIN">LOGIN</option>
                            <option value="LOGOUT">LOGOUT</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-calendar"></i> 시작일</label>
                        <input type="date" id="loginHistoryFrom" class="form-input">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-calendar"></i> 종료일</label>
                        <input type="date" id="loginHistoryTo" class="form-input">
                    </div>
                    <div class="filter-group" style="flex: 0 0 auto;">
                        <label>&nbsp;</label>
                        <button class="btn btn-secondary" id="btnLoginHistorySearch">
                            <i class="fas fa-search"></i> 검색
                        </button>
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-info" id="btnLoginHistoryReset">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                    <button class="btn btn-success" id="btnLoginHistoryExport">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                </div>
            </div>

            <div class="helper-text" id="loginHistorySummary">
                조회 결과가 여기에 표시됩니다.
            </div>

            <div class="table-panel">
                <div id="loginHistoryTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         권한 관리 페이지
         =================================== -->
    <div id="page-permissions" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-shield-halved"></i>
                        권한 관리
                    </div>
                </div>
                <div class="helper-text">
                    화면별 C/R/U/D 권한을 역할 또는 사용자 단위로 설정합니다. 권한 테이블이 비어있으면 기본 허용 정책이 적용됩니다.
                </div>
            </div>

            <div id="permissionsTabs" class="detail-tabs">
                <button class="detail-tab active" data-tab="forms">화면 목록</button>
                <button class="detail-tab" data-tab="roles">역할 권한</button>
                <button class="detail-tab" data-tab="users">사용자 권한</button>
            </div>

            <div id="permissionsPanes">
                <div id="permissions-pane-forms" class="detail-pane active">
                    <section class="common-code-panel">
                        <div class="panel-header">
                            <h3><i class="fas fa-window-restore"></i> 화면 목록</h3>
                            <div class="panel-actions">
                                <button class="btn btn-primary" id="btnPermFormsNew" type="button">
                                    <i class="fas fa-plus-circle"></i> 신규
                                </button>
                                <button class="btn btn-danger" id="btnPermFormsDelete" type="button">
                                    <i class="fas fa-trash"></i> 삭제
                                </button>
                                <button class="btn btn-success" id="btnPermFormsSave" type="button">
                                    <i class="fas fa-save"></i> 저장
                                </button>
                                <button class="btn btn-info" id="btnPermFormsRefresh" type="button">
                                    <i class="fas fa-sync-alt"></i> 새로고침
                                </button>
                                <button class="btn btn-success" id="btnPermFormsExcel" type="button">
                                    <i class="fas fa-file-excel"></i> 엑셀
                                </button>
                            </div>
                        </div>
                        <div class="table-panel">
                            <div id="permissionsFormsTable"></div>
                        </div>
                    </section>
                </div>

                <div id="permissions-pane-roles" class="detail-pane">
                    <div class="permissions-grid">
                        <div class="permissions-left">
                            <section class="common-code-panel permissions-subpanel">
                                <div class="panel-header">
                                    <h3><i class="fas fa-users-cog"></i> 역할 목록</h3>
                                    <div class="panel-actions">
                                        <button class="btn btn-info" id="btnPermRolesListRefresh" type="button">
                                            <i class="fas fa-sync-alt"></i> 새로고침
                                        </button>
                                    </div>
                                </div>
                                <div class="table-panel">
                                    <div id="permissionsRolesListTable"></div>
                                </div>
                            </section>

                            <section class="common-code-panel permissions-subpanel">
                                <div class="panel-header">
                                    <div>
                                        <h3><i class="fas fa-window-restore"></i> 화면 목록</h3>
                                        <div class="panel-subtitle">선택한 역할에 권한을 부여할 화면을 선택하세요.</div>
                                    </div>
                                    <div class="panel-actions">
                                        <button class="btn btn-secondary" id="btnPermRoleViewOnly" type="button">
                                            <i class="fas fa-eye"></i> 조회만 부여
                                        </button>
                                        <button class="btn btn-primary" id="btnPermRoleGrantAll" type="button">
                                            <i class="fas fa-shield-check"></i> 전체 권한 부여
                                        </button>
                                    </div>
                                </div>
                                <div class="table-panel">
                                    <div id="permissionsRoleFormsTable"></div>
                                </div>
                            </section>
                        </div>

                        <div class="permissions-right">
                            <section class="common-code-panel">
                                <div class="panel-header">
                                    <div>
                                        <h3><i class="fas fa-user-shield"></i> 역할 권한</h3>
                                        <div class="panel-subtitle">선택된 역할: <span id="permActiveRoleLabel">-</span></div>
                                    </div>
                                    <div class="panel-actions">
                                        <button class="btn btn-primary" id="btnPermRolesNew" type="button">
                                            <i class="fas fa-plus-circle"></i> 신규
                                        </button>
                                        <button class="btn btn-danger" id="btnPermRolesDelete" type="button">
                                            <i class="fas fa-trash"></i> 삭제
                                        </button>
                                        <button class="btn btn-success" id="btnPermRolesSave" type="button">
                                            <i class="fas fa-save"></i> 저장
                                        </button>
                                        <button class="btn btn-info" id="btnPermRolesRefresh" type="button">
                                            <i class="fas fa-sync-alt"></i> 새로고침
                                        </button>
                                        <button class="btn btn-success" id="btnPermRolesExcel" type="button">
                                            <i class="fas fa-file-excel"></i> 엑셀
                                        </button>
                                    </div>
                                </div>
                                <div class="table-panel">
                                    <div id="permissionsRolesTable"></div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>

                <div id="permissions-pane-users" class="detail-pane">
                    <div class="permissions-grid">
                        <div class="permissions-left">
                            <section class="common-code-panel permissions-subpanel">
                                <div class="panel-header">
                                    <h3><i class="fas fa-users"></i> 사용자 목록</h3>
                                    <div class="panel-actions">
                                        <button class="btn btn-info" id="btnPermUsersListRefresh" type="button">
                                            <i class="fas fa-sync-alt"></i> 새로고침
                                        </button>
                                    </div>
                                </div>
                                <div class="table-panel">
                                    <div id="permissionsUsersListTable"></div>
                                </div>
                            </section>

                            <section class="common-code-panel permissions-subpanel">
                                <div class="panel-header">
                                    <div>
                                        <h3><i class="fas fa-window-restore"></i> 화면 목록</h3>
                                        <div class="panel-subtitle">선택한 사용자에게 권한을 부여할 화면을 선택하세요.</div>
                                    </div>
                                    <div class="panel-actions">
                                        <button class="btn btn-secondary" id="btnPermUserViewOnly" type="button">
                                            <i class="fas fa-eye"></i> 조회만 부여
                                        </button>
                                        <button class="btn btn-primary" id="btnPermUserGrantAll" type="button">
                                            <i class="fas fa-shield-check"></i> 전체 권한 부여
                                        </button>
                                    </div>
                                </div>
                                <div class="table-panel">
                                    <div id="permissionsUserFormsTable"></div>
                                </div>
                            </section>
                        </div>

                        <div class="permissions-right">
                            <section class="common-code-panel">
                                <div class="panel-header">
                                    <div>
                                        <h3><i class="fas fa-user-lock"></i> 사용자 권한</h3>
                                        <div class="panel-subtitle">선택된 사용자: <span id="permActiveUserLabel">-</span></div>
                                    </div>
                                    <div class="panel-actions">
                                        <button class="btn btn-primary" id="btnPermUsersNew" type="button">
                                            <i class="fas fa-plus-circle"></i> 신규
                                        </button>
                                        <button class="btn btn-danger" id="btnPermUsersDelete" type="button">
                                            <i class="fas fa-trash"></i> 삭제
                                        </button>
                                        <button class="btn btn-success" id="btnPermUsersSave" type="button">
                                            <i class="fas fa-save"></i> 저장
                                        </button>
                                        <button class="btn btn-info" id="btnPermUsersRefresh" type="button">
                                            <i class="fas fa-sync-alt"></i> 새로고침
                                        </button>
                                        <button class="btn btn-success" id="btnPermUsersExcel" type="button">
                                            <i class="fas fa-file-excel"></i> 엑셀
                                        </button>
                                    </div>
                                </div>
                                <div class="table-panel">
                                    <div id="permissionsUsersTable"></div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ===================================
         공통코드 관리 페이지
         =================================== -->
    <div id="page-common-codes" class="page-content">
        <main class="app-main">
            <div class="common-code-layout">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-sitemap"></i> 대분류코드</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnGroupNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnGroupDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnGroupSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnGroupRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnGroupExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnGroupUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="codeGroupTable"></div>
                    </div>
                    <input type="file" id="groupExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>

                <section class="common-code-panel">
                    <div class="panel-header">
                        <div>
                            <h3><i class="fas fa-list"></i> 상세코드</h3>
                            <div class="panel-subtitle" id="selectedGroupLabel">대분류를 선택하세요</div>
                        </div>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnDetailNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnDetailDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnDetailSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnDetailRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnDetailExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnDetailUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="codeDetailTable"></div>
                    </div>
                    <input type="file" id="detailExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         공지 템플릿 관리 페이지
         =================================== -->
    <div id="page-notice-templates" class="page-content">
        <main class="app-main">
            <div class="notice-template-layout">
                <section class="notice-template-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-file-lines"></i> 공지 템플릿 목록</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnNoticeTemplateNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnNoticeTemplateDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnNoticeTemplateSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnNoticeTemplateRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="noticeTemplatesTable"></div>
                    </div>
                </section>

                <section class="notice-template-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-pen-to-square"></i> 템플릿 편집</h3>
                    </div>
                    <div class="notice-template-form">
                        <div class="form-group">
                            <label for="noticeTemplateTitle">템플릿 제목</label>
                            <input type="text" id="noticeTemplateTitle" class="form-input" placeholder="템플릿 제목">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="noticeTemplateCategory">분류</label>
                                <input type="text" id="noticeTemplateCategory" class="form-input" placeholder="예: 시스템, 공지">
                            </div>
                            <div class="form-group">
                                <label for="noticeTemplateSort">정렬</label>
                                <input type="number" id="noticeTemplateSort" class="form-input" value="0" min="0">
                            </div>
                            <div class="form-group">
                                <label for="noticeTemplateShared">공유</label>
                                <select id="noticeTemplateShared" class="form-select">
                                    <option value="N">비공유</option>
                                    <option value="Y">공유</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="noticeTemplateUse">사용 여부</label>
                                <select id="noticeTemplateUse" class="form-select">
                                    <option value="Y">사용</option>
                                    <option value="N">미사용</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="noticeTemplateContent">내용</label>
                            <div id="noticeTemplateEditor" class="notice-template-editor"></div>
                            <textarea id="noticeTemplateContent" class="form-textarea" placeholder="템플릿 내용을 입력하세요"></textarea>
                            <div class="form-help">게시판 상세 에디터에서 선택 시 본문에 삽입됩니다.</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         분야코드 관리 페이지
         =================================== -->
    <div id="page-industry-fields" class="page-content">
        <main class="app-main">
            <div class="common-code-layout single">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-tags"></i> 분야코드</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnIndustryNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnIndustryDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnIndustrySave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnIndustryRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnIndustryExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnIndustryUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="industryFieldsTable"></div>
                    </div>
                    <input type="file" id="industryExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         서비스코드 관리 페이지
         =================================== -->
    <div id="page-service-codes" class="page-content">
        <main class="app-main">
            <div class="common-code-layout single">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-layer-group"></i> 서비스코드</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnServiceNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnServiceDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnServiceSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnServiceRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnServiceExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnServiceUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="serviceCodesTable"></div>
                    </div>
                    <input type="file" id="serviceExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         조직 관리 페이지
         =================================== -->
    <div id="page-org-units" class="page-content">
        <main class="app-main">
            <div class="common-code-layout single">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-sitemap"></i> 조직 관리</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnOrgNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnOrgDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnOrgSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnOrgRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnOrgExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnOrgUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="orgUnitsTable"></div>
                    </div>
                    <input type="file" id="orgExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         회사 관리 페이지
         =================================== -->
    <div id="page-companies" class="page-content">
        <main class="app-main">
            <div class="common-code-layout single">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-building"></i> 회사 관리</h3>
                        <div class="panel-actions">
                            <button class="btn btn-info" id="btnCompanyRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-warning" id="btnCompanyDeactivate" type="button">
                                <i class="fas fa-ban"></i> 사용중지
                            </button>
                            <button class="btn btn-success" id="btnCompanyActivate" type="button">
                                <i class="fas fa-check"></i> 사용
                            </button>
                        </div>
                    </div>

                    <div class="filter-panel" style="margin-bottom: 1rem;">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>회사 코드<span class="required">*</span></label>
                                <input type="text" id="companyCdInput" class="form-input" placeholder="예: COMP001">
                            </div>
                            <div class="filter-group">
                                <label>회사명<span class="required">*</span></label>
                                <input type="text" id="companyNameInput" class="form-input" placeholder="회사명을 입력하세요">
                            </div>
                            <div class="filter-group">
                                <label>별칭</label>
                                <input type="text" id="companyAliasInput" class="form-input" placeholder="선택 입력">
                            </div>
                            <div class="filter-group filter-group-small">
                                <label>사용</label>
                                <select id="companyUseSelect" class="form-select">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                </select>
                            </div>
                            <div class="filter-group company-copy-group">
                                <div class="company-copy-header">
                                    <span class="company-copy-title">공통코드 복사</span>
                                    <label class="company-copy-checkbox">
                                        <input type="checkbox" id="companyCopyCodes">
                                        <span>현재 회사 기준 복사</span>
                                    </label>
                                </div>
                                <select id="companyCopyFromSelect" class="form-select">
                                    <option value="">복사 원본 선택</option>
                                </select>
                            </div>
                        </div>
                        <div class="filter-actions">
                            <button class="btn btn-primary" id="btnCompanyCreate" type="button">
                                <i class="fas fa-plus-circle"></i> 등록
                            </button>
                            <button class="btn btn-secondary" id="btnCompanyReset" type="button">
                                <i class="fas fa-rotate-left"></i> 초기화
                            </button>
                        </div>
                    </div>

                    <div class="company-grid-layout">
                        <div class="table-panel">
                            <div id="companiesTable"></div>
                        </div>
                        <div class="table-panel company-common-panel">
                            <div class="company-common-header">
                                <h4><i class="fas fa-layer-group"></i> 복사대상 공통테이블</h4>
                                <div class="panel-subtitle">회사 생성 시 선택된 테이블을 복사합니다.</div>
                            </div>
                            <div id="companyCommonTablesTable"></div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         데이터 관리 페이지
         =================================== -->
    <div id="page-data-management" class="page-content">
        <main class="app-main">
            <div class="data-management-layout">
                <div class="filter-panel data-management-controls" id="dataManagementControls">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>Source 회사</label>
                            <select id="sourceCompanySelect" class="form-select"></select>
                        </div>
                        <div class="filter-group">
                            <label>Target 회사</label>
                            <select id="targetCompanySelect" class="form-select"></select>
                        </div>
                        <div class="filter-group data-management-exclude">
                            <label>제외 테이블</label>
                            <input type="text" id="excludeTablesInput" class="form-input" placeholder="예: login_history, tmp_table">
                            <div class="form-help">콤마(,)로 구분. 기본 제외: companies, tmp_invalid_project_manager_id, board_notices</div>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-info" id="btnDataRefresh" type="button">
                            <i class="fas fa-sync-alt"></i> 새로고침
                        </button>
                        <button class="btn btn-danger" id="btnDataCopy" type="button">
                            <i class="fas fa-copy"></i> 선택 테이블 복제
                        </button>
                    </div>
                </div>

                <div id="dataCopySummary" class="filter-panel data-management-summary" style="display:none;"></div>

                <section class="common-code-panel">
                    <div class="panel-header">
                        <div>
                            <h3><i class="fas fa-database"></i> Source 회사 테이블</h3>
                            <div class="panel-subtitle">복제할 테이블을 선택하세요 (참조 테이블은 자동 포함됨)</div>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="sourceTablesTable"></div>
                    </div>
                </section>

                <section class="common-code-panel">
                    <div class="panel-header">
                        <div>
                            <h3><i class="fas fa-database"></i> Target 회사 테이블</h3>
                            <div class="panel-subtitle">복제 대상 데이터 현황/상태</div>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="targetTablesTable"></div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         내정보 페이지
         =================================== -->
    <div id="page-my-info" class="page-content">
        <div class="form-container my-info-container">
            <div class="form-header">
                <div class="form-title">
                    <i class="fas fa-user-cog"></i>
                    <h2>내정보</h2>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" type="button" onclick="saveMyInfo()">
                        <i class="fas fa-save"></i> 저장
                    </button>
                    <button class="btn btn-outline-secondary" type="button" onclick="closeMyInfo()">
                        <i class="fas fa-times"></i> 닫기
                    </button>
                </div>
            </div>

            <form id="myInfoForm" class="tab-content" onsubmit="event.preventDefault(); saveMyInfo();">
                <!-- 기본 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-id-card"></i>
                        기본 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myLoginId">로그인 ID</label>
                            <input type="text" id="myLoginId" class="form-input" readonly>
                        </div>
                        <div class="form-group">
                            <label for="myUserName" class="required">사용자명</label>
                            <input type="text" id="myUserName" class="form-input" required placeholder="사용자명을 입력하세요">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myRole">권한</label>
                            <input type="text" id="myRole" class="form-input" readonly>
                        </div>
                        <div class="form-group">
                            <label for="myStatus">계정 상태</label>
                            <input type="text" id="myStatus" class="form-input" readonly>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="mySalesRep">영업담당</label>
                            <div class="form-switch-group">
                                <label class="form-switch">
                                    <input type="checkbox" id="mySalesRep" class="form-switch-input">
                                    <span class="form-switch-slider"></span>
                                </label>
                                <span class="form-switch-label">영업 담당 여부</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 소속 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-sitemap"></i>
                        소속 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myOrgName">조직</label>
                            <input type="text" id="myOrgName" class="form-input" placeholder="소속 조직" readonly>
                        </div>
                    </div>
                </div>

                <!-- 연락처 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-phone"></i>
                        연락처 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myEmail">이메일</label>
                            <input type="email" id="myEmail" class="form-input" placeholder="example@company.com">
                        </div>
                        <div class="form-group">
                            <label for="myPhone">연락처</label>
                            <input type="tel" id="myPhone" class="form-input" placeholder="010-0000-0000">
                        </div>
                    </div>
                </div>

                <!-- 재직/권한 기간 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-calendar-alt"></i>
                        재직/권한 기간
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myStartDate">시작일</label>
                            <input type="date" id="myStartDate" class="form-input" readonly>
                        </div>
                        <div class="form-group">
                            <label for="myEndDate">종료일</label>
                            <input type="date" id="myEndDate" class="form-input" readonly>
                        </div>
                    </div>
                </div>
            </form>

            <!-- 비밀번호 변경 -->
            <div id="myPasswordSection" class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-lock"></i>
                    비밀번호 변경
                </h2>

                <form id="myPasswordForm" class="tab-content" onsubmit="event.preventDefault(); changeMyPassword();">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="myOldPassword" class="required">현재 비밀번호</label>
                            <input type="password" id="myOldPassword" class="form-input" required autocomplete="current-password">
                        </div>
                        <div class="form-group">
                            <label for="myNewPassword" class="required">새 비밀번호</label>
                            <input type="password" id="myNewPassword" class="form-input" required autocomplete="new-password">
                            <span class="form-hint">영문/숫자/특수문자 포함 8자 이상</span>
                        </div>
                        <div class="form-group">
                            <label for="myNewPasswordConfirm" class="required">새 비밀번호 확인</label>
                            <input type="password" id="myNewPasswordConfirm" class="form-input" required autocomplete="new-password">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group form-group-full">
                            <div class="password-rule-status" id="myPasswordRuleStatus">
                                비밀번호 규칙을 확인해주세요.
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-key"></i>
                            비밀번호 변경
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 초기 비밀번호 변경 안내 모달 -->
    <div id="initialPasswordModal" class="modal" style="display: none;">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-exclamation-circle"></i> 초기 비밀번호 변경</h2>
            </div>
            <div class="modal-body">
                <p>초기 PW로 PW 변경 이후 사용이 가능합니다.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" onclick="goToPasswordChange()">
                    PW변경 화면 이동
                </button>
            </div>
        </div>
    </div>

    <!-- 모달: 프로젝트 상세 정보 (읽기 전용) -->
    <div id="projectModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> 프로젝트 상세 정보</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modalBody" class="modal-body">
                <p>로딩 중...</p>
            </div>
        </div>
    </div>

    <!-- 모달: 진행상황 조회 선택 이력 -->
    <div id="projectHistoryModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-calendar-check"></i> 선택 이력</h2>
                <button class="modal-close" onclick="closeProjectHistoryModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="ph-modal-summary" id="projectHistoryModalSummary">-</div>
                <div class="ph-modal-actions">
                    <button class="btn btn-success" id="btnHistoryModalExport">
                        <i class="fas fa-file-excel"></i> 엑셀 다운로드
                    </button>
                </div>
                <div id="projectHistoryModalList" class="ph-modal-list"></div>
            </div>
        </div>
    </div>

    <!-- 로딩 오버레이 -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-circle-notch fa-spin"></i>
            <p>처리중...</p>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- 변경이력 수정 모달 (신규 추가) -->
    <!-- ============================================ -->
    <div id="historyEditModal" class="modal" style="display: none;">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-edit"></i>
                    변경이력 수정
                </h2>
                <button class="modal-close" onclick="closeHistoryEditModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- 수정 폼 -->
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <!-- 기준일 -->
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">
                            <i class="far fa-calendar-alt" style="color: #667eea; margin-right: 0.5rem;"></i>
                            기준일 <span class="required">*</span>
                        </label>
                        <input type="date" id="edit_history_date" class="form-input" required>
                    </div>
                    
                    <!-- 진행단계 -->
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">
                            <i class="fas fa-flag" style="color: #667eea; margin-right: 0.5rem;"></i>
                            진행단계 <span class="required">*</span>
                        </label>
                        <select id="edit_history_stage" class="form-select" required>
                            <option value="">진행단계 선택</option>
                            <!-- JavaScript에서 동적으로 채움 -->
                        </select>
                    </div>

                    <!-- 활동유형 -->
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">
                            <i class="fas fa-tags" style="color: #667eea; margin-right: 0.5rem;"></i>
                            활동유형
                        </label>
                        <select id="edit_history_activity" class="form-select">
                            <option value="">미지정</option>
                            <!-- JavaScript에서 동적으로 채움 -->
                        </select>
                    </div>
                    
                    <!-- 전략 내용 -->
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">
                            <i class="fas fa-file-alt" style="color: #667eea; margin-right: 0.5rem;"></i>
                            전략 내용
                        </label>
                        <textarea 
                            id="edit_history_content" 
                            class="form-textarea" 
                            placeholder="전략 내용을 입력하세요.
    여러 줄로 상세하게 작성할 수 있습니다.
    - 주요 활동 내역
    - 고객 피드백
    - 향후 계획 등"
                            style="
                                width: 100%; 
                                min-height: 120px;
                                max-height: 300px;
                                padding: 0.75rem; 
                                border: 1px solid #ddd; 
                                border-radius: 6px; 
                                font-family: inherit; 
                                font-size: 0.875rem; 
                                line-height: 1.5;
                                text-align: left;
                                resize: vertical;
                                transition: border-color 0.2s, box-shadow 0.2s;
                            "
                            oninput="autoResizeTextarea(this)"
                            onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)';"
                            onblur="this.style.borderColor='#ddd'; this.style.boxShadow='none';"
                        ></textarea>
                        <small style="display: block; margin-top: 0.5rem; color: #666; font-size: 0.75rem;">
                            <i class="fas fa-info-circle"></i> Enter 키로 줄바꿈하여 여러 줄을 입력할 수 있습니다.
                        </small>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="display: flex; gap: 0.75rem; justify-content: flex-end; padding: 1rem 1.5rem; background: #f8f9fa; border-top: 1px solid #e0e0e0;">
                <button type="button" class="btn btn-secondary" onclick="closeHistoryEditModal()">
                    <i class="fas fa-times"></i> 취소
                </button>
                <button type="button" class="btn btn-primary" onclick="saveHistoryEdit()">
                    <i class="fas fa-check"></i> 확인
                </button>
            </div>
        </div>
    </div>

    <div id="attributeCodeModal" class="modal" style="display: none;">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h3><i class="fas fa-tags"></i> 속성코드 추가</h3>
                <button class="modal-close" onclick="closeAttributeCodeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label><i class="fas fa-font"></i> 코드명<span class="required">*</span></label>
                    <input type="text" id="attr_name_input" class="form-input" placeholder="예: 기술유형">
                </div>
                <div class="form-group">
                    <button type="button" class="btn btn-outline-secondary" onclick="checkAttributeCodeNameDup()">
                        <i class="fas fa-search"></i> 중복여부 확인
                    </button>
                    <div class="helper-text" id="attr_name_dup_result" style="margin-top: 0.5rem;">
                        등록 전 속성명 중복 여부를 확인하세요.
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeAttributeCodeModal()">취소</button>
                <button type="button" class="btn btn-primary" onclick="saveAttributeCode()">등록</button>
            </div>
        </div>
    </div>

    <!-- 엑셀 리포트 출력 옵션 -->
    <div id="excelExportModal" class="modal">
        <div class="modal-content" style="max-width: 760px;">
            <div class="modal-header">
                <h3><i class="fas fa-file-excel"></i> 프로젝트 엑셀 리포트 출력</h3>
                <button class="modal-close" type="button" onclick="closeExcelExportModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="excelExportType">출력 유형</label>
                        <select id="excelExportType" class="form-select" onchange="onExcelExportTypeChange()">
                            <option value="filtered">필터 조건 전체 프로젝트 (기본+속성+이력)</option>
                            <option value="activity">주간/월간 활동내역 (기간 내 이력 존재 프로젝트)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="excelExportLayout">시트 구성</label>
                        <select id="excelExportLayout" class="form-select">
                            <option value="single_sheet">단일 시트(프로젝트 블록 반복)</option>
                            <option value="per_project">프로젝트별 시트</option>
                        </select>
                    </div>
                </div>

                <div id="excelExportPeriodRow" class="form-row" style="display: none;">
                    <div class="form-group">
                        <label for="excelExportFromDate">기간 From</label>
                        <input type="date" id="excelExportFromDate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="excelExportToDate">기간 To</label>
                        <input type="date" id="excelExportToDate" class="form-input">
                    </div>
                </div>

                <div class="helper-text" style="margin-top: 0.75rem;">
                    현재 프로젝트 목록의 필터 조건을 적용한 전체 프로젝트를 대상으로 출력합니다.
                </div>
                <div class="helper-text" id="excelExportFilterSummary" style="margin-top: 0.35rem; font-weight: 600;">
                    필터 요약: -
                </div>
                <div class="helper-text" id="excelExportProgress" style="margin-top: 0.75rem; color: #0f766e;">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeExcelExportModal()">
                    <i class="fas fa-times"></i> 취소
                </button>
                <button type="button" class="btn btn-success" id="btnExcelExportRun" onclick="runExcelExport()">
                    <i class="fas fa-file-excel"></i> 엑셀 생성
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         공지 표 삽입 모달
         =================================== -->
    <div id="noticeTableModal" class="modal">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-table"></i> 표 삽입</h2>
                <button class="modal-close" type="button" onclick="closeNoticeTableModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="noticeTableRows">행 (Rows)</label>
                    <input type="number" id="noticeTableRows" class="form-input" min="1" max="30" value="3">
                </div>
                <div class="form-group">
                    <label for="noticeTableCols">열 (Columns)</label>
                    <input type="number" id="noticeTableCols" class="form-input" min="1" max="20" value="3">
                </div>
                <div class="form-help">기본값: 행 3 / 열 3</div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeNoticeTableModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
                <button type="button" class="btn btn-primary" id="btnNoticeTableInsert">
                    <i class="fas fa-table"></i> 삽입
                </button>
            </div>
        </div>
    </div>

    <!-- 공지 표 삽입 팝오버 -->
    <div id="noticeTablePopover" class="notice-table-popover">
        <div class="popover-title"><i class="fas fa-table"></i> 빠른 표 삽입</div>
        <div class="popover-row">
            <label for="noticeTableRowsPopover">행</label>
            <input type="number" id="noticeTableRowsPopover" class="form-input" min="1" max="30" value="3">
        </div>
        <div class="popover-row">
            <label for="noticeTableColsPopover">열</label>
            <input type="number" id="noticeTableColsPopover" class="form-input" min="1" max="20" value="3">
        </div>
        <div class="popover-actions">
            <button type="button" class="btn btn-secondary btn-sm" id="btnNoticeTablePopoverMore">
                상세
            </button>
            <button type="button" class="btn btn-primary btn-sm" id="btnNoticeTablePopoverInsert">
                삽입
            </button>
        </div>
    </div>

    <!-- Scripts 순서 중요 -->
    <script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js?full=1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
    <script src="/static/js/config.js?v=3.5"></script>
    <script src="/static/js/navigation.js?v=4.5"></script>  <!-- ⭐ 버전 업 -->
    <script src="/static/js/stage-icons.js"></script>
    <script src="/static/js/project-form.js?v=3.8"></script>
    <script src="/static/js/clients-list.js?v=3.5"></script>  <!-- ⭐ 버전 추가 -->
    <script src="/static/js/clients-form.js?v=3.0"></script>  <!-- ⭐ 신규 추가 -->
    <script src="/static/js/sales-plan.js?v=2.7"></script>
    <script src="/static/js/sales-actual.js?v=3.2"></script>
    <script src="/static/js/sales-dashboard.js?v=1.1"></script>
    <script src="/static/js/project-history-calendar.js?v=1.1"></script>
    <script src="/static/js/report.js?v=1.16"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script src="https://unpkg.com/quill-better-table@1.2.10/dist/quill-better-table.min.js"></script>
    <script src="/static/js/users-list.js?v=2.2"></script>
    <script src="/static/js/users-form.js?v=1.4"></script>
    <script src="/static/js/notices.js?v=1.0"></script>
    <script src="/static/js/notice-templates.js?v=1.0"></script>
    <script src="/static/js/login-history.js?v=1.0"></script>
    <script src="/static/js/permissions.js?v=1.1"></script>
    <script src="/static/js/common-codes.js?v=1.5"></script>
    <script src="/static/js/industry-fields.js?v=1.0"></script>
    <script src="/static/js/service-codes.js?v=1.0"></script>
    <script src="/static/js/org-units.js?v=1.0"></script>
    <script src="/static/js/companies.js?v=1.0"></script>
    <script src="/static/js/data-management.js?v=1.0"></script>
    <script src="/static/js/my-info.js?v=1.1"></script>
    <script src="/static/js/app.js?v=3.2"></script>
    <script src="/static/js/mobile.js?v=2.5"></script>
    <script src="/static/js/markdown-formatter.js"></script>


    <!-- ============================================ -->
    <!-- ⭐ 마크다운 가이드 모달 (신규 추가) -->
    <!-- ============================================ -->
    <div id="markdownGuideModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 700px; width: 90%;">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-book-open"></i>
                    마크다운 문법 가이드
                </h2>
                <button class="modal-close" onclick="closeMarkdownGuide()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <div style="display: grid; gap: 1.5rem;">
                    
                    <!-- 기본 사용법 -->
                    <div style="background: #e8f5e9; padding: 1rem; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <h4 style="color: #2e7d32; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-lightbulb"></i>
                            기본 사용법
                        </h4>
                        <p style="margin: 0; color: #1b5e20; line-height: 1.6;">
                            라인 시작 부분에 기호를 입력하고 <strong>스페이스</strong>를 누르면 자동으로 변환됩니다.
                            <br><strong>Enter</strong> 키를 누르면 다음 줄에 같은 형식이 자동으로 추가됩니다.
                        </p>
                    </div>
                    
                    <!-- 글머리 기호 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-list-ul"></i>
                            글머리 기호 (Bullet Points)
                        </h3>
                        
                        <div style="display: grid; gap: 1rem;">
                            <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                                <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                    <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                    <div>* 첫 번째 항목</div>
                                    <div>- 두 번째 항목</div>
                                    <div>+ 세 번째 항목</div>
                                </div>
                                
                                <div style="font-size: 1.5rem; color: #667eea;">→</div>
                                
                                <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                    <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                    <div>• 첫 번째 항목</div>
                                    <div>• 두 번째 항목</div>
                                    <div>• 세 번째 항목</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 번호 목록 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-list-ol"></i>
                            번호 목록 (Numbered List)
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                <div>1. 첫 번째</div>
                                <div style="color: #999; font-style: italic;">(Enter 누르면 자동으로 2.)</div>
                                <div>2. 두 번째</div>
                                <div>3. 세 번째</div>
                            </div>
                            
                            <div style="font-size: 1.5rem; color: #667eea;">✓</div>
                            
                            <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                <div>1. 첫 번째</div>
                                <div>2. 두 번째</div>
                                <div>3. 세 번째</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 체크리스트 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-check-square"></i>
                            체크리스트 (Checklist)
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                <div>[ ] 미완료 작업</div>
                                <div>[x] 완료된 작업</div>
                                <div>[X] 완료 (대문자)</div>
                            </div>
                            
                            <div style="font-size: 1.5rem; color: #667eea;">→</div>
                            
                            <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                <div>☐ 미완료 작업</div>
                                <div>☑ 완료된 작업</div>
                                <div>☑ 완료 (대문자)</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 들여쓰기 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-indent"></i>
                            들여쓰기 (Indentation)
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                <div>* 상위 항목</div>
                                <div style="padding-left: 2rem;">* 하위 항목 (Tab)</div>
                                <div style="padding-left: 4rem;">* 더 하위 (Tab x2)</div>
                            </div>
                            
                            <div style="font-size: 1.5rem; color: #667eea;">→</div>
                            
                            <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                <div>• 상위 항목</div>
                                <div style="padding-left: 2rem;">• 하위 항목</div>
                                <div style="padding-left: 4rem;">• 더 하위</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 키보드 단축키 -->
                    <div style="background: #fff3e0; padding: 1rem; border-radius: 8px; border-left: 4px solid #ff9800;">
                        <h4 style="color: #e65100; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-keyboard"></i>
                            키보드 단축키
                        </h4>
                        <div style="display: grid; gap: 0.75rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Tab</kbd></span>
                                <span>들여쓰기</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Shift + Tab</kbd></span>
                                <span>내어쓰기</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Enter</kbd></span>
                                <span>다음 줄에 같은 형식 자동 생성</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Enter</kbd> (빈 줄)</span>
                                <span>포맷 종료</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 실전 예제 -->
                    <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; border-left: 4px solid #2196f3;">
                        <h4 style="color: #0d47a1; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-star"></i>
                            실전 예제
                        </h4>
                        <div style="background: white; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; line-height: 1.8; border: 1px solid #90caf9;">
                            <div>• 고객사 미팅 완료</div>
                            <div style="padding-left: 2rem;">• 주요 요구사항 확인</div>
                            <div style="padding-left: 2rem;">• 예산 및 일정 논의</div>
                            <div>• 제안서 작성 계획</div>
                            <div style="padding-left: 2rem;">1. 기술 스펙 정리</div>
                            <div style="padding-left: 2rem;">2. 견적 산출</div>
                            <div style="padding-left: 2rem;">3. 발표 자료 준비</div>
                            <div>• 다음 액션 아이템</div>
                            <div style="padding-left: 2rem;">☐ 기술팀 검토 요청</div>
                            <div style="padding-left: 2rem;">☐ 견적서 초안 작성</div>
                            <div style="padding-left: 2rem;">☑ 미팅 노트 공유</div>
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="closeMarkdownGuide()" style="padding: 0.75rem 2rem;">
                    <i class="fas fa-check"></i> 확인
                </button>
            </div>
        </div>
    </div>

    <script>
    // ⭐ 마크다운 가이드 모달 함수
    function showMarkdownGuide() {
        const modal = document.getElementById('markdownGuideModal');
        if (modal) {
            modal.classList.add('active');
            modal.style.display = 'flex';
        }
    }

    function closeMarkdownGuide() {
        const modal = document.getElementById('markdownGuideModal');
        if (modal) {
            modal.classList.remove('active');
            modal.style.display = 'none';
        }
    }

    // 모달 외부 클릭 시 닫기
    window.addEventListener('click', function(event) {
        const modal = document.getElementById('markdownGuideModal');
        if (modal && event.target === modal) {
            closeMarkdownGuide();
        }
    });
    </script>

</body>
</html>
