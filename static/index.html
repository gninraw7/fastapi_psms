<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSMS - 프로젝트 관리 시스템</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Tabulator CSS -->
    <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
    
    <!-- SheetJS -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
	
    <link rel="stylesheet" href="/static/css/styles.css?v=1.8">
    <link rel="stylesheet" href="/static/css/navigation.css">
    <link rel="stylesheet" href="/static/css/project-form.css?v=1.5">
	<link rel="stylesheet" href="/static/css/mobile.css">
    <link rel="stylesheet" href="/static/css/clients.css?v=1.0.0">
    <link rel="stylesheet" href="/static/css/breadcrumb.css">
    <link rel="stylesheet" href="/static/css/sales-planning.css">

    <!-- ⭐ 인증 관리 스크립트 추가 -->
    <script src="/static/js/auth.js"></script>    
</head>
<body>
    <!-- 인증 확인 스크립트 -->
    <script src="/static/js/auth-check.js?v=1.2"></script>

    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand" onclick="goHome()" style="cursor: pointer;">
                <i class="fas fa-project-diagram"></i>
                <span>PSMS</span>
            </div>
            
            <ul class="navbar-menu">
                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-chart-line"></i>
                        프로젝트 관리
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="projects-list"><i class="fas fa-list"></i> 프로젝트 목록</a></li>
                        <li><a href="#" data-page="projects-new" data-mode="new"><i class="fas fa-plus-circle"></i> 신규 프로젝트</a></li>
                        <li><a href="#" data-page="clients-list"><i class="fas fa-building"></i> 거래처 관리</a></li>
                        <li class="dropdown-divider"></li>
                        <li><a href="#" data-page="sales-dashboard"><i class="fas fa-tachometer-alt"></i> 프로젝트 대시보드</a></li>
                    </ul>
                </li>
                
                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-calendar-check"></i>
                        영업계획
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="sales-plan-list"><i class="fas fa-list"></i> 계획 목록</a></li>
                        <li><a href="#" data-page="sales-plan-edit"><i class="fas fa-pen-to-square"></i> 계획 입력</a></li>
                    </ul>
                </li>
                
                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-chart-bar"></i>
                        실적관리
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="sales-actual-entry"><i class="fas fa-clipboard-check"></i> 실적 등록</a></li>
                        <li><a href="#" data-page="sales-actual-dashboard"><i class="fas fa-chart-line"></i> 실적 현황</a></li>
                    </ul>
                </li>

                <li class="navbar-item">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-chart-pie"></i>
                        Report
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="report-hub"><i class="fas fa-layer-group"></i> 유형별 현황</a></li>
                    </ul>
                </li>
                
                <li class="navbar-item" id="adminMenu">
                    <a href="#" class="navbar-link">
                        <i class="fas fa-cog"></i>
                        관리자
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#" data-page="users"><i class="fas fa-users"></i> 사용자 관리</a></li>
                        <li><a href="#" data-page="common-codes"><i class="fas fa-code"></i> 공통코드 관리</a></li>
                        <li><a href="#" data-page="industry-fields"><i class="fas fa-tags"></i> 분야코드 관리</a></li>
                        <li><a href="#" data-page="service-codes"><i class="fas fa-layer-group"></i> 서비스코드 관리</a></li>
                        <li><a href="#" data-page="org-units"><i class="fas fa-sitemap"></i> 조직 관리</a></li>
                        <li class="dropdown-divider"></li>
                        <li><a href="#" data-page="settings"><i class="fas fa-sliders-h"></i> 시스템 설정</a></li>
                    </ul>
                </li>
			</ul>			
            
            <div class="navbar-user">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="currentUser">사용자</span>
                </div>
                <div class="user-menu">
                    <button class="btn-icon" title="내정보" onclick="openMyInfo()">
                        <i class="fas fa-user-cog"></i>
                    </button>
                    <button class="btn-icon" title="로그아웃" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div id="app-content">
        <!-- 프로젝트 목록 페이지 -->
        <div id="page-projects-list" class="page-content active">
            <main class="app-main">
                <!-- 통계 패널 -->
                <div class="stats-panel">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <i class="fas fa-folder-open"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statTotal">0</div>
                            <div class="stat-label">전체 프로젝트</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statProgress">0</div>
                            <div class="stat-label">진행중</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statCompleted">0</div>
                            <div class="stat-label">완료</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            <i class="fas fa-won-sign"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="statAmount">0원</div>
                            <div class="stat-label">총 견적금액</div>
                        </div>
                    </div>
                </div>

                <!-- 필터 패널 -->
                <div class="filter-panel">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label><i class="fas fa-search"></i> 검색필드</label>
                            <select id="searchField" class="form-select">
                                <option value="">전체</option>
                                <option value="pipeline_id">파이프라인ID</option>
                                <option value="project_name">프로젝트명</option>
                                <option value="customer_name">고객사</option>
                            </select>
                        </div>
                        
                        <div class="filter-group" style="flex: 2;">
                            <label><i class="fas fa-keyboard"></i> 검색어</label>
                            <input type="text" id="searchText" class="form-input" placeholder="검색어를 입력하세요">
                        </div>
                        
                        <div class="filter-group" style="flex: 0 0 auto;">
                            <label>&nbsp;</label>
                            <button id="btnSearch" class="btn btn-secondary">
                                <i class="fas fa-search"></i> 검색
                            </button>
                        </div>

                        
                        <div class="filter-group">
                            <label><i class="fas fa-user"></i> 담당자</label>
                            <select id="filterManager" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label><i class="fas fa-briefcase"></i> 사업분야</label>
                            <select id="filterField" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label><i class="fas fa-flag"></i> 진행단계</label>
                            <select id="filterStage" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="filter-actions">
                        <button id="toggleLatestHistory" class="btn btn-toggle" type="button" aria-pressed="false" title="마우스 오버 시 최종 이력 표시">
                            <i class="fas fa-history"></i>
                            <span class="toggle-label">최종 이력 보기</span>
                            <span class="toggle-state">OFF</span>
                        </button>
                        <button id="btnAdd" class="btn btn-primary" title="새 프로젝트 추가">
                            <i class="fas fa-plus-circle"></i> 신규
                        </button>
                        <button id="btnRefresh" class="btn btn-info">
                            <i class="fas fa-sync-alt"></i> 새로고침
                        </button>
                        <button id="btnExport" class="btn btn-success">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>

                    </div>
                </div>

                <!-- 테이블 패널 -->
                <div class="table-panel">
                    <div id="projectTable"></div>
                </div>
                <div id="latestHistoryTooltip" class="history-tooltip" aria-hidden="true"></div>
            </main>
        </div>

        <!-- 프로젝트 신규/수정 페이지 -->
        <div id="page-projects-new" class="page-content">
            <div class="form-container">
                <div class="form-header">
                    <div class="form-title">
                        <i class="fas fa-edit"></i>
                        <h2 id="formTitle">신규 프로젝트</h2>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-primary" onclick="saveProject()" title="저장">
                            <i class="fas fa-save"></i> 저장
                        </button>
                        <button class="btn btn-outline-secondary" onclick="closeProjectForm()" title="목록으로">
                            <i class="fas fa-list"></i> 목록
                        </button>
                        <button class="btn btn-close-icon" onclick="closeProjectForm()" title="닫기">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <!-- 탭 네비게이션 -->
                <div class="tabs">
                    <button class="tab-btn active" data-tab="basic">
                        <i class="fas fa-info-circle"></i> 기본정보
                    </button>
                    <button class="tab-btn" data-tab="attributes">
                        <i class="fas fa-tags"></i> 속성정보
                    </button>
                    <button class="tab-btn" data-tab="history">
                        <i class="fas fa-history"></i> 변경이력
                    </button>
                </div>

                <!-- 탭 컨텐츠 -->
                <div class="tab-content">
                    <!-- ============================================ -->
                    <!-- 기본정보 탭 (1.1, 1.2, 1.3 수정 반영) -->
                    <!-- ============================================ -->
                    <div id="tab-basic" class="tab-pane active">
                        <div class="form-grid">
                            <!-- 파이프라인 ID -->
                            <div class="form-group">
                                <label>파이프라인 ID <span class="required">*</span></label>
                                <input type="text" id="pipeline_id" class="form-input" readonly>
                                <small class="form-help">자동 생성됩니다</small>
                            </div>

                            <!-- 1.1 진행단계 (API에서 STAGE 코드 로드) -->
                            <div class="form-group">
                                <label>진행단계 <span class="required">*</span></label>
                                <select id="current_stage" class="form-select" required>
                                    <option value="">선택하세요</option>
                                    <!-- loadFormComboBoxes()에서 동적 로드 -->
                                </select>
                            </div>

                            <!-- 프로젝트명 -->
                            <div class="form-group full-width">
                                <label>프로젝트명 <span class="required">*</span></label>
                                <input type="text" id="project_name" class="form-input" placeholder="프로젝트명을 입력하세요" required>
                            </div>

                            <!-- 사업분야 -->
                            <div class="form-group">
                                <label>사업분야 <span class="required">*</span></label>
                                <select id="field_code" class="form-select" required>
                                    <option value="">선택하세요</option>
                                </select>
                            </div>

                            <!-- 서비스코드 -->
                            <div class="form-group">
                                <label>서비스코드</label>
                                <select id="service_code" class="form-select">
                                    <option value="">선택하세요</option>
                                </select>
                            </div>

                            <!-- 1.1 담당자 (API 응답 형식 수정) -->
                            <div class="form-group">
                                <label>담당자 <span class="required">*</span></label>
                                <select id="manager_id" class="form-select" required>
                                    <option value="">선택하세요</option>
                                    <!-- loadFormComboBoxes()에서 동적 로드 -->
                                </select>
                            </div>

                            <!-- 담당조직 -->
                            <div class="form-group">
                                <label>담당조직</label>
                                <select id="org_id" class="form-select">
                                    <option value="">선택하세요</option>
                                </select>
                            </div>

                            <!-- 1.2 고객사 (검색 모달 연동) -->
                            <div class="form-group">
                                <label>고객사 <span class="required">*</span></label>
                                <input type="hidden" id="customer_id">
                                <div class="input-group">
                                    <input type="text" id="customer_name" class="form-input" placeholder="클릭하여 검색" readonly style="cursor: pointer;">
                                    <button type="button" id="customer_search_btn" class="btn btn-secondary btn-sm">
                                        <i class="fas fa-search"></i>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('customer_id').value=''; document.getElementById('customer_name').value='';">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- 1.2 발주처 (검색 모달 연동) -->
                            <div class="form-group">
                                <label>발주처</label>
                                <input type="hidden" id="ordering_party_id">
                                <div class="input-group">
                                    <input type="text" id="ordering_party_name" class="form-input" placeholder="클릭하여 검색" readonly style="cursor: pointer;">
                                    <button type="button" id="ordering_party_search_btn" class="btn btn-secondary btn-sm">
                                        <i class="fas fa-search"></i>
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('ordering_party_id').value=''; document.getElementById('ordering_party_name').value='';">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- 견적금액 -->
                            <div class="form-group">
                                <label>견적금액</label>
                                <input type="number" id="quoted_amount" class="form-input" placeholder="0" min="0">
                            </div>

                            <!-- 1.3 수주확률 (신규 컬럼) -->
                            <div class="form-group">
                                <label>수주확률 (%)</label>
                                <input type="number" id="win_probability" class="form-input" placeholder="0" min="0" max="100">
                                <small class="form-help">0 ~ 100 사이 값 입력</small>
                            </div>

                            <!-- 1.3 비고 (신규 컬럼) -->
                            <div class="form-group full-width">
                                <label>비고</label>
                                <textarea id="notes" class="form-textarea" rows="3" placeholder="비고 내용을 입력하세요"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- ============================================ -->
                    <!-- 속성정보 탭 (2.1 수정 반영) -->
                    <!-- ============================================ -->
                    <div id="tab-attributes" class="tab-pane">
                        <div class="tab-project-name">
                            <span class="tab-project-label">프로젝트명</span>
                            <span class="tab-project-value" id="tabProjectNameAttributes">-</span>
                        </div>
                        <div class="tab-description">
                            <i class="fas fa-info-circle"></i>
                            프로젝트 속성을 관리합니다. 속성명은 중복 등록할 수 없습니다.
                        </div>
                        <div id="attributesList">
                            <!-- renderAttributes()에서 동적 생성 -->
                        </div>
                    </div>

                    <!-- ============================================ -->
                    <!-- 변경이력 탭 (3.1 수정 반영) -->
                    <!-- ============================================ -->
                    <div id="tab-history" class="tab-pane">
                        <div class="tab-project-name">
                            <span class="tab-project-label">프로젝트명</span>
                            <span class="tab-project-value" id="tabProjectNameHistory">-</span>
                        </div>
                        <div class="tab-description">
                            <i class="fas fa-info-circle"></i>
                            프로젝트 진행 이력을 관리합니다. 신규 등록시 기본 단계는 "1 영업중(S01)", 수정시에는 현재 진행단계가 기본값으로 설정됩니다.
                        </div>
                        
                        <!-- ⭐ 마크다운 포맷팅 옵션 (신규 추가) -->
                        <div class="markdown-format-option" style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            padding: 0.875rem 1.25rem;
                            background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf3 100%);
                            border-radius: 8px;
                            margin-bottom: 1rem;
                            border: 1px solid #d8dce6;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
                        ">
                            <label for="enable_markdown_formatting" style="
                                display: flex;
                                align-items: center;
                                gap: 0.75rem;
                                cursor: pointer;
                                user-select: none;
                                flex: 1;
                            ">
                                <!-- 체크박스 -->
                                <input 
                                    type="checkbox" 
                                    id="enable_markdown_formatting"
                                    onchange="toggleMarkdownFormatting(this.checked)"
                                    style="
                                        width: 20px;
                                        height: 20px;
                                        cursor: pointer;
                                        accent-color: #667eea;
                                    "
                                >
                                
                                <span style="
                                    font-weight: 600;
                                    color: #2c3e50;
                                    font-size: 0.9rem;
                                    display: flex;
                                    align-items: center;
                                    gap: 0.5rem;
                                ">
                                    <i class="fas fa-magic" style="color: #667eea;"></i>
                                    스마트 포맷팅 사용
                                    <span style="
                                        font-size: 0.75rem;
                                        font-weight: 400;
                                        color: #7f8c8d;
                                        background: white;
                                        padding: 0.15rem 0.5rem;
                                        border-radius: 4px;
                                    ">
                                        마크다운 자동 변환
                                    </span>
                                </span>
                            </label>
                            
                            <!-- 도움말 버튼 -->
                            <button 
                                type="button"
                                onclick="showMarkdownGuide()"
                                style="
                                    background: white;
                                    border: 1.5px solid #667eea;
                                    color: #667eea;
                                    padding: 0.5rem 1rem;
                                    border-radius: 6px;
                                    font-size: 0.85rem;
                                    font-weight: 600;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                    display: flex;
                                    align-items: center;
                                    gap: 0.5rem;
                                "
                                onmouseover="this.style.background='#667eea'; this.style.color='white'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(102,126,234,0.3)';"
                                onmouseout="this.style.background='white'; this.style.color='#667eea'; this.style.transform='translateY(0)'; this.style.boxShadow='none';"
                            >
                                <i class="fas fa-book-open"></i>
                                문법 가이드
                            </button>
                        </div>
                        
                        <div id="historiesList">
                            <!-- renderHistories()에서 동적 생성 -->
                        </div>
                    </div>

                </div>
            </div>
        </div>

 

        <!-- 준비중 페이지들 (기존과 동일) -->

        <!-- ============================================ -->
        <!-- 1.2 고객사/발주처 검색 모달 (신규 추가) -->
        <!-- ============================================ -->
        <div id="clientSearchModal" class="modal" style="display: none;">
            <div class="modal-content modal-medium">
                <div class="modal-header">
                    <h2>
                        <i class="fas fa-building"></i>
                        고객사/발주처 검색
                    </h2>
                    <button class="modal-close" onclick="closeClientSearchModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- 검색 영역 -->
                    <div class="search-box">
                        <div class="input-group">
                            <input type="text" id="clientSearchInput" class="form-input" 
                                placeholder="고객사명, 사업자번호, 대표자명으로 검색"
                                onkeypress="if(event.key==='Enter') searchClients()">
                            <button type="button" class="btn btn-primary" onclick="searchClients()">
                                <i class="fas fa-search"></i> 검색
                            </button>
                        </div>
                    </div>
                    
                    <!-- 검색 결과 -->
                    <div id="clientSearchResults" class="client-search-results">
                        <p style="text-align: center; padding: 20px; color: #666;">
                            검색어를 입력하세요
                        </p>
                    </div>
                    
                    <!-- 페이징 -->
                    <div id="clientSearchPagination" class="pagination-container">
                    </div>
                </div>
            </div>
        </div>
        
    <!-- ========================================
         Mobile: 프로젝트 목록
         ======================================== -->
    <div id="page-mobile-projects" class="page-content mobile-page">
        <div class="mobile-container">
            <!-- 헤더 -->
            <div class="mobile-header">
                <h2><i class="fas fa-list"></i> 프로젝트 목록</h2>
                <button class="btn-mobile btn-mobile-primary" onclick="navigateTo('mobile-project-new')">
                    <i class="fas fa-plus"></i> 신규
                </button>
            </div>
            
            <!-- 검색 필터 -->
            <div class="mobile-filter">
                <div class="mobile-search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="mobileSearchInput" placeholder="프로젝트명, 거래처명 검색...">
                </div>
                
                <div class="mobile-filter-row">
                    <select id="mobileStageFilter" class="mobile-select">
                        <option value="">전체 진행단계</option>
                    </select>
                    
                    <select id="mobileYearFilter" class="mobile-select">
                        <option value="">전체 연도</option>
                    </select>
                </div>
            </div>
            
            <!-- 통계 카드 -->
            <div class="mobile-stats">
                <div class="mobile-stat-item">
                    <div class="mobile-stat-label">전체</div>
                    <div class="mobile-stat-value" id="mobileTotalCount">0</div>
                </div>
                <div class="mobile-stat-item">
                    <div class="mobile-stat-label">진행중</div>
                    <div class="mobile-stat-value" id="mobileActiveCount">0</div>
                </div>
                <div class="mobile-stat-item">
                    <div class="mobile-stat-label">완료</div>
                    <div class="mobile-stat-value" id="mobileCompleteCount">0</div>
                </div>
            </div>
            
            <!-- 프로젝트 목록 -->
            <div id="mobileProjectList" class="mobile-project-list">
                <!-- 동적 생성 -->
            </div>
        </div>
    </div>
    
	<!-- ========================================
		 Mobile: 프로젝트 등록/수정 (수정됨)
		 ======================================== -->
	<div id="page-mobile-project-new" class="page-content mobile-page">
		<div class="mobile-container">
			<!-- 헤더 -->
			<div class="mobile-header">
				<button class="btn-mobile-back" onclick="navigateTo('mobile-projects')">
					<i class="fas fa-arrow-left"></i>
				</button>
				<h2 id="mobileFormTitle">프로젝트 등록</h2>
				<button class="btn-mobile-icon" onclick="saveMobileProject()">
					<i class="fas fa-save"></i>
				</button>
			</div>
			
			<!-- 프로젝트 등록/수정 폼 -->
			<form id="mobileProjectForm" class="mobile-form" onsubmit="event.preventDefault(); saveMobileProject();">			
				<input type="hidden" id="mobilePipelineId">
				
				<!-- 분야 (FIELD) -->
				<div class="mobile-form-group">
					<label>분야 <span class="required">*</span></label>
					<select id="mobileFieldCode" required>
						<option value="">선택하세요</option>
					</select>
				</div>

				<!-- 서비스코드 -->
				<div class="mobile-form-group">
					<label>서비스코드</label>
					<select id="mobileServiceCode">
						<option value="">선택하세요</option>
					</select>
				</div>

				<!-- 담당조직 -->
				<div class="mobile-form-group">
					<label>담당조직</label>
					<select id="mobileOrgId">
						<option value="">선택하세요</option>
					</select>
				</div>
				
				<!-- 고객사 (검색) -->
				<div class="mobile-form-group">
					<label>고객사 <span class="required">*</span></label>
					<div class="mobile-search-field">
						<input type="hidden" id="mobileCustomerId" required>
						<input 
							type="text" 
							id="mobileCustomerSearch" 
							placeholder="고객사명을 검색하세요..."
							autocomplete="off"
							readonly
							onclick="openMobileClientSearch('customer')"
						>
						<button type="button" class="btn-search" onclick="openMobileClientSearch('customer')">
							<i class="fas fa-search"></i>
						</button>
					</div>
					<div class="mobile-field-help">
						<i class="fas fa-info-circle"></i> 탭하여 고객사를 검색하세요
					</div>
				</div>
				
				<!-- 발주처 (검색) -->
				<div class="mobile-form-group">
					<label>발주처</label>
					<div class="mobile-search-field">
						<input type="hidden" id="mobileOrderingPartyId">
						<input 
							type="text" 
							id="mobileOrderingPartySearch" 
							placeholder="발주처명을 검색하세요..."
							autocomplete="off"
							readonly
							onclick="openMobileClientSearch('ordering')"
						>
						<button type="button" class="btn-search" onclick="openMobileClientSearch('ordering')">
							<i class="fas fa-search"></i>
						</button>
						<button type="button" class="btn-clear" onclick="clearMobileClient('ordering')" style="display: none;">
							<i class="fas fa-times"></i>
						</button>
					</div>
					<div class="mobile-field-help">
						<i class="fas fa-info-circle"></i> 고객사와 다른 경우만 입력
					</div>
				</div>
				
				<!-- 프로젝트명 -->
				<div class="mobile-form-group">
					<label>프로젝트명 <span class="required">*</span></label>
					<input type="text" id="mobileProjectName" required placeholder="프로젝트명을 입력하세요">
				</div>
				
				<!-- 진행단계 (STAGE) -->
				<div class="mobile-form-group">
					<label>진행단계 <span class="required">*</span></label>
					<select id="mobileCurrentStage" required>
						<option value="">선택하세요</option>
					</select>
				</div>
				
				<!-- 담당자 -->
				<div class="mobile-form-group">
					<label>담당자</label>
					<select id="mobileManagerId">
						<option value="">선택하세요</option>
					</select>
				</div>

				<!-- 프로젝트 등록/수정 폼에서 다음 필드들을 주석 처리 또는 제거 -->
				<!-- 				
				<div class="mobile-form-row">
					<div class="mobile-form-group">
						<label>연도</label>
						<input type="number" id="mobileYear" min="2020" max="2030">
					</div>
					
					<div class="mobile-form-group">
						<label>분기</label>
						<select id="mobileQuarter">
							<option value="">-</option>
							<option value="1">1분기</option>
							<option value="2">2분기</option>
							<option value="3">3분기</option>
							<option value="4">4분기</option>
						</select>
					</div>
				</div>
				
				<div class="mobile-form-group">
					<label>예상금액 (천원)</label>
					<input type="number" id="mobileExpectedAmount" step="1000" placeholder="0">
				</div>
				
				<div class="mobile-form-group">
					<label>확정금액 (천원)</label>
					<input type="number" id="mobileConfirmedAmount" step="1000" placeholder="0">
				</div>
				-->
				
				<!-- 비고 -->
				<div class="mobile-form-group">
					<label>비고</label>
					<textarea id="mobileRemarks" rows="3" placeholder="비고사항을 입력하세요"></textarea>
				</div>
				
				<!-- 액션 버튼 -->
				<div class="mobile-form-actions">
					<button type="button" class="btn-mobile btn-mobile-secondary" onclick="navigateTo('mobile-projects')">
						<i class="fas fa-times"></i> 취소
					</button>
					<button type="submit" class="btn-mobile btn-mobile-primary">
						<i class="fas fa-save"></i> 저장
					</button>
				</div>
			</form>
		</div>
	</div>

	<!-- ========================================
		 Mobile: 이력 등록
		 ======================================== -->
	<div id="page-mobile-history-new" class="page-content mobile-page">
		<div class="mobile-container">
			<!-- 헤더 -->
			<div class="mobile-header">
				<button class="btn-mobile-back" onclick="navigateTo('mobile-projects')">
					<i class="fas fa-arrow-left"></i>
				</button>
				<h2>이력 등록</h2>
				<button class="btn-mobile-icon" onclick="saveMobileHistory()">
					<i class="fas fa-save"></i>
				</button>
			</div>
			
			<!-- 폼 -->
			<form id="mobileHistoryForm" class="mobile-form" onsubmit="event.preventDefault(); saveMobileHistory();">
				
				<!-- 프로젝트 선택 -->
				<div class="mobile-form-group">
					<label>프로젝트 <span class="required">*</span></label>
					<select id="mobileHistoryProject" required onchange="loadMobileProjectInfo()">
						<option value="">프로젝트를 선택하세요</option>
					</select>
				</div>
				
				<!-- 선택된 프로젝트 정보 -->
				<div id="mobileProjectInfo" class="mobile-project-info" style="display: none;">
					<div class="mobile-info-row">
						<span class="mobile-info-label">고객사:</span>
						<span id="mobileInfoClient">-</span>
					</div>
					<div class="mobile-info-row">
						<span class="mobile-info-label">현재단계:</span>
						<span id="mobileInfoStage"></span>
					</div>
				</div>
				
				<!-- 이력 일자 -->
				<div class="mobile-form-group">
					<label>이력 일자 <span class="required">*</span></label>
					<input type="date" id="mobileHistoryDate" required>
				</div>
				
				<!-- 진행단계 -->
				<div class="mobile-form-group">
					<label>진행단계 <span class="required">*</span></label>
					<select id="mobileHistoryStage" required>
						<option value="">선택하세요</option>
					</select>
				</div>
				
				<!-- 이력 내용 -->
				<div class="mobile-form-group">
					<label>이력 내용 <span class="required">*</span></label>
					<textarea 
						id="mobileHistoryContent" 
						rows="6" 
						required 
						placeholder="영업 활동 내용, 진행 상황 등을 입력하세요..."
					></textarea>
				</div>
				
				<!-- 액션 버튼 -->
				<div class="mobile-form-actions">
					<button type="button" class="btn-mobile btn-mobile-secondary" onclick="resetMobileHistoryForm()">
						<i class="fas fa-redo"></i> 초기화
					</button>
					<button type="submit" class="btn-mobile btn-mobile-primary">
						<i class="fas fa-save"></i> 저장
					</button>
				</div>
			</form>
		</div>
	</div>
	
	<!-- ========================================
		 Mobile: 거래처 검색 모달
		 ======================================== -->
	<div id="mobileClientSearchModal" class="mobile-modal" style="display: none;">
		<div class="mobile-modal-content">
			<!-- 모달 헤더 -->
			<div class="mobile-modal-header">
				<h3 id="mobileClientSearchTitle">거래처 검색</h3>
				<button class="btn-mobile-close" onclick="closeMobileClientSearch()">
					<i class="fas fa-times"></i>
				</button>
			</div>
			
			<!-- 검색 입력 -->
			<div class="mobile-modal-search">
				<div class="mobile-search-box">
					<i class="fas fa-search"></i>
					<input 
						type="text" 
						id="mobileClientSearchInput" 
						placeholder="거래처명을 입력하세요..."
						autocomplete="off"
					>
				</div>
			</div>
			
			<!-- 검색 결과 -->
			<div class="mobile-modal-body">
				<div id="mobileClientSearchResults" class="mobile-client-list">
					<!-- 동적 생성 -->
				</div>
			</div>
		</div>
    </div>
        <!-- 나머지 준비중 페이지들... -->

    <!-- ===================================
         거래처 관리 - 목록 페이지
         =================================== -->
    <div id="page-clients-list" class="page-content">
        <main class="app-main">
            <!-- 통계 패널 -->
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statTotal">0</div>
                        <div class="stat-label">전체 거래처</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statActive">0</div>
                        <div class="stat-label">활성 거래처</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-pause-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statInactive">0</div>
                        <div class="stat-label">비활성 거래처</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-filter"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="statFiltered">0</div>
                        <div class="stat-label">필터링 결과</div>
                    </div>
                </div>
            </div>

            <!-- 필터 패널 -->
            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-search"></i> 검색 구분</label>
                        <select id="clientSearchField" class="form-select">
                            <option value="">전체</option>
                            <option value="client_name">거래처명</option>
                            <option value="business_number">사업자번호</option>
                            <option value="ceo_name">대표자명</option>
                            <option value="phone">전화번호</option>
                        </select>
                    </div>
                    
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-keyboard"></i> 검색어</label>
                        <input 
                            type="text" 
                            id="clientSearchText" 
                            class="form-input" 
                            placeholder="검색어를 입력하세요"
                        />
                    </div>
                    
                    <div class="filter-group" style="flex: 0 0 auto;">
                        <label>&nbsp;</label>
                        <button class="btn btn-secondary" onclick="applyClientFilters()">
                            <i class="fas fa-search"></i> 검색
                        </button>
                    </div>
                    
                    <div class="filter-group">
                        <label><i class="fas fa-industry"></i> 업종</label>
                        <select id="clientIndustryType" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label><i class="fas fa-toggle-on"></i> 활성 상태</label>
                        <select id="clientIsActive" class="form-select">
                            <option value="">전체</option>
                            <option value="true">활성</option>
                            <option value="false">비활성</option>
                        </select>
                    </div>
                </div>
                
                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnNewClient" type="button" title="새 거래처 추가">
                        <i class="fas fa-plus-circle"></i> 신규
                    </button>
                    <button class="btn btn-info" onclick="resetClientFilters()">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                    <button class="btn btn-success" onclick="exportClientsToExcel()">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                </div>
            </div>

            <!-- 테이블 패널 -->
            <div class="table-panel">
                <div id="clientsTable"></div>
            </div>
        </main>
    </div>


    <!-- ===================================
         거래처 관리 - 등록/수정 페이지
         =================================== -->
    <div id="page-clients-form" class="page-content">
        <div class="form-container client-form-container">
            <div class="form-header">
                <div class="form-title">
                    <i class="fas fa-building"></i>
                    <h2 id="clientFormTitleText">신규 거래처 등록</h2>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" type="button" onclick="saveClientForm()">
                        <i class="fas fa-save"></i> 저장
                    </button>
                    <button class="btn btn-outline-secondary" type="button" data-client-nav="list">
                        <i class="fas fa-list"></i> 목록
                    </button>
                    <button class="btn btn-danger" type="button" id="btnDeleteClient" onclick="deleteClient()" style="display: none;">
                        <i class="fas fa-trash"></i> 삭제
                    </button>
                    <button class="btn btn-close-icon" type="button" data-client-nav="close" title="닫기">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- 거래처 폼 -->
            <form id="clientForm" class="tab-content client-form" onsubmit="event.preventDefault(); saveClientForm();">
                <input type="hidden" id="clientId">
                <input type="hidden" id="clientMode" value="new">

                <!-- 기본 정보 섹션 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-info-circle"></i>
                        기본 정보
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientName" class="required">거래처명</label>
                            <input type="text" id="clientName" class="form-input" required placeholder="거래처명을 입력하세요">
                        </div>
                        
                        <div class="form-group">
                            <label for="businessNumber">사업자번호</label>
                            <input type="text" id="businessNumber" class="form-input" placeholder="000-00-00000" maxlength="12">
                            <span class="form-hint">000-00-00000 형식으로 입력하세요</span>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ceoName">대표자명</label>
                            <input type="text" id="ceoName" class="form-input" placeholder="대표자명을 입력하세요">
                        </div>
                        
                        <div class="form-group">
                            <label for="industryType">업종</label>
                            <select id="industryType" class="form-select">
                                <option value="">선택하세요</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="establishedDate">설립일</label>
                            <input type="date" id="establishedDate" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="employeeCount">직원 수</label>
                            <input type="number" id="employeeCount" class="form-input" min="0" placeholder="직원 수">
                        </div>
                    </div>
                </div>

                <!-- 연락처 정보 섹션 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-phone"></i>
                        연락처 정보
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="address">주소</label>
                            <input type="text" id="address" class="form-input" placeholder="주소를 입력하세요">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone">전화번호</label>
                            <input type="tel" id="phone" class="form-input" placeholder="02-0000-0000">
                            <span class="form-hint">지역번호 포함 입력 (예: 02-0000-0000)</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="fax">팩스번호</label>
                            <input type="tel" id="fax" class="form-input" placeholder="02-0000-0000">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">이메일</label>
                            <input type="email" id="email" class="form-input" placeholder="example@company.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="homepage">홈페이지</label>
                            <input type="url" id="homepage" class="form-input" placeholder="https://www.example.com">
                        </div>
                    </div>
                </div>

                <!-- 추가 정보 섹션 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-cog"></i>
                        추가 정보
                    </h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="isActive">활성 상태</label>
                            <div class="form-switch-group">
                                <label class="form-switch">
                                    <input type="checkbox" id="isActive" class="form-switch-input" checked>
                                    <span class="form-switch-slider"></span>
                                </label>
                                <span class="form-switch-label">활성</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group form-group-full">
                            <label for="remarks">비고</label>
                            <textarea id="remarks" class="form-textarea" rows="4" placeholder="비고사항을 입력하세요"></textarea>
                        </div>
                    </div>
                </div>

                <!-- 액션 버튼 (하단 고정) -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary btn-lg" onclick="navigateToClientList()">
                        <i class="fas fa-list"></i>
                        목록으로
                    </button>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save"></i>
                        저장
                    </button>
                    <button type="button" class="btn btn-danger btn-lg" id="btnDeleteClientBottom" onclick="deleteClient()" style="display: none;">
                        <i class="fas fa-trash"></i>
                        삭제
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ===================================
         프로젝트 대시보드
         =================================== -->
    <div id="page-sales-dashboard" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-tachometer-alt"></i>
                        프로젝트 대시보드
                    </div>
                </div>
                <div class="helper-text">
                    프로젝트 진행 현황 요약은 준비 중입니다. (요청 시 KPI/파이프라인/단계별 현황을 추가 구성)
                </div>
            </div>
        </main>
    </div>

    <!-- ===================================
         영업계획 - 목록 페이지
         =================================== -->
    <div id="page-sales-plan-list" class="page-content">
        <main class="app-main">
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #0f766e 0%, #0d9488 100%);">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatTotal">0</div>
                        <div class="stat-label">전체 계획</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #38bdf8 0%, #0ea5e9 100%);">
                        <i class="fas fa-calendar"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatLatest">-</div>
                        <div class="stat-label">최신 연도</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f97316 0%, #fb923c 100%);">
                        <i class="fas fa-pen"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatDraft">0</div>
                        <div class="stat-label">작성중</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="planStatFinal">0</div>
                        <div class="stat-label">확정</div>
                    </div>
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-calendar-alt"></i> 연도</label>
                        <select id="planYearFilter" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-code-branch"></i> 버전</label>
                        <input type="text" id="planVersionFilter" class="form-input" placeholder="v1, v2...">
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-flag"></i> 상태</label>
                        <select id="planStatusFilter" class="form-select">
                            <option value="">전체</option>
                            <option value="DRAFT">작성중</option>
                            <option value="REVIEW">검토중</option>
                            <option value="FINAL">확정</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-search"></i> 검색어</label>
                        <input type="text" id="planKeywordFilter" class="form-input" placeholder="비고/기준일 등">
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnNewPlan">
                        <i class="fas fa-plus-circle"></i> 신규 계획
                    </button>
                    <button class="btn btn-info" id="btnEditPlan">
                        <i class="fas fa-pen-to-square"></i> 계획 편집
                    </button>
                    <button class="btn btn-secondary" id="btnCopyPlan">
                        <i class="fas fa-copy"></i> 버전 복사
                    </button>
                    <button class="btn btn-success" id="btnRefreshPlan">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                    <button class="btn btn-outline-secondary" id="btnExportPlan">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                </div>
            </div>

            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-route"></i>
                        워크플로우 가이드
                    </div>
                </div>
                <div class="helper-text">
                    계획 연도/버전 생성 → 계획 입력 → 검토/확정 순으로 관리합니다. 동일 연도는 버전으로 이력을 분리합니다.
                </div>
            </div>

            <div class="table-panel">
                <div id="salesPlanTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         영업계획 - 입력 페이지
         =================================== -->
    <div id="page-sales-plan-edit" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-clipboard-list"></i>
                        계획 컨텍스트
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" id="btnPlanHeaderSave">
                            <i class="fas fa-save"></i> 계획 저장
                        </button>
                    </div>
                </div>

                <div class="plan-context-grid">
                    <div class="plan-meta-item">
                        <label>계획 선택</label>
                        <select id="salesPlanSelect" class="form-select"></select>
                    </div>
                    <div class="plan-meta-item">
                        <label>연도</label>
                        <input type="text" id="salesPlanYear" class="form-input" placeholder="2026">
                    </div>
                    <div class="plan-meta-item">
                        <label>버전</label>
                        <input type="text" id="salesPlanVersion" class="form-input" placeholder="v1">
                    </div>
                    <div class="plan-meta-item">
                        <label>상태</label>
                        <select id="salesPlanStatus" class="form-select">
                            <option value="DRAFT">작성중</option>
                            <option value="REVIEW">검토중</option>
                            <option value="FINAL">확정</option>
                        </select>
                    </div>
                    <div class="plan-meta-item">
                        <label>기준일</label>
                        <input type="date" id="salesPlanBaseDate" class="form-input">
                    </div>
                    <div class="plan-meta-item">
                        <label>비고</label>
                        <input type="text" id="salesPlanRemarks" class="form-input" placeholder="예: 본부 검토본">
                    </div>
                </div>
                <div class="helper-text">
                    계획 헤더는 연도/버전 단위로 관리합니다. 확정 상태는 수정 권한에 따라 잠금될 수 있습니다.
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-sitemap"></i> 조직</label>
                        <select id="planFilterOrg" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-user"></i> 담당자</label>
                        <select id="planFilterManager" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-tags"></i> 분야</label>
                        <select id="planFilterField" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-layer-group"></i> 서비스</label>
                        <select id="planFilterService" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-search"></i> 검색어</label>
                        <input type="text" id="planFilterKeyword" class="form-input" placeholder="프로젝트명/고객사 등">
                    </div>
                </div>
            </div>

            <div class="panel-card">
                <div class="plan-toolbar">
                    <div class="toolbar-left">
                        <span class="plan-badge" id="planConsistencyBadge">
                            <i class="fas fa-circle-check"></i> 합계 검증 대기
                        </span>
                        <span class="helper-text">월별 합계는 자동 합산됩니다.</span>
                        <div class="plan-freeze-control">
                            <label for="planFreezeColumn"><i class="fas fa-thumbtack"></i> 고정 열</label>
                            <select id="planFreezeColumn" class="form-select">
                                <option value="">고정 없음</option>
                            </select>
                        </div>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-info" id="btnPlanImport">
                            <i class="fas fa-download"></i> 프로젝트 불러오기
                        </button>
                        <button class="btn btn-outline-secondary" id="btnPlanMissing">
                            <i class="fas fa-folder-open"></i> 미편성 프로젝트
                        </button>
                        <button class="btn btn-outline-secondary" id="btnPlanShowAll">
                            <i class="fas fa-list"></i> 전체 라인 보기
                        </button>
                        <button class="btn btn-danger" id="btnPlanExclude">
                            <i class="fas fa-ban"></i> 선택 제외
                        </button>
                        <button class="btn btn-outline-secondary" id="btnPlanColumns">
                            <i class="fas fa-columns"></i> 컬럼 설정
                        </button>
                        <button class="btn btn-secondary" id="btnPlanRecalc">
                            <i class="fas fa-calculator"></i> 합계 계산
                        </button>
                        <button class="btn btn-success" id="btnPlanSave">
                            <i class="fas fa-save"></i> 라인 저장
                        </button>
                        <button class="btn btn-outline-secondary" id="btnPlanExport">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                    </div>
                </div>
                <div id="salesPlanLineTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         실적관리 - 등록 페이지
         =================================== -->
    <div id="page-sales-actual-entry" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-clipboard-check"></i>
                        실적 컨텍스트
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" id="btnActualHeaderSave">
                            <i class="fas fa-save"></i> 실적 저장
                        </button>
                    </div>
                </div>

                <div class="actual-context-grid">
                    <div class="actual-meta-item">
                        <label>연도</label>
                        <select id="salesActualYear" class="form-select"></select>
                    </div>
                    <div class="actual-meta-item">
                        <label>기준</label>
                        <span class="actual-badge"><i class="fas fa-chart-line"></i> 수주/이익</span>
                    </div>
                    <div class="actual-meta-item">
                        <label>작성 메모</label>
                        <input type="text" id="salesActualRemarks" class="form-input" placeholder="예: 1차 결산 기준">
                    </div>
                </div>
                <div class="helper-text">
                    실적은 연도 단위로 관리하며, 월별 수주금액과 매출이익을 함께 입력합니다.
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-sitemap"></i> 조직</label>
                        <select id="actualFilterOrg" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-user"></i> 담당자</label>
                        <select id="actualFilterManager" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-tags"></i> 분야</label>
                        <select id="actualFilterField" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-layer-group"></i> 서비스</label>
                        <select id="actualFilterService" class="form-select">
                            <option value="">전체</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-search"></i> 검색어</label>
                        <input type="text" id="actualFilterKeyword" class="form-input" placeholder="프로젝트명/고객사 등">
                    </div>
                </div>
            </div>

            <div class="panel-card">
                <div class="actual-toolbar">
                    <div class="toolbar-left">
                        <span class="actual-badge" id="actualConsistencyBadge">
                            <i class="fas fa-circle-check"></i> 합계 검증 대기
                        </span>
                        <span class="helper-text">월별 합계는 자동 합산됩니다.</span>
                        <div class="plan-freeze-control">
                            <label for="actualMonthView"><i class="fas fa-table-columns"></i> 월별 표시</label>
                            <select id="actualMonthView" class="form-select">
                                <option value="group">그룹(1월/수주·이익)</option>
                                <option value="flat">평면(월별/수주·이익)</option>
                            </select>
                        </div>
                        <div class="plan-freeze-control">
                            <label for="actualFreezeColumn"><i class="fas fa-thumbtack"></i> 고정 열</label>
                            <select id="actualFreezeColumn" class="form-select">
                                <option value="">고정 없음</option>
                            </select>
                        </div>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-outline-secondary" id="btnActualColumns">
                            <i class="fas fa-columns"></i> 컬럼 설정
                        </button>
                        <button class="btn btn-secondary" id="btnActualRecalc">
                            <i class="fas fa-calculator"></i> 합계 계산
                        </button>
                        <button class="btn btn-success" id="btnActualSave">
                            <i class="fas fa-save"></i> 라인 저장
                        </button>
                        <button class="btn btn-outline-secondary" id="btnActualExport">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                    </div>
                </div>
                <div id="salesActualLineTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         실적관리 - 현황 페이지
         =================================== -->
    <div id="page-sales-actual-dashboard" class="page-content">
        <main class="app-main">
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4338ca 0%, #2563eb 100%);">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatOrder">0</div>
                        <div class="stat-label">수주 합계</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatProfit">0</div>
                        <div class="stat-label">매출이익 합계</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f97316 0%, #fb923c 100%);">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatYear">-</div>
                        <div class="stat-label">선택 연도</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #64748b 0%, #475569 100%);">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="actualStatGroup">-</div>
                        <div class="stat-label">집계 기준</div>
                    </div>
                </div>
            </div>

            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-calendar-alt"></i> 연도</label>
                        <select id="actualSummaryYear" class="form-select"></select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-layer-group"></i> 집계 기준</label>
                        <select id="actualSummaryGroup" class="form-select">
                            <option value="org">조직</option>
                            <option value="manager">담당자</option>
                            <option value="field">분야</option>
                            <option value="service">서비스</option>
                            <option value="customer">고객사</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label><i class="fas fa-coins"></i> 지표</label>
                        <select id="actualSummaryMetric" class="form-select">
                            <option value="order">수주금액</option>
                            <option value="profit">매출이익</option>
                            <option value="both">수주+이익</option>
                        </select>
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnActualSummaryRun">
                        <i class="fas fa-play"></i> 조회
                    </button>
                    <button class="btn btn-success" id="btnActualSummaryExport">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                </div>
            </div>

            <div class="table-panel">
                <div id="salesActualSummaryTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         Report - 유형별 현황 페이지
         =================================== -->
    <div id="page-report-hub" class="page-content">
        <main class="app-main">
            <div class="panel-card">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-chart-pie"></i>
                        Report Builder
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" id="btnReportRun">
                            <i class="fas fa-play"></i> 조회
                        </button>
                        <button class="btn btn-success" id="btnReportExport">
                            <i class="fas fa-file-excel"></i> 엑셀
                        </button>
                    </div>
                </div>
                <div class="helper-text">
                    조회 유형과 집계 기준을 선택하면 동적으로 보고서를 생성합니다.
                </div>
            </div>

            <div class="report-builder">
                <div class="report-config">
                    <h3>보고서 설정</h3>
                    <div class="form-group">
                        <label>데이터 소스</label>
                        <select id="reportSource" class="form-select">
                            <option value="plan">영업계획</option>
                            <option value="actual">실적관리</option>
                            <option value="gap">계획 대비 실적</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>기준 연도</label>
                        <select id="reportYear" class="form-select"></select>
                    </div>
                    <div class="form-group">
                        <label>집계 기준</label>
                        <select id="reportDimension" class="form-select">
                            <option value="org">조직</option>
                            <option value="manager">담당자</option>
                            <option value="field">분야</option>
                            <option value="service">서비스</option>
                            <option value="customer">고객사</option>
                            <option value="pipeline">프로젝트</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>기간 단위</label>
                        <select id="reportPeriod" class="form-select">
                            <option value="year">연도 합계</option>
                            <option value="quarter">분기</option>
                            <option value="month">월</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>지표</label>
                        <select id="reportMetric" class="form-select">
                            <option value="order">수주금액</option>
                            <option value="profit">매출이익</option>
                            <option value="both">수주+이익</option>
                        </select>
                    </div>
                </div>
                <div class="report-result">
                    <div class="report-filter-panel">
                        <div class="filter-group">
                            <label><i class="fas fa-sitemap"></i> 조직 (복수)</label>
                            <select id="reportFilterOrg" class="form-select" multiple size="6"></select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-user"></i> 담당자 (복수)</label>
                            <select id="reportFilterManager" class="form-select" multiple size="6"></select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-table"></i> 헤더 표시</label>
                            <select id="reportHeaderMode" class="form-select">
                                <option value="two" selected>2줄</option>
                                <option value="one">1줄</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-arrows-left-right"></i> 표시 방식</label>
                            <select id="reportViewMode" class="form-select">
                                <option value="row" selected>세로(행)</option>
                                <option value="pivot">가로(피벗)</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-thumbtack"></i> 고정 대상 수</label>
                            <input type="number" id="reportFreezeTargetCount" class="form-input" min="0" value="0" placeholder="0">
                            <div class="helper-text">0=기본, 1=첫번째 대상까지 고정</div>
                        </div>
                        <button class="btn btn-outline-secondary" id="btnReportFilterReset">
                            <i class="fas fa-undo"></i> 필터 초기화
                        </button>
                    </div>
                    <div class="report-title" id="reportTitle">보고서 조건을 선택하세요.</div>
                    <div class="table-panel report-table-panel">
                        <div id="reportTable"></div>
                    </div>
                    <div class="report-placeholder" id="reportPlaceholder">
                        조회 조건을 설정하고 실행하면 결과가 표시됩니다.
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ===================================
         미편성 프로젝트 모달
         =================================== -->
    <div id="missingProjectsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-folder-open"></i> 미편성 프로젝트</h2>
                <button class="modal-close" type="button" onclick="closeMissingProjectsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="filter-panel" style="margin-bottom: 1rem;">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label><i class="fas fa-sitemap"></i> 조직</label>
                            <select id="missingFilterOrg" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-user"></i> 담당자</label>
                            <select id="missingFilterManager" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-tags"></i> 분야</label>
                            <select id="missingFilterField" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-layer-group"></i> 서비스</label>
                            <select id="missingFilterService" class="form-select">
                                <option value="">전체</option>
                            </select>
                        </div>
                        <div class="filter-group" style="flex: 2;">
                            <label><i class="fas fa-search"></i> 검색어</label>
                            <input type="text" id="missingFilterKeyword" class="form-input" placeholder="프로젝트명/고객사 등">
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-primary" type="button" id="btnMissingApply">
                            <i class="fas fa-search"></i> 적용
                        </button>
                        <button class="btn btn-secondary" type="button" id="btnMissingReset">
                            <i class="fas fa-undo"></i> 초기화
                        </button>
                    </div>
                </div>
                <div class="panel-card" style="padding: 1rem; margin-bottom: 1rem;">
                    <div class="helper-text" id="missingProjectsFilterSummary">
                        현재 필터 조건을 적용하여 미편성 프로젝트를 조회합니다.
                    </div>
                </div>
                <div id="missingProjectsTable"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="refreshMissingProjects()">
                    <i class="fas fa-sync-alt"></i> 조회
                </button>
                <button class="btn btn-primary" type="button" onclick="addSelectedMissingProjects()">
                    <i class="fas fa-plus-circle"></i> 선택 가져오기
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closeMissingProjectsModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         계획 컬럼 설정 모달
         =================================== -->
    <div id="planColumnsModal" class="modal">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-columns"></i> 계획 컬럼 설정</h2>
                <button class="modal-close" type="button" onclick="closePlanColumnsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="column-group-actions">
                    <div class="column-group">
                        <span class="column-group-label">기본정보</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="togglePlanColumnGroup('base')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                    <div class="column-group">
                        <span class="column-group-label">월별</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="togglePlanColumnGroup('month')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                </div>
                <div class="helper-text" style="margin-bottom: 0.75rem;">
                    컬럼 순서는 그리드 헤더를 드래그해 변경하며, 변경 사항은 자동 저장됩니다.
                </div>
                <div id="planColumnsList" class="column-visibility-list"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="setAllPlanColumns(true)">
                    <i class="fas fa-eye"></i> 모두 표시
                </button>
                <button class="btn btn-secondary" type="button" onclick="setAllPlanColumns(false)">
                    <i class="fas fa-eye-slash"></i> 모두 숨김
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closePlanColumnsModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         실적 컬럼 설정 모달
         =================================== -->
    <div id="actualColumnsModal" class="modal">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-columns"></i> 실적 컬럼 설정</h2>
                <button class="modal-close" type="button" onclick="closeActualColumnsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="column-group-actions">
                    <div class="column-group">
                        <span class="column-group-label">기본정보</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="toggleActualColumnGroup('base')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                    <div class="column-group">
                        <span class="column-group-label">월별</span>
                        <button class="btn btn-outline-secondary btn-sm" type="button" onclick="toggleActualColumnGroup('month')">
                            <i class="fas fa-toggle-on"></i> 토글
                        </button>
                    </div>
                </div>
                <div class="helper-text" style="margin-bottom: 0.75rem;">
                    컬럼 순서는 그리드 헤더를 드래그해 변경하며, 변경 사항은 자동 저장됩니다.
                </div>
                <div id="actualColumnsList" class="column-visibility-list"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="setAllActualColumns(true)">
                    <i class="fas fa-eye"></i> 모두 표시
                </button>
                <button class="btn btn-secondary" type="button" onclick="setAllActualColumns(false)">
                    <i class="fas fa-eye-slash"></i> 모두 숨김
                </button>
                <button class="btn btn-outline-secondary" type="button" onclick="closeActualColumnsModal()">
                    <i class="fas fa-times"></i> 닫기
                </button>
            </div>
        </div>
    </div>

    <!-- ===================================
         사용자 관리 - 목록 페이지
         =================================== -->
    <div id="page-users" class="page-content">
        <main class="app-main">
            <!-- 통계 패널 -->
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatTotal">0</div>
                        <div class="stat-label">전체 사용자</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatActive">0</div>
                        <div class="stat-label">활성 사용자</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-user-slash"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatInactive">0</div>
                        <div class="stat-label">비활성 사용자</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-filter"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="userStatFiltered">0</div>
                        <div class="stat-label">필터링 결과</div>
                    </div>
                </div>
            </div>

            <!-- 필터 패널 -->
            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-group">
                        <label><i class="fas fa-search"></i> 검색 구분</label>
                        <select id="userSearchField" class="form-select">
                            <option value="">전체</option>
                            <option value="login_id">로그인 ID</option>
                            <option value="user_name">사용자명</option>
                            <option value="email">이메일</option>
                            <option value="phone">연락처</option>
                            <option value="org_name">조직</option>
                        </select>
                    </div>

                    <div class="filter-group" style="flex: 2;">
                        <label><i class="fas fa-keyboard"></i> 검색어</label>
                        <input
                            type="text"
                            id="userSearchText"
                            class="form-input"
                            placeholder="검색어를 입력하세요"
                        />
                    </div>

                    <div class="filter-group" style="flex: 0 0 auto;">
                        <label>&nbsp;</label>
                        <button class="btn btn-secondary" onclick="applyUserFilters()">
                            <i class="fas fa-search"></i> 검색
                        </button>
                    </div>

                    <div class="filter-group">
                        <label><i class="fas fa-toggle-on"></i> 계정 상태</label>
                        <select id="userStatusFilter" class="form-select">
                            <option value="ACTIVE">ACTIVE</option>
                            <option value="INACTIVE">INACTIVE</option>
                            <option value="LOCK">LOCK</option>
                        </select>
                    </div>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="btnNewUser" type="button" title="새 사용자 추가" onclick="openUserForm('new')">
                        <i class="fas fa-plus-circle"></i> 신규
                    </button>
                    <button class="btn btn-info" onclick="resetUserFilters()">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                    <button class="btn btn-success" onclick="exportUsersToExcel()">
                        <i class="fas fa-file-excel"></i> 엑셀
                    </button>
                    <button class="btn btn-warning" onclick="bulkResetPasswords()">
                        <i class="fas fa-key"></i> password 일괄 Reset
                    </button>
                </div>
            </div>

            <!-- 테이블 패널 -->
            <div class="table-panel">
                <div id="usersTable"></div>
            </div>
        </main>
    </div>

    <!-- ===================================
         사용자 관리 - 등록/수정 페이지
         =================================== -->
    <div id="page-users-form" class="page-content">
        <div class="form-container user-form-container">
            <div class="form-header">
                <div class="form-title">
                    <i class="fas fa-users-cog"></i>
                    <h2 id="userFormTitleText">신규 사용자 등록</h2>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" type="button" onclick="saveUserForm()">
                        <i class="fas fa-save"></i> 저장
                    </button>
                    <button class="btn btn-outline-secondary" type="button" onclick="navigateToUserList()">
                        <i class="fas fa-list"></i> 목록
                    </button>
                    <button class="btn btn-danger" type="button" id="btnDeleteUser" onclick="deleteUser()" style="display: none;">
                        <i class="fas fa-trash"></i> 삭제
                    </button>
                    <button class="btn btn-close-icon" type="button" onclick="navigateToUserList()" title="닫기">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <form id="userForm" class="tab-content user-form" onsubmit="event.preventDefault(); saveUserForm();">
                <input type="hidden" id="userNo">
                <input type="hidden" id="userMode" value="new">

                <!-- 기본 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-id-card"></i>
                        기본 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="userNoView">사용자번호</label>
                            <input type="text" id="userNoView" class="form-input" readonly placeholder="자동 채번">
                        </div>

                        <div class="form-group">
                            <label for="loginId" class="required">로그인 ID</label>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <input type="text" id="loginId" class="form-input" required placeholder="login_id 입력">
                                <button type="button" class="btn btn-outline-secondary" id="btnEnableLoginIdEdit" onclick="enableLoginIdEdit()" style="white-space: nowrap; display: none;">
                                    ID 수정
                                </button>
                            </div>
                            <span class="form-hint">신규 등록 후 일반적으로 수정 불가</span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="userName" class="required">사용자명</label>
                            <input type="text" id="userName" class="form-input" required placeholder="사용자명을 입력하세요">
                        </div>

                        <div class="form-group">
                            <label for="role" class="required">권한</label>
                            <select id="role" class="form-select" required>
                                <option value="">선택하세요</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="isSalesRep">영업담당 여부</label>
                            <div class="form-switch-group">
                                <label class="form-switch">
                                    <input type="checkbox" id="isSalesRep" class="form-switch-input">
                                    <span class="form-switch-slider"></span>
                                </label>
                                <span class="form-switch-label">담당</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 연락처/소속 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-building"></i>
                        소속/연락처
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">이메일</label>
                            <input type="email" id="email" class="form-input" placeholder="example@company.com">
                        </div>

                        <div class="form-group">
                            <label for="phone">연락처</label>
                            <input type="text" id="phone" class="form-input" placeholder="010-0000-0000">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="orgId">조직</label>
                            <select id="orgId" class="form-select">
                                <option value="">선택하세요</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 계정 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-user-shield"></i>
                        계정 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate" class="required">시작일</label>
                            <input type="date" id="startDate" class="form-input" required>
                        </div>

                        <div class="form-group">
                            <label for="endDate" class="required">종료일</label>
                            <input type="date" id="endDate" class="form-input" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="status" class="required">상태</label>
                            <select id="status" class="form-select" required>
                                <option value="ACTIVE">ACTIVE</option>
                                <option value="INACTIVE">INACTIVE</option>
                                <option value="LOCK">LOCK</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 시스템 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-info-circle"></i>
                        시스템 정보 (조회용)
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="createdAt">생성일시</label>
                            <input type="text" id="createdAt" class="form-input" readonly>
                        </div>

                        <div class="form-group">
                            <label for="updatedAt">수정일시</label>
                            <input type="text" id="updatedAt" class="form-input" readonly>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="createdBy">생성자</label>
                            <input type="text" id="createdBy" class="form-input" readonly>
                        </div>

                        <div class="form-group">
                            <label for="updatedBy">수정자</label>
                            <input type="text" id="updatedBy" class="form-input" readonly>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary btn-lg" onclick="navigateToUserList()">
                        <i class="fas fa-list"></i>
                        목록으로
                    </button>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save"></i>
                        저장
                    </button>
                    <button type="button" class="btn btn-danger btn-lg" id="btnDeleteUserBottom" onclick="deleteUser()" style="display: none;">
                        <i class="fas fa-trash"></i>
                        삭제
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ===================================
         공통코드 관리 페이지
         =================================== -->
    <div id="page-common-codes" class="page-content">
        <main class="app-main">
            <div class="common-code-layout">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-sitemap"></i> 대분류코드</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnGroupNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnGroupDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnGroupSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnGroupRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnGroupExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnGroupUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="codeGroupTable"></div>
                    </div>
                    <input type="file" id="groupExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>

                <section class="common-code-panel">
                    <div class="panel-header">
                        <div>
                            <h3><i class="fas fa-list"></i> 상세코드</h3>
                            <div class="panel-subtitle" id="selectedGroupLabel">대분류를 선택하세요</div>
                        </div>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnDetailNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnDetailDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnDetailSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnDetailRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnDetailExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnDetailUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="codeDetailTable"></div>
                    </div>
                    <input type="file" id="detailExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         분야코드 관리 페이지
         =================================== -->
    <div id="page-industry-fields" class="page-content">
        <main class="app-main">
            <div class="common-code-layout single">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-tags"></i> 분야코드</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnIndustryNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnIndustryDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnIndustrySave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnIndustryRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnIndustryExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnIndustryUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="industryFieldsTable"></div>
                    </div>
                    <input type="file" id="industryExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         서비스코드 관리 페이지
         =================================== -->
    <div id="page-service-codes" class="page-content">
        <main class="app-main">
            <div class="common-code-layout single">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-layer-group"></i> 서비스코드</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnServiceNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnServiceDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnServiceSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnServiceRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnServiceExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnServiceUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="serviceCodesTable"></div>
                    </div>
                    <input type="file" id="serviceExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         조직 관리 페이지
         =================================== -->
    <div id="page-org-units" class="page-content">
        <main class="app-main">
            <div class="common-code-layout single">
                <section class="common-code-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-sitemap"></i> 조직 관리</h3>
                        <div class="panel-actions">
                            <button class="btn btn-primary" id="btnOrgNew" type="button">
                                <i class="fas fa-plus-circle"></i> 신규
                            </button>
                            <button class="btn btn-danger" id="btnOrgDelete" type="button">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            <button class="btn btn-success" id="btnOrgSave" type="button">
                                <i class="fas fa-save"></i> 저장
                            </button>
                            <button class="btn btn-info" id="btnOrgRefresh" type="button">
                                <i class="fas fa-sync-alt"></i> 새로고침
                            </button>
                            <button class="btn btn-success" id="btnOrgExcel" type="button">
                                <i class="fas fa-file-excel"></i> 엑셀
                            </button>
                            <button class="btn btn-secondary" id="btnOrgUpload" type="button">
                                <i class="fas fa-file-upload"></i> 업로드
                            </button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div id="orgUnitsTable"></div>
                    </div>
                    <input type="file" id="orgExcelInput" accept=".xlsx,.xls" style="display:none;">
                </section>
            </div>
        </main>
    </div>

    <!-- ===================================
         내정보 페이지
         =================================== -->
    <div id="page-my-info" class="page-content">
        <div class="form-container my-info-container">
            <div class="form-header">
                <div class="form-title">
                    <i class="fas fa-user-cog"></i>
                    <h2>내정보</h2>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" type="button" onclick="saveMyInfo()">
                        <i class="fas fa-save"></i> 저장
                    </button>
                    <button class="btn btn-outline-secondary" type="button" onclick="closeMyInfo()">
                        <i class="fas fa-times"></i> 닫기
                    </button>
                </div>
            </div>

            <form id="myInfoForm" class="tab-content" onsubmit="event.preventDefault(); saveMyInfo();">
                <!-- 기본 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-id-card"></i>
                        기본 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myLoginId">로그인 ID</label>
                            <input type="text" id="myLoginId" class="form-input" readonly>
                        </div>
                        <div class="form-group">
                            <label for="myUserName" class="required">사용자명</label>
                            <input type="text" id="myUserName" class="form-input" required placeholder="사용자명을 입력하세요">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myRole">권한</label>
                            <input type="text" id="myRole" class="form-input" readonly>
                        </div>
                        <div class="form-group">
                            <label for="myStatus">계정 상태</label>
                            <input type="text" id="myStatus" class="form-input" readonly>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="mySalesRep">영업담당</label>
                            <div class="form-switch-group">
                                <label class="form-switch">
                                    <input type="checkbox" id="mySalesRep" class="form-switch-input">
                                    <span class="form-switch-slider"></span>
                                </label>
                                <span class="form-switch-label">영업 담당 여부</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 소속 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-sitemap"></i>
                        소속 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myOrgName">조직</label>
                            <input type="text" id="myOrgName" class="form-input" placeholder="소속 조직" readonly>
                        </div>
                    </div>
                </div>

                <!-- 연락처 정보 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-phone"></i>
                        연락처 정보
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myEmail">이메일</label>
                            <input type="email" id="myEmail" class="form-input" placeholder="example@company.com">
                        </div>
                        <div class="form-group">
                            <label for="myPhone">연락처</label>
                            <input type="tel" id="myPhone" class="form-input" placeholder="010-0000-0000">
                        </div>
                    </div>
                </div>

                <!-- 재직/권한 기간 -->
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-calendar-alt"></i>
                        재직/권한 기간
                    </h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="myStartDate">시작일</label>
                            <input type="date" id="myStartDate" class="form-input" readonly>
                        </div>
                        <div class="form-group">
                            <label for="myEndDate">종료일</label>
                            <input type="date" id="myEndDate" class="form-input" readonly>
                        </div>
                    </div>
                </div>
            </form>

            <!-- 비밀번호 변경 -->
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-lock"></i>
                    비밀번호 변경
                </h2>

                <form id="myPasswordForm" class="tab-content" onsubmit="event.preventDefault(); changeMyPassword();">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="myOldPassword" class="required">현재 비밀번호</label>
                            <input type="password" id="myOldPassword" class="form-input" required autocomplete="current-password">
                        </div>
                        <div class="form-group">
                            <label for="myNewPassword" class="required">새 비밀번호</label>
                            <input type="password" id="myNewPassword" class="form-input" required autocomplete="new-password">
                            <span class="form-hint">영문/숫자/특수문자 포함 8자 이상</span>
                        </div>
                        <div class="form-group">
                            <label for="myNewPasswordConfirm" class="required">새 비밀번호 확인</label>
                            <input type="password" id="myNewPasswordConfirm" class="form-input" required autocomplete="new-password">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group form-group-full">
                            <div class="password-rule-status" id="myPasswordRuleStatus">
                                비밀번호 규칙을 확인해주세요.
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-key"></i>
                            비밀번호 변경
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 모달: 프로젝트 상세 정보 (읽기 전용) -->
    <div id="projectModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> 프로젝트 상세 정보</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modalBody" class="modal-body">
                <p>로딩 중...</p>
            </div>
        </div>
    </div>

    <!-- 로딩 오버레이 -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-circle-notch fa-spin"></i>
            <p>처리중...</p>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- 변경이력 수정 모달 (신규 추가) -->
    <!-- ============================================ -->
    <div id="historyEditModal" class="modal" style="display: none;">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-edit"></i>
                    변경이력 수정
                </h2>
                <button class="modal-close" onclick="closeHistoryEditModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- 수정 폼 -->
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <!-- 기준일 -->
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">
                            <i class="far fa-calendar-alt" style="color: #667eea; margin-right: 0.5rem;"></i>
                            기준일 <span class="required">*</span>
                        </label>
                        <input type="date" id="edit_history_date" class="form-input" required>
                    </div>
                    
                    <!-- 진행단계 -->
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">
                            <i class="fas fa-flag" style="color: #667eea; margin-right: 0.5rem;"></i>
                            진행단계 <span class="required">*</span>
                        </label>
                        <select id="edit_history_stage" class="form-select" required>
                            <option value="">진행단계 선택</option>
                            <!-- JavaScript에서 동적으로 채움 -->
                        </select>
                    </div>
                    
                    <!-- 전략 내용 -->
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">
                            <i class="fas fa-file-alt" style="color: #667eea; margin-right: 0.5rem;"></i>
                            전략 내용
                        </label>
                        <textarea 
                            id="edit_history_content" 
                            class="form-textarea" 
                            placeholder="전략 내용을 입력하세요.
    여러 줄로 상세하게 작성할 수 있습니다.
    - 주요 활동 내역
    - 고객 피드백
    - 향후 계획 등"
                            style="
                                width: 100%; 
                                min-height: 120px;
                                max-height: 300px;
                                padding: 0.75rem; 
                                border: 1px solid #ddd; 
                                border-radius: 6px; 
                                font-family: inherit; 
                                font-size: 0.875rem; 
                                line-height: 1.5;
                                text-align: left;
                                resize: vertical;
                                transition: border-color 0.2s, box-shadow 0.2s;
                            "
                            oninput="autoResizeTextarea(this)"
                            onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 3px rgba(102,126,234,0.1)';"
                            onblur="this.style.borderColor='#ddd'; this.style.boxShadow='none';"
                        ></textarea>
                        <small style="display: block; margin-top: 0.5rem; color: #666; font-size: 0.75rem;">
                            <i class="fas fa-info-circle"></i> Enter 키로 줄바꿈하여 여러 줄을 입력할 수 있습니다.
                        </small>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="display: flex; gap: 0.75rem; justify-content: flex-end; padding: 1rem 1.5rem; background: #f8f9fa; border-top: 1px solid #e0e0e0;">
                <button type="button" class="btn btn-secondary" onclick="closeHistoryEditModal()">
                    <i class="fas fa-times"></i> 취소
                </button>
                <button type="button" class="btn btn-primary" onclick="saveHistoryEdit()">
                    <i class="fas fa-check"></i> 확인
                </button>
            </div>
        </div>
    </div>

    <div id="attributeCodeModal" class="modal" style="display: none;">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h3><i class="fas fa-tags"></i> 속성코드 추가</h3>
                <button class="modal-close" onclick="closeAttributeCodeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label><i class="fas fa-code"></i> 코드<span class="required">*</span></label>
                    <input type="text" id="attr_code_input" class="form-input" placeholder="예: ATTR01">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-font"></i> 코드명<span class="required">*</span></label>
                    <input type="text" id="attr_name_input" class="form-input" placeholder="예: 기술유형">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-sort-numeric-up"></i> 정렬순서</label>
                    <input type="number" id="attr_sort_input" class="form-input" value="0" min="0">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-toggle-on"></i> 사용여부</label>
                    <select id="attr_use_input" class="form-select">
                        <option value="Y">사용</option>
                        <option value="N">미사용</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeAttributeCodeModal()">취소</button>
                <button type="button" class="btn btn-primary" onclick="saveAttributeCode()">등록</button>
            </div>
        </div>
    </div>

    <!-- Scripts 순서 중요 -->
    <script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="/static/js/config.js?v=3.4"></script>
    <script src="/static/js/auth.js?v=2.5"></script>
    <script src="/static/js/utils.js?v=2.5"></script>
    <script src="/static/js/navigation.js?v=4.3"></script>  <!-- ⭐ 버전 업 -->
    <script src="/static/js/stage-icons.js"></script>
    <script src="/static/js/project-form.js?v=3.6"></script>
    <script src="/static/js/clients-list.js?v=3.5"></script>  <!-- ⭐ 버전 추가 -->
    <script src="/static/js/clients-form.js?v=3.0"></script>  <!-- ⭐ 신규 추가 -->
    <script src="/static/js/sales-plan.js?v=2.0"></script>
    <script src="/static/js/sales-actual.js?v=1.3"></script>
    <script src="/static/js/report.js?v=1.11"></script>
    <script src="/static/js/users-list.js?v=2.2"></script>
    <script src="/static/js/users-form.js?v=1.4"></script>
    <script src="/static/js/common-codes.js?v=1.5"></script>
    <script src="/static/js/industry-fields.js?v=1.0"></script>
    <script src="/static/js/service-codes.js?v=1.0"></script>
    <script src="/static/js/org-units.js?v=1.0"></script>
    <script src="/static/js/my-info.js?v=1.1"></script>
    <script src="/static/js/app.js?v=3.0"></script>
    <script src="/static/js/mobile.js?v=2.5"></script>
    <script src="/static/js/markdown-formatter.js"></script>


    <!-- ============================================ -->
    <!-- ⭐ 마크다운 가이드 모달 (신규 추가) -->
    <!-- ============================================ -->
    <div id="markdownGuideModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 700px; width: 90%;">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-book-open"></i>
                    마크다운 문법 가이드
                </h2>
                <button class="modal-close" onclick="closeMarkdownGuide()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <div style="display: grid; gap: 1.5rem;">
                    
                    <!-- 기본 사용법 -->
                    <div style="background: #e8f5e9; padding: 1rem; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <h4 style="color: #2e7d32; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-lightbulb"></i>
                            기본 사용법
                        </h4>
                        <p style="margin: 0; color: #1b5e20; line-height: 1.6;">
                            라인 시작 부분에 기호를 입력하고 <strong>스페이스</strong>를 누르면 자동으로 변환됩니다.
                            <br><strong>Enter</strong> 키를 누르면 다음 줄에 같은 형식이 자동으로 추가됩니다.
                        </p>
                    </div>
                    
                    <!-- 글머리 기호 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-list-ul"></i>
                            글머리 기호 (Bullet Points)
                        </h3>
                        
                        <div style="display: grid; gap: 1rem;">
                            <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                                <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                    <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                    <div>* 첫 번째 항목</div>
                                    <div>- 두 번째 항목</div>
                                    <div>+ 세 번째 항목</div>
                                </div>
                                
                                <div style="font-size: 1.5rem; color: #667eea;">→</div>
                                
                                <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                    <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                    <div>• 첫 번째 항목</div>
                                    <div>• 두 번째 항목</div>
                                    <div>• 세 번째 항목</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 번호 목록 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-list-ol"></i>
                            번호 목록 (Numbered List)
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                <div>1. 첫 번째</div>
                                <div style="color: #999; font-style: italic;">(Enter 누르면 자동으로 2.)</div>
                                <div>2. 두 번째</div>
                                <div>3. 세 번째</div>
                            </div>
                            
                            <div style="font-size: 1.5rem; color: #667eea;">✓</div>
                            
                            <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                <div>1. 첫 번째</div>
                                <div>2. 두 번째</div>
                                <div>3. 세 번째</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 체크리스트 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-check-square"></i>
                            체크리스트 (Checklist)
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                <div>[ ] 미완료 작업</div>
                                <div>[x] 완료된 작업</div>
                                <div>[X] 완료 (대문자)</div>
                            </div>
                            
                            <div style="font-size: 1.5rem; color: #667eea;">→</div>
                            
                            <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                <div>☐ 미완료 작업</div>
                                <div>☑ 완료된 작업</div>
                                <div>☑ 완료 (대문자)</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 들여쓰기 -->
                    <div class="guide-section">
                        <h3 style="color: #667eea; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-indent"></i>
                            들여쓰기 (Indentation)
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">입력:</div>
                                <div>* 상위 항목</div>
                                <div style="padding-left: 2rem;">* 하위 항목 (Tab)</div>
                                <div style="padding-left: 4rem;">* 더 하위 (Tab x2)</div>
                            </div>
                            
                            <div style="font-size: 1.5rem; color: #667eea;">→</div>
                            
                            <div style="background: white; padding: 1rem; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div style="color: #666; font-size: 0.8rem; margin-bottom: 0.5rem;">결과:</div>
                                <div>• 상위 항목</div>
                                <div style="padding-left: 2rem;">• 하위 항목</div>
                                <div style="padding-left: 4rem;">• 더 하위</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 키보드 단축키 -->
                    <div style="background: #fff3e0; padding: 1rem; border-radius: 8px; border-left: 4px solid #ff9800;">
                        <h4 style="color: #e65100; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-keyboard"></i>
                            키보드 단축키
                        </h4>
                        <div style="display: grid; gap: 0.75rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Tab</kbd></span>
                                <span>들여쓰기</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Shift + Tab</kbd></span>
                                <span>내어쓰기</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Enter</kbd></span>
                                <span>다음 줄에 같은 형식 자동 생성</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-weight: 600;"><kbd style="background: #f5f5f5; padding: 0.25rem 0.5rem; border: 1px solid #ccc; border-radius: 3px; font-family: monospace;">Enter</kbd> (빈 줄)</span>
                                <span>포맷 종료</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 실전 예제 -->
                    <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; border-left: 4px solid #2196f3;">
                        <h4 style="color: #0d47a1; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-star"></i>
                            실전 예제
                        </h4>
                        <div style="background: white; padding: 1rem; border-radius: 6px; font-family: 'Courier New', monospace; line-height: 1.8; border: 1px solid #90caf9;">
                            <div>• 고객사 미팅 완료</div>
                            <div style="padding-left: 2rem;">• 주요 요구사항 확인</div>
                            <div style="padding-left: 2rem;">• 예산 및 일정 논의</div>
                            <div>• 제안서 작성 계획</div>
                            <div style="padding-left: 2rem;">1. 기술 스펙 정리</div>
                            <div style="padding-left: 2rem;">2. 견적 산출</div>
                            <div style="padding-left: 2rem;">3. 발표 자료 준비</div>
                            <div>• 다음 액션 아이템</div>
                            <div style="padding-left: 2rem;">☐ 기술팀 검토 요청</div>
                            <div style="padding-left: 2rem;">☐ 견적서 초안 작성</div>
                            <div style="padding-left: 2rem;">☑ 미팅 노트 공유</div>
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="closeMarkdownGuide()" style="padding: 0.75rem 2rem;">
                    <i class="fas fa-check"></i> 확인
                </button>
            </div>
        </div>
    </div>

    <script>
    // ⭐ 마크다운 가이드 모달 함수
    function showMarkdownGuide() {
        const modal = document.getElementById('markdownGuideModal');
        if (modal) {
            modal.classList.add('active');
            modal.style.display = 'flex';
        }
    }

    function closeMarkdownGuide() {
        const modal = document.getElementById('markdownGuideModal');
        if (modal) {
            modal.classList.remove('active');
            modal.style.display = 'none';
        }
    }

    // 모달 외부 클릭 시 닫기
    window.addEventListener('click', function(event) {
        const modal = document.getElementById('markdownGuideModal');
        if (modal && event.target === modal) {
            closeMarkdownGuide();
        }
    });
    </script>

</body>
</html>
